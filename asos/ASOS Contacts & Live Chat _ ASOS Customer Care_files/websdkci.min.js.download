!function(e){function t(t){for(var i,s,a=t[0],o=t[1],r=0,c=[];r<a.length;r++)s=a[r],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&c.push(n[s][0]),n[s]=0;for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i]);for(l&&l(t);c.length;)c.shift()()}var i={},n={2:0};function s(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],i=n[e];if(0!==i)if(i)t.push(i[2]);else{var a=new Promise((function(t,s){i=n[e]=[t,s]}));t.push(i[2]=a);var o,r=document.createElement("script");r.charset="utf-8",r.timeout=120,s.nc&&r.setAttribute("nonce",s.nc),r.src=function(e){return s.p+""+e+".websdkci.min.js"}(e);var l=new Error;o=function(t){r.onerror=r.onload=null,clearTimeout(c);var i=n[e];if(0!==i){if(i){var s=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+s+": "+a+")",l.name="ChunkLoadError",l.type=s,l.request=a,i[1](l)}n[e]=void 0}};var c=setTimeout((function(){o({type:"timeout",target:r})}),12e4);r.onerror=r.onload=o,document.head.appendChild(r)}return Promise.all(t)},s.m=e,s.c=i,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var a=window.webpackJsonp=window.webpackJsonp||[],o=a.push.bind(a);a.push=t,a=a.slice();for(var r=0;r<a.length;r++)t(a[r]);var l=o;s(s.s=60)}([function(e,t,i){"use strict";(function(e){i.d(t,"e",(function(){return n})),i.d(t,"p",(function(){return s})),i.d(t,"a",(function(){return a})),i.d(t,"c",(function(){return o})),i.d(t,"d",(function(){return r})),i.d(t,"o",(function(){return l})),i.d(t,"q",(function(){return c})),i.d(t,"t",(function(){return u})),i.d(t,"i",(function(){return h})),i.d(t,"r",(function(){return d})),i.d(t,"s",(function(){return p})),i.d(t,"k",(function(){return m})),i.d(t,"m",(function(){return f})),i.d(t,"j",(function(){return g})),i.d(t,"l",(function(){return v})),i.d(t,"g",(function(){return y})),i.d(t,"f",(function(){return b})),i.d(t,"h",(function(){return S})),i.d(t,"n",(function(){return w})),i.d(t,"b",(function(){return k}));var n="1.12.0",s="object"==typeof self&&self.self===self&&self||"object"==typeof e&&e.global===e&&e||Function("return this")()||{},a=Array.prototype,o=Object.prototype,r="undefined"!=typeof Symbol?Symbol.prototype:null,l=a.push,c=a.slice,u=o.toString,h=o.hasOwnProperty,d="undefined"!=typeof ArrayBuffer,p="undefined"!=typeof DataView,m=Array.isArray,f=Object.keys,g=Object.create,v=d&&ArrayBuffer.isView,y=isNaN,b=isFinite,S=!{toString:null}.propertyIsEnumerable("toString"),w=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],k=Math.pow(2,53)-1}).call(this,i(58))},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){function i(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){function i(t){return e.exports=i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.default=e.exports,e.exports.__esModule=!0,i(t)}e.exports=i,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){var n;!function(s,a,o){if(s){for(var r,l={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},c={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},u={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},h={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},d=1;d<20;++d)l[111+d]="f"+d;for(d=0;d<=9;++d)l[d+96]=d.toString();y.prototype.bind=function(e,t,i){return e=e instanceof Array?e:[e],this._bindMultiple.call(this,e,t,i),this},y.prototype.unbind=function(e,t){return this.bind.call(this,e,(function(){}),t)},y.prototype.trigger=function(e,t){return this._directMap[e+":"+t]&&this._directMap[e+":"+t]({},e),this},y.prototype.reset=function(){return this._callbacks={},this._directMap={},this},y.prototype.stopCallback=function(e,t){if((" "+t.className+" ").indexOf(" mousetrap ")>-1)return!1;if(function e(t,i){return null!==t&&t!==a&&(t===i||e(t.parentNode,i))}(t,this.target))return!1;if("composedPath"in e&&"function"==typeof e.composedPath){var i=e.composedPath()[0];i!==e.target&&(t=i)}return"INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable},y.prototype.handleKey=function(){var e=this;return e._handleKey.apply(e,arguments)},y.addKeycodes=function(e){for(var t in e)e.hasOwnProperty(t)&&(l[t]=e[t]);r=null},y.init=function(){var e=y(a);for(var t in e)"_"!==t.charAt(0)&&(y[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t))},y.init(),s.Mousetrap=y,e.exports&&(e.exports=y),void 0===(n=function(){return y}.call(t,i,t,e))||(e.exports=n)}function p(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent("on"+t,i)}function m(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return l[e.which]?l[e.which]:c[e.which]?c[e.which]:String.fromCharCode(e.which).toLowerCase()}function f(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function g(e,t,i){return i||(i=function(){if(!r)for(var e in r={},l)e>95&&e<112||l.hasOwnProperty(e)&&(r[l[e]]=e);return r}()[e]?"keydown":"keypress"),"keypress"==i&&t.length&&(i="keydown"),i}function v(e,t){var i,n,s,a=[];for(i=function(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus")).split("+")}(e),s=0;s<i.length;++s)n=i[s],h[n]&&(n=h[n]),t&&"keypress"!=t&&u[n]&&(n=u[n],a.push("shift")),f(n)&&a.push(n);return{key:n,modifiers:a,action:t=g(n,a,t)}}function y(e){var t=this;if(e=e||a,!(t instanceof y))return new y(e);t.target=e,t._callbacks={},t._directMap={};var i,n={},s=!1,o=!1,r=!1;function l(e){e=e||{};var t,i=!1;for(t in n)e[t]?i=!0:n[t]=0;i||(r=!1)}function c(e,i,s,a,o,r){var l,c,u,h,d=[],p=s.type;if(!t._callbacks[e])return[];for("keyup"==p&&f(e)&&(i=[e]),l=0;l<t._callbacks[e].length;++l)if(c=t._callbacks[e][l],(a||!c.seq||n[c.seq]==c.level)&&p==c.action&&("keypress"==p&&!s.metaKey&&!s.ctrlKey||(u=i,h=c.modifiers,u.sort().join(",")===h.sort().join(",")))){var m=!a&&c.combo==o,g=a&&c.seq==a&&c.level==r;(m||g)&&t._callbacks[e].splice(l,1),d.push(c)}return d}function u(e,i,n,s){t.stopCallback(i,i.target||i.srcElement,n,s)||!1===e(i,n)&&(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}(i),function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}(i))}function h(e){"number"!=typeof e.which&&(e.which=e.keyCode);var i=m(e);i&&("keyup"!=e.type||s!==i?t.handleKey(i,function(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}(e),e):s=!1)}function d(e,t,a,o){function c(t){return function(){r=t,++n[e],clearTimeout(i),i=setTimeout(l,1e3)}}function h(t){u(a,t,e),"keyup"!==o&&(s=m(t)),setTimeout(l,10)}n[e]=0;for(var d=0;d<t.length;++d){var p=d+1===t.length?h:c(o||v(t[d+1]).action);g(t[d],p,o,e,d)}}function g(e,i,n,s,a){t._directMap[e+":"+n]=i;var o,r=(e=e.replace(/\s+/g," ")).split(" ");r.length>1?d(e,r,i,n):(o=v(e,n),t._callbacks[o.key]=t._callbacks[o.key]||[],c(o.key,o.modifiers,{type:o.action},s,e,a),t._callbacks[o.key][s?"unshift":"push"]({callback:i,modifiers:o.modifiers,action:o.action,seq:s,level:a,combo:e}))}t._handleKey=function(e,t,i){var n,s=c(e,t,i),a={},h=0,d=!1;for(n=0;n<s.length;++n)s[n].seq&&(h=Math.max(h,s[n].level));for(n=0;n<s.length;++n)if(s[n].seq){if(s[n].level!=h)continue;d=!0,a[s[n].seq]=1,u(s[n].callback,i,s[n].combo,s[n].seq)}else d||u(s[n].callback,i,s[n].combo);var p="keypress"==i.type&&o;i.type!=r||f(e)||p||l(a),o=d&&"keydown"==i.type},t._bindMultiple=function(e,t,i){for(var n=0;n<e.length;++n)g(e[n],t,i)},p(e,"keypress",h),p(e,"keydown",h),p(e,"keyup",h)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)},function(e,t){function i(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=i=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=i=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),i(t)}e.exports=i,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){var n=i(50),s=i(51),a=i(52),o=i(53);e.exports=function(e){return n(e)||s(e)||a(e)||o()},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){var n=i(13);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){var n=i(6).default,s=i(8);e.exports=function(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?s(e):t},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){var n=i(49);function s(t,i,a){return"undefined"!=typeof Reflect&&Reflect.get?(e.exports=s=Reflect.get,e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=s=function(e,t,i){var s=n(e,t);if(s){var a=Object.getOwnPropertyDescriptor(s,t);return a.get?a.get.call(i):a.value}},e.exports.default=e.exports,e.exports.__esModule=!0),s(t,i,a||t)}e.exports=s,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){e.exports=i(59)},function(e,t){function i(t,n){return e.exports=i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,i(t,n)}e.exports=i,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){function i(e,t,i,n,s,a,o){try{var r=e[a](o),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,s)}e.exports=function(e){return function(){var t=this,n=arguments;return new Promise((function(s,a){var o=e.apply(t,n);function r(e){i(o,s,a,r,l,"next",e)}function l(e){i(o,s,a,r,l,"throw",e)}r(void 0)}))}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports='<div class="messaging-box" :style="this.style" @touchstart="onLayoutClick" @click="onLayoutClick" @keydown="onKeyDown">\n    <messaging-top-bar issurvey="{this.survey}"></messaging-top-bar>\n    <transcript-area :if="!this.survey">\n    </transcript-area>\n\n    <survey-view issurvey="{this.survey}">\n    </survey-view>\n\n    <footer-area issurvey="{this.survey}">\n    </footer-area>\n\n    <survey-view :if="this.survey">\n    </survey-view>\n\n    <aria-reader-view>\n    </aria-reader-view>\n</div>\n\n\n\n\n\n'},function(e,t,i){var n=i(54);e.exports=function(e,t){if(null==e)return{};var i,s,a=n(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports='<div :class="messaging-top-bar-material top-bar-material:this.config.topBarType === \'material\' && this.prop.issurvey == \'false\';messaging-top-bar:true;extended-top-bar:this.config.extendedTopBarItems && this.prop.issurvey == \'false\';"\n     id="top-bar"\n     :style="this.contStyle">\n    <div class="top-bar-main" :style="this.barStyle">\n    <div :if="this.config.centerTopBarItems && this.config.centerTopBarItems.length > 0" class="top-bar-center h-100 d-flex">\n        <topbar-element :for="item in this.config.centerTopBarItems" type="{item.type}" imgName="{item.imgName}" imgSrc="{item.imgSrc}" text="{item.text || \'\'}" subtext="{item.subText}" mode="{item.mode}"\n                        hiddenstates="{item.hiddenStates && item.hiddenStates.join(\',\') || \'\'}"\n                        hiddenDevices="{item.hiddenDeviceTypes && item.hiddenDeviceTypes.join(\',\') || \'\'}"\n                        audioOnImgName="{item.audioOnImgName}"\n                        audioOffImgName="{item.audioOffImgName}"\n        ></topbar-element>\n    </div>\n    <div class="top-bar-left h-100 d-flex" :if="this.config.leftTopBarItems">\n        <div :for="item in this.config.leftTopBarItems">\n            <overflow-menu :if="item.type == \'Overflow\'"\n                           class="overflow-menu top-bar-item left"\n                           :style="this.topBarIconStyle"\n                           overflowmenuitems="{encodeURIComponent(JSON.stringify(this.config.leftOverFlowItems))}"\n                           overflowmenustyle="{encodeURIComponent(JSON.stringify(this.leftOverFlowMenuStyle))}">\n            </overflow-menu>\n        <topbar-element :else type="{item.type}" imgName="{item.imgName}" imgSrc="{item.imgSrc}" text="{item.text || \'\'}" subtext="{item.subText}" mode="{item.mode}"\n                        hiddenstates="{item.hiddenStates && item.hiddenStates.join(\',\') || \'\'}"\n                        hiddenDevices="{item.hiddenDeviceTypes && item.hiddenDeviceTypes.join(\',\') || \'\'}"\n                        audioOnImgName="{item.audioOnImgName}"\n                        audioOffImgName="{item.audioOffImgName}"\n        ></topbar-element>\n        </div>\n    </div>\n\n    <div class="top-bar-right h-100 d-flex"  :if="this.config.rightTopBarItems">\n        <div :for="item in this.config.rightTopBarItems">\n            <overflow-menu :if="item.type == \'Overflow\'"\n                           class="overflow-menu top-bar-item right"\n                           :style="this.topBarIconStyle"\n                           overflowmenuitems="{encodeURIComponent(JSON.stringify(this.config.rightOverFlowItems))}"\n                           overflowmenustyle="{encodeURIComponent(JSON.stringify(this.rightOverFlowMenuStyle))}">\n            </overflow-menu>\n            <topbar-element :else  type="{item.type}" imgName="{item.imgName}" imgSrc="{item.imgSrc}" text="{item.text || \'\'}" subtext="{item.subText}" mode="{item.mode}"\n                            hiddenstates="{item.hiddenStates && item.hiddenStates.join(\',\') || \'\'}"\n                            hiddenDevices="{item.hiddenDeviceTypes && item.hiddenDeviceTypes.join(\',\') || \'\'}"\n                            audioOnImgName="{item.audioOnImgName}"\n                            audioOffImgName="{item.audioOffImgName}"\n            ></topbar-element>\n        </div>\n    </div>\n\n\n    <div style="clear:both;"></div>\n    <div :if="this.config.topBarType == \'material\' && this.config.materialBarItems && this.prop.issurvey == \'false\'" class="top-bar-material-container">\n       <div class="top-material h-100 d-flex" :if="this.config.materialItemPosition == \'left\'">\n           <div>\n               <topbar-element  :for="item in this.config.materialBarItems" type="{item.type}" imgName="{item.imgName}" imgSrc="{item.imgSrc}" text="{item.text || \'\'}" audioOnImgName="{item.audioOnImgName}" audioOffImgName="{item.audioOffImgName}"></topbar-element>\n           </div>\n       </div>\n        <div class="top-material-center h-100 d-flex" :if="this.config.materialItemPosition == \'center\'">\n            <div class="w-100">\n                <div class="d-flex" :for="item in this.config.materialBarItems" >\n                    <topbar-element type="{item.type}" imgName="{item.imgName}" imgSrc="{item.imgSrc}" text="{item.text}" audioOnImgName="{item.audioOnImgName}" audioOffImgName="{item.audioOffImgName}"></topbar-element>\n                </div>\n            </div>\n        </div>\n        <div class="top-material-adjacent h-100 d-flex" :if="this.config.materialItemPosition == \'adjacent\'">\n            <topbar-element  :for="item in this.config.materialBarItems" type="{item.type}" imgName="{item.imgName}" imgSrc="{item.imgSrc}" text="{item.text || \'\'}" audioOnImgName="{item.audioOnImgName}" audioOffImgName="{item.audioOffImgName}"></topbar-element>\n        </div>\n    </div>\n    </div>\n    <div :if="this.config.extendedTopBarItems && (this.prop.issurvey == \'false\' || this.config.extendedTopBarInSurvey)" class="messaging-top-bar-extended" :style="this.extendStyle">\n        <topbar-element :for="item in this.config.extendedTopBarItems" type="{item.type}" imgName="{item.imgName || \'\'}" imgSrc="{item.imgSrc || \'\'}" text="{item.text || \'\'}" subtext="{item.subText}" mode="{item.mode}"\n                        hiddenstates="{item.hiddenStates && item.hiddenStates.join(\',\') || \'\'}"\n                        hiddenDevices="{item.hiddenDeviceTypes && item.hiddenDeviceTypes.join(\',\') || \'\'}"\n                        audioOnImgName="{item.audioOnImgName}"\n                        audioOffImgName="{item.audioOffImgName}"\n                        extended="true" :style="this.extendItemStyle"  @click="onIconClick"></topbar-element>\n    </div>\n</div>\n'},function(e,t,i){var n=i(3),s=i(13),a=i(55),o=i(56);function r(t){var i="function"==typeof Map?new Map:void 0;return e.exports=r=function(e){if(null===e||!a(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==i){if(i.has(e))return i.get(e);i.set(e,t)}function t(){return o(e,arguments,n(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),s(t,e)},e.exports.default=e.exports,e.exports.__esModule=!0,r(t)}e.exports=r,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports='<div :if="this.prop.type === \'Title\'" class="top-bar-item title" :style="this.topBarTitleStyle" @click="onItemClick">\n    <div class="main-title"><span>{this.mainTitle}</span></div>\n    <div :if="this.subText" class="sub-title"><span>{this.subText}</span></div>\n</div>\n<div :else>\n    <div :if="this.prop.type === \'Status\'" class="top-bar-item status" :style="this.topBarStatusStyle" @click="onItemClick">\n        <div :if="this.status" class="main-status"><span>{this.status}</span></div>\n        <div :if="this.subStatus" class="sub-status"><span>{this.subStatus}</span></div>\n    </div>\n    <div :else>\n        <div :if="this.prop.type === \'Description\'" class="top-bar-item description" :style="this.topBarDescriptionStyle" @click="onItemClick">\n            <span>{this.prop.text}</span>\n        </div>\n        <button class="extended-topbar-button" :if="this.prop.extended" title="{this.text}" @click="onItemClick">\n            <span class="extended-item icon"\n                 :style="this.extendedIconStyle">\n            </span>\n            <span class="extended-text"> {this.text} </span>\n        </button>\n        <div :else>\n            <div :if="this.prop.type === \'Logo\'" class="top-bar-item logo" role="img" aria-label="{this.text}"  :style="this.topBarLogoStyle"></div>\n            <div :else\n                 class="top-bar-item icon"\n                 :style="this.topBarIconStyle"\n                 @click="onIconClick"\n                 :class="disabled:this.disabled==true;"\n                 title="{this.text}"\n                 role="button"\n                 tabindex="0">\n            </div>\n        </div>\n    </div>\n</div>'},function(e,t){e.exports='<div :class="transcript-area ss-container:true;transcript-area-material:this.topBarConfig.topBarType === \'material\';extended-top-bar:this.topBarConfig.extendedTopBarItems;extended-footer:this.footerSettings.extendedFooterItems;" :style="this.style" id="transcript">\n    <typing-view></typing-view>\n    <disclaimer-footer-view :if="this.footerDis"></disclaimer-footer-view>\n</div>\n'},function(e,t){e.exports='<div :class="footer-area:this.prop.issurvey == \'false\';footer-area-extended:this.extendedFooter;footer-area survey-footer-area-extended:this.extendedFooterInSurvey" :style="this.contStyle">\n    <div class="footer-main" :style="this.style"  class="h-100" :if="this.prop.issurvey == \'false\'">\n        <div class="footer-left h-100 d-flex" :if="this.config.leftFooterItems">\n            <div :for="item in this.config.leftFooterItems">\n                <input-item :if="item.type == \'Input\'"> </input-item>\n                <overflow-menu :if="item.type == \'Overflow\'"\n                               data-state="{item.buttonEnabledState}"\n                               class="overflow-menu left"\n                               :style="this.overflowIconStyle"\n                               overflowmenuitems="{encodeURIComponent(JSON.stringify(this.config.leftOverFlowItems))}"\n                               overflowmenustyle="{encodeURIComponent(JSON.stringify(this.leftOverFlowMenuStyle))}">\n                </overflow-menu>\n                <footer-button :if="item.type != \'Input\' && item.type != \'Overflow\'" type="{item.type}" imgName="{item.imgName}" imgSrc="{item.imgSrc}" dImgName="{item.disabledImgName}" dImgSrc="{item.disabledImgSrc}" state="{item.buttonEnabledState}"></footer-button>\n            </div>\n        </div>\n        <div class="footer-right h-100 d-flex" :if="this.config.rightFooterItems">\n            <div :for="item in this.config.rightFooterItems">\n                <input-item :if="item.type == \'Input\'"> </input-item>\n                <footer-button :else type="{item.type}" imgName="{item.imgName}" imgSrc="{item.imgSrc}" dImgName="{item.disabledImgName}" dImgSrc="{item.disabledImgSrc}" state="{item.buttonEnabledState}" text="{item.text}"></footer-button>\n            </div>\n        </div>\n    </div>\n    <div :if="this.extendedFooter || this.extendedFooterInSurvey" class="messaging-footer-extended" :style="this.extendStyle">\n        <topbar-element :for="item in this.config.extendedFooterItems" type="{item.type}" imgName="{item.imgName || \'\'}" imgSrc="{item.imgSrc || \'\'}" text="{item.text || \'\'}" subtext="{item.subText}" mode="{item.mode}" extended="true" :style="this.extendItemStyle"  @click="onIconClick"\n                        hiddenstates="{item.hiddenStates && item.hiddenStates.join(\',\') || \'\'}"\n                        hiddenDevices="{item.hiddenDeviceTypes && item.hiddenDeviceTypes.join(\',\') || \'\'}"\n                        audioOnImgName="{item.audioOnImgName}"\n                        audioOffImgName="{item.audioOffImgName}"\n        ></topbar-element>\n    </div>\n</div>\n'},function(e,t){e.exports='<div @click="onMenuClick"\n     @touchend="onMenuClick"\n     :class="disabled:this.disabled==true;"\n     :style="this.overFlowItemStyle"\n     aria-disabled="{this.disabled}"\n     role="menuitem"\n     tabindex="-1">\n    <img src="{this.imgUrl}" aria-hidden="true"/>\n    <span>{this.text}</span>\n</div>\n'},function(e,t){e.exports='<div @click="onClick"\n     aria-haspopup="true"\n     role="button"\n     id="mainMenuOptions"\n     style="height: inherit"\n     tabindex="0">\n    <div class="dots"></div>\n</div>\n<div class="overflow-menu-items"\n     role="menu" aria-label="Options"\n     :style="JSON.parse(decodeURIComponent(this.prop.overflowmenustyle))">\n    <overflow-item :for="overflowitem in JSON.parse(decodeURIComponent(this.prop.overflowmenuitems))"\n                    hiddenstates="{overflowitem.hiddenStates && overflowitem.hiddenStates.join(\',\') || \'\'}"\n                    hiddenDevices="{overflowitem.hiddenDeviceTypes && overflowitem.hiddenDeviceTypes.join(\',\') || \'\'}"\n                    imgName="{overflowitem.imgName}"\n                    imgSrc="{overflowitem.imgSrc}"\n                    audioOnImgName="{overflowitem.audioOnImgName}"\n                    audioOffImgName="{overflowitem.audioOffImgName}"\n                    content="{overflowitem.content || \'\'}"\n                    role="presentation"\n                    text="{overflowitem.text}"\n                    type="{overflowitem.type}">\n    </overflow-item>\n</div>'},function(e,t){e.exports='<div class="customer-container">\n    <div class="customer-bubble-cont">\n        <div class="msg-info" :if="(this.namePos == \'outsideAbove\' || this.timePos == \'outsideAbove\') && this.textAlignment == \'right\'">\n            <div class="msg-info-time"><span :if="this.showTime && this.timePos == \'outsideAbove\'" :style="this.timeStyle"></span></div>\n            <div class="msg-info-name"><span :if="this.showName && this.namePos == \'outsideAbove\'" :style="this.nameStyle"></span></div>\n        </div>\n        <div :else class="msg-info" :if="this.namePos == \'outsideAbove\' || this.timePos == \'outsideAbove\'">\n            <div class="msg-info-name"><span :if="this.showName && this.namePos == \'outsideAbove\'" :style="this.nameStyle"></span></div>\n            <div class="msg-info-time"><span :if="this.showTime && this.timePos == \'outsideAbove\'" :style="this.timeStyle"></span></div>\n        </div>\n        <div class="bubble-container">\n\n        </div>\n        <div class="msg-info below enter" :if="(this.namePos == \'outsideBelow\' || this.timePos == \'outsideBelow\')  && this.textAlignment == \'right\'">\n            <div class="msg-info-time"><span :if="this.showTime && this.timePos == \'outsideBelow\'" :style="this.timeStyle"></span></div>\n            <div class="msg-info-name"><span :if="this.showName && this.namePos == \'outsideBelow\'" :style="this.nameStyle"></span></div>\n        </div>\n        <div :else class="msg-info below enter" :if="this.namePos == \'outsideBelow\' || this.timePos == \'outsideBelow\'">\n            <div class="msg-info-name"><span :if="this.showName && this.namePos == \'outsideBelow\'" :style="this.nameStyle"></span></div>\n            <div class="msg-info-time"><span :if="this.showTime && this.timePos == \'outsideBelow\'" :style="this.timeStyle"></span></div>\n        </div>\n\n    </div>\n    <div :if="this.speechView" class="speechCont enter">\n        <div class="avatar" :style="this.avatarStyle"></div>\n    </div>\n</div>'},function(e,t){e.exports='<div class="agent-container">\n    <div :if="this.speechView" class="speechCont enter">\n        <div class="avatar" :style="this.avatarStyle"></div>\n    </div>\n    <div class="agent-bubble-cont">\n        <div class="msg-info" :if="this.namePos == \'outsideAbove\' || this.timePos == \'outsideAbove\'">\n            <div class="msg-info-name"><span :if="this.showName && this.namePos == \'outsideAbove\'" :style="this.nameStyle"></span></div>\n            <div class="msg-info-time"><span :if="this.showTime && this.timePos == \'outsideAbove\'" :style="this.timeStyle"></span></div>\n        </div>\n        <div class="bubble-container">\n\n        </div>\n        <div class="msg-info below enter" :if="this.namePos == \'outsideBelow\' || this.timePos == \'outsideBelow\'">\n            <div class="msg-info-name"><span :if="this.showName && this.namePos == \'outsideBelow\'" :style="this.nameStyle"></span></div>\n            <div class="msg-info-time"><span :if="this.showTime && this.timePos == \'outsideBelow\'" :style="this.timeStyle"></span></div>\n        </div>\n    </div>\n</div>'},function(e,t){e.exports='<div>\n    <div :style="this.style" :class="agent-bubble bubble background-img:true;w-100:!this.hugging;" tabindex="-1">\n        <span class="msg-info" :if="this.namePos == \'withinTop\' || this.timePos == \'withinTop\'">\n            <span class="msg-info-name"><span :if="this.showName && this.namePos == \'withinTop\'" :style="this.nameStyle">{this.prop.name}</span></span>\n            <span class="msg-info-time" aria-hidden="true"><span :if="this.showTime && this.timePos == \'withinTop\'" :style="this.timeStyle">{this.timeText}</span></span>\n        </span>\n        <div @click="onBubbleClick" @touchend="onBubbleClick" @touchstart="onBubbleTouch">{this.messageText || ""}</div>\n        <span class="msg-info" :if="this.namePos == \'withinBottom\' || this.timePos == \'withinBottom\'">\n            <span class="msg-info-name"><span :if="this.showName && this.namePos == \'withinBottom\'" :style="this.nameStyle">{this.prop.name}</span></span>\n            <span class="msg-info-time"><span :if="this.showTime && this.timePos == \'withinBottom\'" :style="this.timeStyle">{this.timeText}</span></span>\n        </span>\n    </div>\n</div>\n'},function(e,t){e.exports='<div>\n    <div :style="this.style" :class="customer-bubble bubble background-img:true;w-100:!this.hugging;left-align:this.textAlignment == \'left\';" tabindex="-1">\n        <span class="msg-info" :if="this.textAlignment == \'right\'">\n            <span class="msg-info-time" aria-hidden="true"><span :if="this.showTime && this.timePos == \'withinTop\'" :style="this.timeStyle">{this.timeText}</span></span>\n            <span class="msg-info-name"><span :if="this.showName && this.namePos == \'withinTop\'" :style="this.nameStyle">{this.prop.name}</span></span>\n        </span>\n        <span class="msg-info" :else>\n            <span class="msg-info-name"><span :if="this.showName && this.namePos == \'withinTop\'" :style="this.nameStyle">{this.prop.name}</span></span>\n            <span class="msg-info-time" aria-hidden="true"><span :if="this.showTime && this.timePos == \'withinTop\'" :style="this.timeStyle">{this.timeText}</span></span>\n        </span>\n        <span> {this.prop.messagetext || ""} </span>\n        <span class="msg-info" :if="this.textAlignment == \'right\'">\n            <span class="msg-info-time"><span :if="this.showTime && this.timePos == \'withinBottom\'" :style="this.timeStyle">{this.timeText}</span></span>\n            <span class="msg-info-name"><span :if="this.showName && this.namePos == \'withinBottom\'" :style="this.nameStyle">{this.prop.name}</span></span>\n        </span>\n        <span class="msg-info" :else>\n            <span class="msg-info-name"><span :if="this.showName && this.namePos == \'withinBottom\'" :style="this.nameStyle">{this.prop.name}</span></span>\n            <span class="msg-info-time"><span :if="this.showTime && this.timePos == \'withinBottom\'" :style="this.timeStyle">{this.timeText}</span></span>\n        </span>\n    </div>\n    <div style="clear:both;"></div>\n</div>\n'},function(e,t){e.exports='<div class="typingCont">\n    <div class="typing"  :style="this.style" tabindex="-1">\n        <div :if="this.showTypingAnimation">\n            <div :for="item in this.typingElipsisStyles" class="ellipsis" :style="item"></div>\n        </div>\n        <div :else class="typing-text"></div>\n    </div>\n</div>'},function(e,t){e.exports='<div class="systemCont">\n <div class="system"  :style="this.style" tabindex="-1">\n  <div class="system-icon" :style="this.iconstyle">\n  </div>\n  <div class="text">{this.messageText}</div>\n </div>\n</div>'},function(e,t){e.exports='<div class="headerCont">\n    <div class="header"  :style="this.style">\n        <div class="text"></div>\n    </div>\n</div>'},function(e,t){e.exports='<div class="modal">\n    <div class="modal-content" role="alertdialog" aria-modal="true" aria-describedby="modal-body">\n        <div class="modal-body" :style="this.modalText" id="modal-body">\n            <p>{this.closeText}</p>\n        </div>\n        <div class="modal-footer">\n            <button class="modal-button cancel-button" @click="onCancelClick" :style="this.butstyle" aria-keyshortcuts="Escape">{this.closeB1Text}</button>\n            <button class="modal-button ok-button" @click="onOkClick" :style="this.butstyle" :if="!this.isCallInProgress">{this.closeB2Text}</button>\n            <button class="modal-button ok-button" @click="onEndCallClick" :style="this.butstyle" :if="this.isCallInProgress">{this.endCallBtnText}</button>\n            <button class="modal-button ok-button" @click="onOkClick" :style="this.butstyle" :if="this.isCallInProgress">{this.closeChatAndCallBtnText}</button>\n        </div>\n    </div>\n</div>'},function(e,t){e.exports='<div class="modal">\n    <div class="modal-content enter-email {this.emailSent?\'email-sent\':\'\'} {!this.moveEmailCancelBtnToBottom?\'order-btn\':\'\'}">\n        <div :if="!this.emailSent">\n            <button :if="!this.moveEmailCancelBtnToBottom" class="modal-button cancel-btn-top" \n                        role="button" \n                        @click="onCancelClick" \n                        :style="this.btnStyle"\n                        tabindex="0"\n                >{this.cancelBtnText}</button>\n            <div class="modal-body">\n                <div class="email-label" id="email-modal-input-label" :style="this.textStyle">{this.emailText}</div>\n                <div class="group">\n                    <input type="email" \n                           id="name" \n                           class="{this.isEmailValid ? \'\' : \'invalid\'}" \n                           :style="this.inputStyle" \n                           @keyup="onKeyUp"\n                           aria-labelledby="email-modal-input-label"/>\n                    <span class="error-msg">{this.errorMsgText}</span>\n                </div>\n            </div>\n            <div class="modal-footer">\n                <button :if="this.moveEmailCancelBtnToBottom" class="modal-button"\n                        role="button" \n                        @click="onCancelClick" \n                        :style="this.btnStyle"\n                        tabindex="0"\n                >{this.cancelBtnText}</button>\n                <button class="modal-button" \n                        role="button" \n                        @click="onSendClick" \n                        :style="this.btnStyle"\n                        tabindex="0"\n                >{this.sendBtnText}</button>\n            </div>\n        </div>\n        <div :else>\n            <div class="modal-body">\n                <div class="email-sent-label" :style="this.textStyle">{this.mailSentText}</div>\n            </div>\n            <div class="modal-footer">\n                <button class="modal-button js-close-button" \n                        role="button" \n                        @click="onCloseClick" \n                        :style="this.btnStyle"\n                        tabindex="0"\n                >{this.okBtnText}</button>\n            </div>\n        </div>\n</div>'},function(e,t){e.exports='<div class="modal">\n    <div class="modal-content info-modal-view">\n        <div class="modal-body">\n        </div>\n        <div class="modal-footer">\n            <button class="modal-button" @click="onOkClick" :style="this.btnStyles">{this.closeButtonText}</button>\n        </div>\n    </div>\n</div>'},function(e,t){e.exports='<div class="disclaimer-container">\n    <div class="disclaimer"  :style="this.style" tabindex="-1">\n        <div :if="this.disImgConfig" class="disclaimer-icon" :style="this.imgstyle">\n        </div>\n        <div class="text" @click="onItemClick"></div>\n    </div>\n    <hr>\n</div>'},function(e,t){e.exports='<div class="messaging-top-bar" :style="this.barStyle" id="top-bar">\n    <div class="top-bar-left h-100 d-flex" :if="this.config.surveyLeftTopBarItems">\n        <div :for="item in this.config.surveyLeftTopBarItems">\n            <div :if="item.type == \'Overflow\'" class="overflow-menu top-bar-item left" :style="this.topBarIconStyle" @click="onHoverClick">\n                <div class="dots"></div>\n                <div class="overflow-menu-items" :style="this.overFlowMenuStyle">\n                    <overflow-item :for="overflowitem in this.config.surveyOverFlowItems" type="{overflowitem.type}"  imgName="{overflowitem.imgName}" imgSrc="{overflowitem.imgSrc}" text="{overflowitem.text}" content="{overflowitem.content}" audioOnImgName="{overflowitem.audioOnImgName}" audioOffImgName="{overflowitem.audioOffImgName}"></overflow-item>\n                </div>\n            </div>\n            <topbar-element :else type="{item.type}" imgName="{item.imgName}" imgSrc="{item.imgSrc}" text="{item.text}" audioOnImgName="{item.audioOnImgName}" audioOffImgName="{item.audioOffImgName}"></topbar-element>\n        </div>\n    </div>\n    <div class="top-bar-right h-100 d-flex"  :if="this.config.surveyRightTopBarItems">\n        <div :for="item in this.config.surveyRightTopBarItems">\n            <div :if="item.type == \'Overflow\'" class="overflow-menu top-bar-item right" :style="this.topBarIconStyle" @click="onHoverClick">\n                <div class="dots"></div>\n                <div class="overflow-menu-items" :style="this.overFlowMenuStyle">\n                    <overflow-item :for="overflowitem in this.config.surveyOverFlowItems" type="{overflowitem.type}"  imgName="{overflowitem.imgName}" imgSrc="{overflowitem.imgSrc}" text="{overflowitem.text}" content="{overflowitem.content}" audioOnImgName="{overflowitem.audioOnImgName}" audioOffImgName="{overflowitem.audioOffImgName}"></overflow-item>\n                </div>\n            </div>\n            <topbar-element :else type="{item.type}" imgName="{item.imgName}" imgSrc="{item.imgSrc}" text="{item.text}" audioOnImgName="{item.audioOnImgName}" audioOffImgName="{item.audioOffImgName}"></topbar-element>\n        </div>\n    </div>\n\n    <div :if="this.config.surveyCenterTopBarItems" class="top-bar-center h-100 d-flex">\n        <topbar-element :for="item in this.config.surveyCenterTopBarItems" type="{item.type}" imgName="{item.imgName}" imgSrc="{item.imgSrc}" text="{item.text}" audioOnImgName="{item.audioOnImgName}" audioOffImgName="{item.audioOffImgName}"></topbar-element>\n    </div>\n</div>'},function(e,t){e.exports='<div :class="survey-area:true; extended-top-bar:this.extendedSurveyTopBarVisible;extended-footer:this.extendedSurveyFooterVisible" :style="this.style" :if="this.prop.issurvey == \'true\'">\n</div>'},function(e,t){e.exports='<div>\n    <div :if="this.showAvatar" class="speechCont enter">\n        <div class="avatar" :style="this.avatarStyle"></div>\n    </div>\n    <div class="richBubbleContainer">\n        <div class="msg-info hide" :if="this.showRichInfo">\n            <div class="msg-info-name"><span :if="this.showName" :style="this.nameStyle"></span></div>\n            <div class="msg-info-time"><span :if="this.showTime" :style="this.timeStyle"></span></div>\n        </div>\n    </div>\n</div>'},function(e,t){e.exports='<div class="footer-disclaimer-container">\n    <div class="disclaimer"  :style="this.style" tabindex="-1">\n        <div :if="this.disImgConfig" class="disclaimer-icon" :style="this.imgstyle">\n        </div>\n        <div class="text" @click="onItemClick"></div>\n    </div>\n</div>'},function(e,t){e.exports='<textarea placeholder="{this.config.placeholder || \'Type your message...\'}" :style="this.inputStyles" @focus="onInputFocus" @blur="onInputBlurred"  @keypress="onKeyPress"\n          @keyup="onKeyUp"\n          @input="onInput"\n          @paste="onPaste" :class="auto-grow-input:this.config.autoGrow;single-line-input:!this.config.multiline;"></textarea>\n\x3c!--input :else type="text" placeholder="{this.config.placeholder || \'Type your messsage...\'}" :style="this.inputStyles" @focus="onInputFocus" @blur="onInputBlurred"  @keypress="onKeyPress"\n       @keyup="onKeyUp"\n       @input="onInput"\n       @paste="onPaste"/--\x3e'},function(e,t){e.exports='<div :if="this.prop.type === \'Send\'" class="send-container footer-button-cont">\n    <input type="submit"\n           :class="sendText:this.config.sendButtonText;sendButton:true;"\n           :style="this.sendButtonStyles"\n           title="{this.text}"\n           value="{this.config.sendButtonText || \'\'}"\n           @click="onButtonClick"\n           @touchstart="onButtonClick"\n    />\n</div>\n<div :else class="footer-button-cont">\n    <input type="submit"\n           :class="footer-button:true;"\n           :style="this.footerButtonStyles"\n           @click="onButtonClick"\n           @touchstart="onButtonClick"\n           title="{this.text}"\n           aria-label="{this.text}"\n           value=""\n    />\n</div>\n'},function(e,t){e.exports='<div class="emoji-composer-popover emoji-composer-emoji-popover" :style="this.popoverStyles">\n    <div class="emoji-picker" :style="this.pickerStyles">\n        <div class="emoji-composer-popover-header"><input class="emoji-composer-popover-input" placeholder="Search" value="" @input="search"></div>\n        <div class="emoji-composer-popover-body-container">\n            <div class="emoji-composer-popover-body" @click="onSelected">\n                <div class="emoji-picker-groups">\n                    <div class="emoji-picker-group">\n                        <div class="emoji-picker-group-title">Frequently used</div><span class="emoji-picker-emoji" title="thumbs_up">👍</span><span class="emoji-picker-emoji" title="-1">👎</span><span class="emoji-picker-emoji" title="sob">😭</span><span class="emoji-picker-emoji" title="confused">😕</span><span class="emoji-picker-emoji" title="neutral_face">😐</span><span class="emoji-picker-emoji" title="blush">😊</span><span class="emoji-picker-emoji" title="heart_eyes">😍</span>\n                    </div>\n                    <div class="emoji-picker-group">\n                        <div class="emoji-picker-group-title">People</div><span class="emoji-picker-emoji" title="smile">😄</span><span class="emoji-picker-emoji" title="smiley">😃</span><span class="emoji-picker-emoji" title="grinning">😀</span><span class="emoji-picker-emoji" title="blush">😊</span><span class="emoji-picker-emoji" title="wink">😉</span><span class="emoji-picker-emoji" title="heart_eyes">😍</span><span class="emoji-picker-emoji" title="kissing_heart">😘</span><span class="emoji-picker-emoji" title="kissing_closed_eyes">😚</span><span class="emoji-picker-emoji" title="kissing">😗</span><span class="emoji-picker-emoji" title="kissing_smiling_eyes">😙</span><span class="emoji-picker-emoji" title="stuck_out_tongue_winking_eye">😜</span><span class="emoji-picker-emoji" title="stuck_out_tongue_closed_eyes">😝</span><span class="emoji-picker-emoji" title="stuck_out_tongue">😛</span><span class="emoji-picker-emoji" title="flushed">😳</span><span class="emoji-picker-emoji" title="grin">😁</span><span class="emoji-picker-emoji" title="pensive">😔</span><span class="emoji-picker-emoji" title="relieved">😌</span><span class="emoji-picker-emoji" title="unamused">😒</span><span class="emoji-picker-emoji" title="disappointed">😞</span><span class="emoji-picker-emoji" title="persevere">😣</span><span class="emoji-picker-emoji" title="cry">😢</span><span class="emoji-picker-emoji" title="joy">😂</span><span class="emoji-picker-emoji" title="sob">😭</span><span class="emoji-picker-emoji" title="sleepy">😪</span><span class="emoji-picker-emoji" title="disappointed_relieved">😥</span><span class="emoji-picker-emoji" title="cold_sweat">😰</span><span class="emoji-picker-emoji" title="sweat_smile">😅</span><span class="emoji-picker-emoji" title="sweat">😓</span><span class="emoji-picker-emoji" title="weary">😩</span><span class="emoji-picker-emoji" title="tired_face">😫</span><span class="emoji-picker-emoji" title="fearful">😨</span><span class="emoji-picker-emoji" title="scream">😱</span><span class="emoji-picker-emoji" title="angry">😠</span><span class="emoji-picker-emoji" title="rage">😡</span><span class="emoji-picker-emoji" title="triumph">😤</span><span class="emoji-picker-emoji" title="confounded">😖</span><span class="emoji-picker-emoji" title="laughing">😆</span><span class="emoji-picker-emoji" title="yum">😋</span><span class="emoji-picker-emoji" title="mask">😷</span><span class="emoji-picker-emoji" title="sunglasses">😎</span><span class="emoji-picker-emoji" title="sleeping">😴</span><span class="emoji-picker-emoji" title="dizzy_face">😵</span><span class="emoji-picker-emoji" title="astonished">😲</span><span class="emoji-picker-emoji" title="worried">😟</span><span class="emoji-picker-emoji" title="frowning">😦</span><span class="emoji-picker-emoji" title="anguished">😧</span><span class="emoji-picker-emoji" title="imp">👿</span><span class="emoji-picker-emoji" title="open_mouth">😮</span><span class="emoji-picker-emoji" title="grimacing">😬</span><span class="emoji-picker-emoji" title="neutral_face">😐</span><span class="emoji-picker-emoji" title="confused">😕</span><span class="emoji-picker-emoji" title="hushed">😯</span><span class="emoji-picker-emoji" title="smirk">😏</span><span class="emoji-picker-emoji" title="expressionless">😑</span><span class="emoji-picker-emoji" title="man_with_gua_pi_mao">👲</span><span class="emoji-picker-emoji" title="man_with_turban">👳</span><span class="emoji-picker-emoji" title="cop">👮</span><span class="emoji-picker-emoji" title="construction_worker">👷</span><span class="emoji-picker-emoji" title="guardsman">💂</span><span class="emoji-picker-emoji" title="baby">👶</span><span class="emoji-picker-emoji" title="boy">👦</span><span class="emoji-picker-emoji" title="girl">👧</span><span class="emoji-picker-emoji" title="man">👨</span><span class="emoji-picker-emoji" title="woman">👩</span><span class="emoji-picker-emoji" title="older_man">👴</span><span class="emoji-picker-emoji" title="older_woman">👵</span><span class="emoji-picker-emoji" title="person_with_blond_hair">👱</span><span class="emoji-picker-emoji" title="angel">👼</span><span class="emoji-picker-emoji" title="princess">👸</span><span class="emoji-picker-emoji" title="smiley_cat">😺</span><span class="emoji-picker-emoji" title="smile_cat">😸</span><span class="emoji-picker-emoji" title="heart_eyes_cat">😻</span><span class="emoji-picker-emoji" title="kissing_cat">😽</span><span class="emoji-picker-emoji" title="smirk_cat">😼</span><span class="emoji-picker-emoji" title="scream_cat">🙀</span><span class="emoji-picker-emoji" title="crying_cat_face">😿</span><span class="emoji-picker-emoji" title="joy_cat">😹</span><span class="emoji-picker-emoji" title="pouting_cat">😾</span><span class="emoji-picker-emoji" title="japanese_ogre">👹</span><span class="emoji-picker-emoji" title="japanese_goblin">👺</span><span class="emoji-picker-emoji" title="see_no_evil">🙈</span><span class="emoji-picker-emoji" title="hear_no_evil">🙉</span><span class="emoji-picker-emoji" title="speak_no_evil">🙊</span><span class="emoji-picker-emoji" title="skull">💀</span><span class="emoji-picker-emoji" title="alien">👽</span><span class="emoji-picker-emoji" title="hankey">💩</span><span class="emoji-picker-emoji" title="fire">🔥</span><span class="emoji-picker-emoji" title="sparkles">✨</span><span class="emoji-picker-emoji" title="star2">🌟</span><span class="emoji-picker-emoji" title="dizzy">💫</span><span class="emoji-picker-emoji" title="boom">💥</span><span class="emoji-picker-emoji" title="anger">💢</span><span class="emoji-picker-emoji" title="sweat_drops">💦</span><span class="emoji-picker-emoji" title="droplet">💧</span><span class="emoji-picker-emoji" title="zzz">💤</span><span class="emoji-picker-emoji" title="dash">💨</span><span class="emoji-picker-emoji" title="ear">👂</span><span class="emoji-picker-emoji" title="eyes">👀</span><span class="emoji-picker-emoji" title="nose">👃</span><span class="emoji-picker-emoji" title="tongue">👅</span><span class="emoji-picker-emoji" title="lips">👄</span><span class="emoji-picker-emoji" title="thumbs_up">👍</span><span class="emoji-picker-emoji" title="-1">👎</span><span class="emoji-picker-emoji" title="ok_hand">👌</span><span class="emoji-picker-emoji" title="facepunch">👊</span><span class="emoji-picker-emoji" title="fist">✊</span><span class="emoji-picker-emoji" title="wave">👋</span><span class="emoji-picker-emoji" title="hand">✋</span><span class="emoji-picker-emoji" title="open_hands">👐</span><span class="emoji-picker-emoji" title="point_up_2">👆</span><span class="emoji-picker-emoji" title="point_down">👇</span><span class="emoji-picker-emoji" title="point_right">👉</span><span class="emoji-picker-emoji" title="point_left">👈</span><span class="emoji-picker-emoji" title="raised_hands">🙌</span><span class="emoji-picker-emoji" title="pray">🙏</span><span class="emoji-picker-emoji" title="clap">👏</span><span class="emoji-picker-emoji" title="muscle">💪</span><span class="emoji-picker-emoji" title="walking">🚶</span><span class="emoji-picker-emoji" title="runner">🏃</span><span class="emoji-picker-emoji" title="dancer">💃</span><span class="emoji-picker-emoji" title="couple">👫</span><span class="emoji-picker-emoji" title="family">👪</span><span class="emoji-picker-emoji" title="couplekiss">💏</span><span class="emoji-picker-emoji" title="couple_with_heart">💑</span><span class="emoji-picker-emoji" title="dancers">👯</span><span class="emoji-picker-emoji" title="ok_woman">🙆</span><span class="emoji-picker-emoji" title="no_good">🙅</span><span class="emoji-picker-emoji" title="information_desk_person">💁</span><span class="emoji-picker-emoji" title="raising_hand">🙋</span><span class="emoji-picker-emoji" title="massage">💆</span><span class="emoji-picker-emoji" title="haircut">💇</span><span class="emoji-picker-emoji" title="nail_care">💅</span><span class="emoji-picker-emoji" title="bride_with_veil">👰</span><span class="emoji-picker-emoji" title="person_with_pouting_face">🙎</span><span class="emoji-picker-emoji" title="person_frowning">🙍</span><span class="emoji-picker-emoji" title="bow">🙇</span><span class="emoji-picker-emoji" title="tophat">🎩</span><span class="emoji-picker-emoji" title="crown">👑</span><span class="emoji-picker-emoji" title="womans_hat">👒</span><span class="emoji-picker-emoji" title="athletic_shoe">👟</span><span class="emoji-picker-emoji" title="mans_shoe">👞</span><span class="emoji-picker-emoji" title="sandal">👡</span><span class="emoji-picker-emoji" title="high_heel">👠</span><span class="emoji-picker-emoji" title="boot">👢</span><span class="emoji-picker-emoji" title="shirt">👕</span><span class="emoji-picker-emoji" title="necktie">👔</span><span class="emoji-picker-emoji" title="womans_clothes">👚</span><span class="emoji-picker-emoji" title="dress">👗</span><span class="emoji-picker-emoji" title="running_shirt_with_sash">🎽</span><span class="emoji-picker-emoji" title="jeans">👖</span><span class="emoji-picker-emoji" title="kimono">👘</span><span class="emoji-picker-emoji" title="bikini">👙</span><span class="emoji-picker-emoji" title="briefcase">💼</span><span class="emoji-picker-emoji" title="handbag">👜</span><span class="emoji-picker-emoji" title="pouch">👝</span><span class="emoji-picker-emoji" title="purse">👛</span><span class="emoji-picker-emoji" title="eyeglasses">👓</span><span class="emoji-picker-emoji" title="ribbon">🎀</span><span class="emoji-picker-emoji" title="closed_umbrella">🌂</span><span class="emoji-picker-emoji" title="lipstick">💄</span><span class="emoji-picker-emoji" title="yellow_heart">💛</span><span class="emoji-picker-emoji" title="blue_heart">💙</span><span class="emoji-picker-emoji" title="purple_heart">💜</span><span class="emoji-picker-emoji" title="green_heart">💚</span><span class="emoji-picker-emoji" title="broken_heart">💔</span><span class="emoji-picker-emoji" title="heartpulse">💗</span><span class="emoji-picker-emoji" title="heartbeat">💓</span><span class="emoji-picker-emoji" title="two_hearts">💕</span><span class="emoji-picker-emoji" title="sparkling_heart">💖</span><span class="emoji-picker-emoji" title="revolving_hearts">💞</span><span class="emoji-picker-emoji" title="cupid">💘</span><span class="emoji-picker-emoji" title="love_letter">💌</span><span class="emoji-picker-emoji" title="kiss">💋</span><span class="emoji-picker-emoji" title="ring">💍</span><span class="emoji-picker-emoji" title="gem">💎</span><span class="emoji-picker-emoji" title="bust_in_silhouette">👤</span><span class="emoji-picker-emoji" title="speech_balloon">💬</span><span class="emoji-picker-emoji" title="footprints">👣</span>\n                    </div>\n                    <div class="emoji-picker-group">\n                        <div class="emoji-picker-group-title">Nature</div><span class="emoji-picker-emoji" title="dog">🐶</span><span class="emoji-picker-emoji" title="wolf">🐺</span><span class="emoji-picker-emoji" title="cat">🐱</span><span class="emoji-picker-emoji" title="mouse">🐭</span><span class="emoji-picker-emoji" title="hamster">🐹</span><span class="emoji-picker-emoji" title="rabbit">🐰</span><span class="emoji-picker-emoji" title="frog">🐸</span><span class="emoji-picker-emoji" title="tiger">🐯</span><span class="emoji-picker-emoji" title="koala">🐨</span><span class="emoji-picker-emoji" title="bear">🐻</span><span class="emoji-picker-emoji" title="pig">🐷</span><span class="emoji-picker-emoji" title="pig_nose">🐽</span><span class="emoji-picker-emoji" title="cow">🐮</span><span class="emoji-picker-emoji" title="boar">🐗</span><span class="emoji-picker-emoji" title="monkey_face">🐵</span><span class="emoji-picker-emoji" title="monkey">🐒</span><span class="emoji-picker-emoji" title="horse">🐴</span><span class="emoji-picker-emoji" title="sheep">🐑</span><span class="emoji-picker-emoji" title="elephant">🐘</span><span class="emoji-picker-emoji" title="panda_face">🐼</span><span class="emoji-picker-emoji" title="penguin">🐧</span><span class="emoji-picker-emoji" title="bird">🐦</span><span class="emoji-picker-emoji" title="baby_chick">🐤</span><span class="emoji-picker-emoji" title="hatched_chick">🐥</span><span class="emoji-picker-emoji" title="hatching_chick">🐣</span><span class="emoji-picker-emoji" title="chicken">🐔</span><span class="emoji-picker-emoji" title="snake">🐍</span><span class="emoji-picker-emoji" title="turtle">🐢</span><span class="emoji-picker-emoji" title="bug">🐛</span><span class="emoji-picker-emoji" title="bee">🐝</span><span class="emoji-picker-emoji" title="ant">🐜</span><span class="emoji-picker-emoji" title="beetle">🐞</span><span class="emoji-picker-emoji" title="snail">🐌</span><span class="emoji-picker-emoji" title="octopus">🐙</span><span class="emoji-picker-emoji" title="shell">🐚</span><span class="emoji-picker-emoji" title="tropical_fish">🐠</span><span class="emoji-picker-emoji" title="fish">🐟</span><span class="emoji-picker-emoji" title="dolphin">🐬</span><span class="emoji-picker-emoji" title="whale">🐳</span><span class="emoji-picker-emoji" title="racehorse">🐎</span><span class="emoji-picker-emoji" title="dragon_face">🐲</span><span class="emoji-picker-emoji" title="blowfish">🐡</span><span class="emoji-picker-emoji" title="camel">🐫</span><span class="emoji-picker-emoji" title="poodle">🐩</span><span class="emoji-picker-emoji" title="feet">🐾</span><span class="emoji-picker-emoji" title="bouquet">💐</span><span class="emoji-picker-emoji" title="cherry_blossom">🌸</span><span class="emoji-picker-emoji" title="tulip">🌷</span><span class="emoji-picker-emoji" title="four_leaf_clover">🍀</span><span class="emoji-picker-emoji" title="rose">🌹</span><span class="emoji-picker-emoji" title="sunflower">🌻</span><span class="emoji-picker-emoji" title="hibiscus">🌺</span><span class="emoji-picker-emoji" title="maple_leaf">🍁</span><span class="emoji-picker-emoji" title="leaves">🍃</span><span class="emoji-picker-emoji" title="fallen_leaf">🍂</span><span class="emoji-picker-emoji" title="herb">🌿</span><span class="emoji-picker-emoji" title="ear_of_rice">🌾</span><span class="emoji-picker-emoji" title="mushroom">🍄</span><span class="emoji-picker-emoji" title="cactus">🌵</span><span class="emoji-picker-emoji" title="palm_tree">🌴</span><span class="emoji-picker-emoji" title="chestnut">🌰</span><span class="emoji-picker-emoji" title="seedling">🌱</span><span class="emoji-picker-emoji" title="blossom">🌼</span><span class="emoji-picker-emoji" title="new_moon">🌑</span><span class="emoji-picker-emoji" title="first_quarter_moon">🌓</span><span class="emoji-picker-emoji" title="moon">🌔</span><span class="emoji-picker-emoji" title="full_moon">🌕</span><span class="emoji-picker-emoji" title="first_quarter_moon_with_face">🌛</span><span class="emoji-picker-emoji" title="crescent_moon">🌙</span><span class="emoji-picker-emoji" title="earth_asia">🌏</span><span class="emoji-picker-emoji" title="volcano">🌋</span><span class="emoji-picker-emoji" title="milky_way">🌌</span><span class="emoji-picker-emoji" title="stars">🌠</span><span class="emoji-picker-emoji" title="partly_sunny">⛅</span><span class="emoji-picker-emoji" title="snowman">⛄</span><span class="emoji-picker-emoji" title="cyclone">🌀</span><span class="emoji-picker-emoji" title="foggy">🌁</span><span class="emoji-picker-emoji" title="rainbow">🌈</span><span class="emoji-picker-emoji" title="ocean">🌊</span>\n                    </div>\n                    <div class="emoji-picker-group">\n                        <div class="emoji-picker-group-title">Objects</div><span class="emoji-picker-emoji" title="bamboo">🎍</span><span class="emoji-picker-emoji" title="gift_heart">💝</span><span class="emoji-picker-emoji" title="dolls">🎎</span><span class="emoji-picker-emoji" title="school_satchel">🎒</span><span class="emoji-picker-emoji" title="mortar_board">🎓</span><span class="emoji-picker-emoji" title="flags">🎏</span><span class="emoji-picker-emoji" title="fireworks">🎆</span><span class="emoji-picker-emoji" title="sparkler">🎇</span><span class="emoji-picker-emoji" title="wind_chime">🎐</span><span class="emoji-picker-emoji" title="rice_scene">🎑</span><span class="emoji-picker-emoji" title="jack_o_lantern">🎃</span><span class="emoji-picker-emoji" title="ghost">👻</span><span class="emoji-picker-emoji" title="santa">🎅</span><span class="emoji-picker-emoji" title="christmas_tree">🎄</span><span class="emoji-picker-emoji" title="gift">🎁</span><span class="emoji-picker-emoji" title="tanabata_tree">🎋</span><span class="emoji-picker-emoji" title="tada">🎉</span><span class="emoji-picker-emoji" title="confetti_ball">🎊</span><span class="emoji-picker-emoji" title="balloon">🎈</span><span class="emoji-picker-emoji" title="crossed_flags">🎌</span><span class="emoji-picker-emoji" title="crystal_ball">🔮</span><span class="emoji-picker-emoji" title="movie_camera">🎥</span><span class="emoji-picker-emoji" title="camera">📷</span><span class="emoji-picker-emoji" title="video_camera">📹</span><span class="emoji-picker-emoji" title="vhs">📼</span><span class="emoji-picker-emoji" title="cd">💿</span><span class="emoji-picker-emoji" title="dvd">📀</span><span class="emoji-picker-emoji" title="minidisc">💽</span><span class="emoji-picker-emoji" title="floppy_disk">💾</span><span class="emoji-picker-emoji" title="computer">💻</span><span class="emoji-picker-emoji" title="iphone">📱</span><span class="emoji-picker-emoji" title="telephone_receiver">📞</span><span class="emoji-picker-emoji" title="pager">📟</span><span class="emoji-picker-emoji" title="fax">📠</span><span class="emoji-picker-emoji" title="satellite">📡</span><span class="emoji-picker-emoji" title="tv">📺</span><span class="emoji-picker-emoji" title="radio">📻</span><span class="emoji-picker-emoji" title="loud_sound">🔊</span><span class="emoji-picker-emoji" title="bell">🔔</span><span class="emoji-picker-emoji" title="loudspeaker">📢</span><span class="emoji-picker-emoji" title="mega">📣</span><span class="emoji-picker-emoji" title="hourglass_flowing_sand">⏳</span><span class="emoji-picker-emoji" title="hourglass">⌛</span><span class="emoji-picker-emoji" title="alarm_clock">⏰</span><span class="emoji-picker-emoji" title="watch">⌚</span><span class="emoji-picker-emoji" title="unlock">🔓</span><span class="emoji-picker-emoji" title="lock">🔒</span><span class="emoji-picker-emoji" title="lock_with_ink_pen">🔏</span><span class="emoji-picker-emoji" title="closed_lock_with_key">🔐</span><span class="emoji-picker-emoji" title="key">🔑</span><span class="emoji-picker-emoji" title="mag_right">🔎</span><span class="emoji-picker-emoji" title="bulb">💡</span><span class="emoji-picker-emoji" title="flashlight">🔦</span><span class="emoji-picker-emoji" title="electric_plug">🔌</span><span class="emoji-picker-emoji" title="battery">🔋</span><span class="emoji-picker-emoji" title="mag">🔍</span><span class="emoji-picker-emoji" title="bath">🛀</span><span class="emoji-picker-emoji" title="toilet">🚽</span><span class="emoji-picker-emoji" title="wrench">🔧</span><span class="emoji-picker-emoji" title="nut_and_bolt">🔩</span><span class="emoji-picker-emoji" title="hammer">🔨</span><span class="emoji-picker-emoji" title="door">🚪</span><span class="emoji-picker-emoji" title="smoking">🚬</span><span class="emoji-picker-emoji" title="bomb">💣</span><span class="emoji-picker-emoji" title="gun">🔫</span><span class="emoji-picker-emoji" title="hocho">🔪</span><span class="emoji-picker-emoji" title="pill">💊</span><span class="emoji-picker-emoji" title="syringe">💉</span><span class="emoji-picker-emoji" title="moneybag">💰</span><span class="emoji-picker-emoji" title="yen">💴</span><span class="emoji-picker-emoji" title="dollar">💵</span><span class="emoji-picker-emoji" title="credit_card">💳</span><span class="emoji-picker-emoji" title="money_with_wings">💸</span><span class="emoji-picker-emoji" title="calling">📲</span><span class="emoji-picker-emoji" title="e-mail">📧</span><span class="emoji-picker-emoji" title="inbox_tray">📥</span><span class="emoji-picker-emoji" title="outbox_tray">📤</span><span class="emoji-picker-emoji" title="envelope_with_arrow">📩</span><span class="emoji-picker-emoji" title="incoming_envelope">📨</span><span class="emoji-picker-emoji" title="mailbox">📫</span><span class="emoji-picker-emoji" title="mailbox_closed">📪</span><span class="emoji-picker-emoji" title="postbox">📮</span><span class="emoji-picker-emoji" title="package">📦</span><span class="emoji-picker-emoji" title="memo">📝</span><span class="emoji-picker-emoji" title="page_facing_up">📄</span><span class="emoji-picker-emoji" title="page_with_curl">📃</span><span class="emoji-picker-emoji" title="bookmark_tabs">📑</span><span class="emoji-picker-emoji" title="bar_chart">📊</span><span class="emoji-picker-emoji" title="chart_with_upwards_trend">📈</span><span class="emoji-picker-emoji" title="chart_with_downwards_trend">📉</span><span class="emoji-picker-emoji" title="scroll">📜</span><span class="emoji-picker-emoji" title="clipboard">📋</span><span class="emoji-picker-emoji" title="date">📅</span><span class="emoji-picker-emoji" title="calendar">📆</span><span class="emoji-picker-emoji" title="card_index">📇</span><span class="emoji-picker-emoji" title="file_folder">📁</span><span class="emoji-picker-emoji" title="open_file_folder">📂</span><span class="emoji-picker-emoji" title="pushpin">📌</span><span class="emoji-picker-emoji" title="paperclip">📎</span><span class="emoji-picker-emoji" title="straight_ruler">📏</span><span class="emoji-picker-emoji" title="triangular_ruler">📐</span><span class="emoji-picker-emoji" title="closed_book">📕</span><span class="emoji-picker-emoji" title="green_book">📗</span><span class="emoji-picker-emoji" title="blue_book">📘</span><span class="emoji-picker-emoji" title="orange_book">📙</span><span class="emoji-picker-emoji" title="notebook">📓</span><span class="emoji-picker-emoji" title="notebook_with_decorative_cover">📔</span><span class="emoji-picker-emoji" title="ledger">📒</span><span class="emoji-picker-emoji" title="books">📚</span><span class="emoji-picker-emoji" title="book">📖</span><span class="emoji-picker-emoji" title="bookmark">🔖</span><span class="emoji-picker-emoji" title="name_badge">📛</span><span class="emoji-picker-emoji" title="newspaper">📰</span><span class="emoji-picker-emoji" title="art">🎨</span><span class="emoji-picker-emoji" title="clapper">🎬</span><span class="emoji-picker-emoji" title="microphone">🎤</span><span class="emoji-picker-emoji" title="headphones">🎧</span><span class="emoji-picker-emoji" title="musical_score">🎼</span><span class="emoji-picker-emoji" title="musical_note">🎵</span><span class="emoji-picker-emoji" title="notes">🎶</span><span class="emoji-picker-emoji" title="musical_keyboard">🎹</span><span class="emoji-picker-emoji" title="violin">🎻</span><span class="emoji-picker-emoji" title="trumpet">🎺</span><span class="emoji-picker-emoji" title="saxophone">🎷</span><span class="emoji-picker-emoji" title="guitar">🎸</span><span class="emoji-picker-emoji" title="space_invader">👾</span><span class="emoji-picker-emoji" title="video_game">🎮</span><span class="emoji-picker-emoji" title="black_joker">🃏</span><span class="emoji-picker-emoji" title="flower_playing_cards">🎴</span><span class="emoji-picker-emoji" title="mahjong">🀄</span><span class="emoji-picker-emoji" title="game_die">🎲</span><span class="emoji-picker-emoji" title="dart">🎯</span><span class="emoji-picker-emoji" title="football">🏈</span><span class="emoji-picker-emoji" title="basketball">🏀</span><span class="emoji-picker-emoji" title="soccer">⚽</span><span class="emoji-picker-emoji" title="baseball">⚾</span><span class="emoji-picker-emoji" title="tennis">🎾</span><span class="emoji-picker-emoji" title="8ball">🎱</span><span class="emoji-picker-emoji" title="bowling">🎳</span><span class="emoji-picker-emoji" title="golf">⛳</span><span class="emoji-picker-emoji" title="checkered_flag">🏁</span><span class="emoji-picker-emoji" title="trophy">🏆</span><span class="emoji-picker-emoji" title="ski">🎿</span><span class="emoji-picker-emoji" title="snowboarder">🏂</span><span class="emoji-picker-emoji" title="swimmer">🏊</span><span class="emoji-picker-emoji" title="surfer">🏄</span><span class="emoji-picker-emoji" title="fishing_pole_and_fish">🎣</span><span class="emoji-picker-emoji" title="tea">🍵</span><span class="emoji-picker-emoji" title="sake">🍶</span><span class="emoji-picker-emoji" title="beer">🍺</span><span class="emoji-picker-emoji" title="beers">🍻</span><span class="emoji-picker-emoji" title="cocktail">🍸</span><span class="emoji-picker-emoji" title="tropical_drink">🍹</span><span class="emoji-picker-emoji" title="wine_glass">🍷</span><span class="emoji-picker-emoji" title="fork_and_knife">🍴</span><span class="emoji-picker-emoji" title="pizza">🍕</span><span class="emoji-picker-emoji" title="hamburger">🍔</span><span class="emoji-picker-emoji" title="fries">🍟</span><span class="emoji-picker-emoji" title="poultry_leg">🍗</span><span class="emoji-picker-emoji" title="meat_on_bone">🍖</span><span class="emoji-picker-emoji" title="spaghetti">🍝</span><span class="emoji-picker-emoji" title="curry">🍛</span><span class="emoji-picker-emoji" title="fried_shrimp">🍤</span><span class="emoji-picker-emoji" title="bento">🍱</span><span class="emoji-picker-emoji" title="sushi">🍣</span><span class="emoji-picker-emoji" title="fish_cake">🍥</span><span class="emoji-picker-emoji" title="rice_ball">🍙</span><span class="emoji-picker-emoji" title="rice_cracker">🍘</span><span class="emoji-picker-emoji" title="rice">🍚</span><span class="emoji-picker-emoji" title="ramen">🍜</span><span class="emoji-picker-emoji" title="stew">🍲</span><span class="emoji-picker-emoji" title="oden">🍢</span><span class="emoji-picker-emoji" title="dango">🍡</span><span class="emoji-picker-emoji" title="egg">🍳</span><span class="emoji-picker-emoji" title="bread">🍞</span><span class="emoji-picker-emoji" title="doughnut">🍩</span><span class="emoji-picker-emoji" title="custard">🍮</span><span class="emoji-picker-emoji" title="icecream">🍦</span><span class="emoji-picker-emoji" title="ice_cream">🍨</span><span class="emoji-picker-emoji" title="shaved_ice">🍧</span><span class="emoji-picker-emoji" title="birthday">🎂</span><span class="emoji-picker-emoji" title="cake">🍰</span><span class="emoji-picker-emoji" title="cookie">🍪</span><span class="emoji-picker-emoji" title="chocolate_bar">🍫</span><span class="emoji-picker-emoji" title="candy">🍬</span><span class="emoji-picker-emoji" title="lollipop">🍭</span><span class="emoji-picker-emoji" title="honey_pot">🍯</span><span class="emoji-picker-emoji" title="apple">🍎</span><span class="emoji-picker-emoji" title="green_apple">🍏</span><span class="emoji-picker-emoji" title="tangerine">🍊</span><span class="emoji-picker-emoji" title="cherries">🍒</span><span class="emoji-picker-emoji" title="grapes">🍇</span><span class="emoji-picker-emoji" title="watermelon">🍉</span><span class="emoji-picker-emoji" title="strawberry">🍓</span><span class="emoji-picker-emoji" title="peach">🍑</span><span class="emoji-picker-emoji" title="melon">🍈</span><span class="emoji-picker-emoji" title="banana">🍌</span><span class="emoji-picker-emoji" title="pineapple">🍍</span><span class="emoji-picker-emoji" title="sweet_potato">🍠</span><span class="emoji-picker-emoji" title="eggplant">🍆</span><span class="emoji-picker-emoji" title="tomato">🍅</span><span class="emoji-picker-emoji" title="corn">🌽</span>\n                    </div>\n                    <div class="emoji-picker-group">\n                        <div class="emoji-picker-group-title">Places</div><span class="emoji-picker-emoji" title="house">🏠</span><span class="emoji-picker-emoji" title="house_with_garden">🏡</span><span class="emoji-picker-emoji" title="school">🏫</span><span class="emoji-picker-emoji" title="office">🏢</span><span class="emoji-picker-emoji" title="post_office">🏣</span><span class="emoji-picker-emoji" title="hospital">🏥</span><span class="emoji-picker-emoji" title="bank">🏦</span><span class="emoji-picker-emoji" title="convenience_store">🏪</span><span class="emoji-picker-emoji" title="love_hotel">🏩</span><span class="emoji-picker-emoji" title="hotel">🏨</span><span class="emoji-picker-emoji" title="wedding">💒</span><span class="emoji-picker-emoji" title="church">⛪</span><span class="emoji-picker-emoji" title="department_store">🏬</span><span class="emoji-picker-emoji" title="city_sunrise">🌇</span><span class="emoji-picker-emoji" title="city_sunset">🌆</span><span class="emoji-picker-emoji" title="japanese_castle">🏯</span><span class="emoji-picker-emoji" title="european_castle">🏰</span><span class="emoji-picker-emoji" title="tent">⛺</span><span class="emoji-picker-emoji" title="factory">🏭</span><span class="emoji-picker-emoji" title="tokyo_tower">🗼</span><span class="emoji-picker-emoji" title="japan">🗾</span><span class="emoji-picker-emoji" title="mount_fuji">🗻</span><span class="emoji-picker-emoji" title="sunrise_over_mountains">🌄</span><span class="emoji-picker-emoji" title="sunrise">🌅</span><span class="emoji-picker-emoji" title="night_with_stars">🌃</span><span class="emoji-picker-emoji" title="statue_of_liberty">🗽</span><span class="emoji-picker-emoji" title="bridge_at_night">🌉</span><span class="emoji-picker-emoji" title="carousel_horse">🎠</span><span class="emoji-picker-emoji" title="ferris_wheel">🎡</span><span class="emoji-picker-emoji" title="fountain">⛲</span><span class="emoji-picker-emoji" title="roller_coaster">🎢</span><span class="emoji-picker-emoji" title="ship">🚢</span><span class="emoji-picker-emoji" title="boat">⛵</span><span class="emoji-picker-emoji" title="speedboat">🚤</span><span class="emoji-picker-emoji" title="rocket">🚀</span><span class="emoji-picker-emoji" title="seat">💺</span><span class="emoji-picker-emoji" title="station">🚉</span><span class="emoji-picker-emoji" title="bullettrain_side">🚄</span><span class="emoji-picker-emoji" title="bullettrain_front">🚅</span><span class="emoji-picker-emoji" title="metro">🚇</span><span class="emoji-picker-emoji" title="railway_car">🚃</span><span class="emoji-picker-emoji" title="bus">🚌</span><span class="emoji-picker-emoji" title="blue_car">🚙</span><span class="emoji-picker-emoji" title="car">🚗</span><span class="emoji-picker-emoji" title="taxi">🚕</span><span class="emoji-picker-emoji" title="truck">🚚</span><span class="emoji-picker-emoji" title="rotating_light">🚨</span><span class="emoji-picker-emoji" title="police_car">🚓</span><span class="emoji-picker-emoji" title="fire_engine">🚒</span><span class="emoji-picker-emoji" title="ambulance">🚑</span><span class="emoji-picker-emoji" title="bike">🚲</span><span class="emoji-picker-emoji" title="barber">💈</span><span class="emoji-picker-emoji" title="busstop">🚏</span><span class="emoji-picker-emoji" title="ticket">🎫</span><span class="emoji-picker-emoji" title="traffic_light">🚥</span><span class="emoji-picker-emoji" title="construction">🚧</span><span class="emoji-picker-emoji" title="beginner">🔰</span><span class="emoji-picker-emoji" title="fuelpump">⛽</span><span class="emoji-picker-emoji" title="izakaya_lantern">🏮</span><span class="emoji-picker-emoji" title="slot_machine">🎰</span><span class="emoji-picker-emoji" title="moyai">🗿</span><span class="emoji-picker-emoji" title="circus_tent">🎪</span><span class="emoji-picker-emoji" title="performing_arts">🎭</span><span class="emoji-picker-emoji" title="round_pushpin">📍</span><span class="emoji-picker-emoji" title="triangular_flag_on_post">🚩</span>\n                    </div>\n                    <div class="emoji-picker-group">\n                        <div class="emoji-picker-group-title">Symbols</div><span class="emoji-picker-emoji" title="keycap_ten">🔟</span><span class="emoji-picker-emoji" title="1234">🔢</span><span class="emoji-picker-emoji" title="symbols">🔣</span><span class="emoji-picker-emoji" title="capital_abcd">🔠</span><span class="emoji-picker-emoji" title="abcd">🔡</span><span class="emoji-picker-emoji" title="abc">🔤</span><span class="emoji-picker-emoji" title="arrow_up_small">🔼</span><span class="emoji-picker-emoji" title="arrow_down_small">🔽</span><span class="emoji-picker-emoji" title="rewind">⏪</span><span class="emoji-picker-emoji" title="fast_forward">⏩</span><span class="emoji-picker-emoji" title="arrow_double_up">⏫</span><span class="emoji-picker-emoji" title="arrow_double_down">⏬</span><span class="emoji-picker-emoji" title="ok">🆗</span><span class="emoji-picker-emoji" title="new">🆕</span><span class="emoji-picker-emoji" title="up">🆙</span><span class="emoji-picker-emoji" title="cool">🆒</span><span class="emoji-picker-emoji" title="free">🆓</span><span class="emoji-picker-emoji" title="ng">🆖</span><span class="emoji-picker-emoji" title="signal_strength">📶</span><span class="emoji-picker-emoji" title="cinema">🎦</span><span class="emoji-picker-emoji" title="koko">🈁</span><span class="emoji-picker-emoji" title="u6307">🈯</span><span class="emoji-picker-emoji" title="u7a7a">🈳</span><span class="emoji-picker-emoji" title="u6e80">🈵</span><span class="emoji-picker-emoji" title="u5408">🈴</span><span class="emoji-picker-emoji" title="u7981">🈲</span><span class="emoji-picker-emoji" title="ideograph_advantage">🉐</span><span class="emoji-picker-emoji" title="u5272">🈹</span><span class="emoji-picker-emoji" title="u55b6">🈺</span><span class="emoji-picker-emoji" title="u6709">🈶</span><span class="emoji-picker-emoji" title="u7121">🈚</span><span class="emoji-picker-emoji" title="restroom">🚻</span><span class="emoji-picker-emoji" title="mens">🚹</span><span class="emoji-picker-emoji" title="womens">🚺</span><span class="emoji-picker-emoji" title="baby_symbol">🚼</span><span class="emoji-picker-emoji" title="wc">🚾</span><span class="emoji-picker-emoji" title="no_smoking">🚭</span><span class="emoji-picker-emoji" title="u7533">🈸</span><span class="emoji-picker-emoji" title="accept">🉑</span><span class="emoji-picker-emoji" title="cl">🆑</span><span class="emoji-picker-emoji" title="sos">🆘</span><span class="emoji-picker-emoji" title="id">🆔</span><span class="emoji-picker-emoji" title="no_entry_sign">🚫</span><span class="emoji-picker-emoji" title="underage">🔞</span><span class="emoji-picker-emoji" title="no_entry">⛔</span><span class="emoji-picker-emoji" title="negative_squared_cross_mark">❎</span><span class="emoji-picker-emoji" title="white_check_mark">✅</span><span class="emoji-picker-emoji" title="heart_decoration">💟</span><span class="emoji-picker-emoji" title="vs">🆚</span><span class="emoji-picker-emoji" title="vibration_mode">📳</span><span class="emoji-picker-emoji" title="mobile_phone_off">📴</span><span class="emoji-picker-emoji" title="ab">🆎</span><span class="emoji-picker-emoji" title="diamond_shape_with_a_dot_inside">💠</span><span class="emoji-picker-emoji" title="ophiuchus">⛎</span><span class="emoji-picker-emoji" title="six_pointed_star">🔯</span><span class="emoji-picker-emoji" title="atm">🏧</span><span class="emoji-picker-emoji" title="chart">💹</span><span class="emoji-picker-emoji" title="heavy_dollar_sign">💲</span><span class="emoji-picker-emoji" title="currency_exchange">💱</span><span class="emoji-picker-emoji" title="x">❌</span><span class="emoji-picker-emoji" title="exclamation">❗</span><span class="emoji-picker-emoji" title="question">❓</span><span class="emoji-picker-emoji" title="grey_exclamation">❕</span><span class="emoji-picker-emoji" title="grey_question">❔</span><span class="emoji-picker-emoji" title="o">⭕</span><span class="emoji-picker-emoji" title="top">🔝</span><span class="emoji-picker-emoji" title="end">🔚</span><span class="emoji-picker-emoji" title="back">🔙</span><span class="emoji-picker-emoji" title="on">🔛</span><span class="emoji-picker-emoji" title="soon">🔜</span><span class="emoji-picker-emoji" title="arrows_clockwise">🔃</span><span class="emoji-picker-emoji" title="clock12">🕛</span><span class="emoji-picker-emoji" title="clock1">🕐</span><span class="emoji-picker-emoji" title="clock2">🕑</span><span class="emoji-picker-emoji" title="clock3">🕒</span><span class="emoji-picker-emoji" title="clock4">🕓</span><span class="emoji-picker-emoji" title="clock5">🕔</span><span class="emoji-picker-emoji" title="clock6">🕕</span><span class="emoji-picker-emoji" title="clock7">🕖</span><span class="emoji-picker-emoji" title="clock8">🕗</span><span class="emoji-picker-emoji" title="clock9">🕘</span><span class="emoji-picker-emoji" title="clock10">🕙</span><span class="emoji-picker-emoji" title="clock11">🕚</span><span class="emoji-picker-emoji" title="heavy_plus_sign">➕</span><span class="emoji-picker-emoji" title="heavy_minus_sign">➖</span><span class="emoji-picker-emoji" title="heavy_division_sign">➗</span><span class="emoji-picker-emoji" title="white_flower">💮</span><span class="emoji-picker-emoji" title="100">💯</span><span class="emoji-picker-emoji" title="radio_button">🔘</span><span class="emoji-picker-emoji" title="link">🔗</span><span class="emoji-picker-emoji" title="curly_loop">➰</span><span class="emoji-picker-emoji" title="trident">🔱</span><span class="emoji-picker-emoji" title="small_red_triangle">🔺</span><span class="emoji-picker-emoji" title="black_square_button">🔲</span><span class="emoji-picker-emoji" title="white_square_button">🔳</span><span class="emoji-picker-emoji" title="red_circle">🔴</span><span class="emoji-picker-emoji" title="large_blue_circle">🔵</span><span class="emoji-picker-emoji" title="small_red_triangle_down">🔻</span><span class="emoji-picker-emoji" title="white_large_square">⬜</span><span class="emoji-picker-emoji" title="black_large_square">⬛</span><span class="emoji-picker-emoji" title="large_orange_diamond">🔶</span><span class="emoji-picker-emoji" title="large_blue_diamond">🔷</span><span class="emoji-picker-emoji" title="small_orange_diamond">🔸</span><span class="emoji-picker-emoji" title="small_blue_diamond">🔹</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="emoji-composer-popover-caret" :style="this.caretStyles"></div>\n</div>'},function(e,t){e.exports='<div class="aria-reader"></div>'},function(e,t){e.exports='<div class="modal">\n    <div class="modal-content" role="alertdialog" aria-modal="true" aria-describedby="upload-disclaimer">\n        <div class="modal-body file-upload-view" >\n            <div class="file-disclaimer" id="upload-disclaimer">{this.disclaimerText}</div>\n              \x3c!--  Add Rich media --\x3e\n            <div id="file-upload-container"></div>\n            <div class="error-msg"></div>\n        </div>\n        <div class="modal-footer">\n            <button class="modal-button cancel-button" @click="onCancelClick" :style="this.btnStyles">{this.cancelBtnText}</button>\n            <button class="modal-button ok-button" @click="onOkClick" :style="this.btnStyles">{this.uploadBtnText}</button>\n        </div>\n    </div>\n</div>'},function(e,t){e.exports='<div class="video-container" id="video-container">\n\n</div>'},function(e,t){e.exports='<div id="video-stream-view" class="video-stream-view">\n    <div class="call-container">\n        <div class="chat-notification-block hide" title="Click here to see chat" @click="showChatView">\n            <span class="chat-notification-badge">\n                <span class="chat-notification-count"></span>\n            </span>\n        </div>\n        <div class="video-call">\n            <div class="remote-video-container">\n                <div class="video-no-agent-video">\n                    <div class="agent-alias-container center-align-item">\n                        <div class="agent-alias-outer-div center-align-item">\n                            <div class="agent-alias-inner-div center-align-item">\n                                <div class="agent-alias-inner-most-div center-align-item">\n                                    <div class="agent-alias-text center-align-item">{this.agentAliasText}</div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="video-expand-icon-block hide">\n                    <button @click="expandVideoContainer" title="Expand video view" class="video-expand-icon"></button>\n                </div>\n            </div>\n            <div class="local-video-container">\n                <div class="video-no-customer-video">\n                    <div>\n                        <img class="noCustomerVideoImg" src="{this.noCustomerVideoImg}"/>\n                    </div>\n                </div>\n            </div>\n            <div class="call-transfer-text hide">\n                <span class="call_transfer_loader"></span>\n                <span>{this.callTransferText}</span>\n            </div>\n            <div class="video-chat-controls">\n                <button @click="showDeviceSettings" title="Device settings" class="settings-icon"></button>\n                <button @click="toggleVideoOnOff" title="Turn off camera" class="video-on-icon" :if="this.showCustomerCamera"></button>\n                <button @click="toggleVideoOnOff" title="Turn on camera" class="video-off-icon hide" :if="this.showCustomerCamera"></button>\n                <button @click="toggleMicrophoneOnOff" title="Turn off microphone" class="mic-on-icon" ></button>\n                <button @click="toggleMicrophoneOnOff" title="Turn on microphone" class="mic-off-icon hide" ></button>\n                <button @click="endCall" title="End call" class="end-call-icon"></button>\n            </div>\n        </div>\n        <div class="call-connecting">\n            <div class="call_loader_top"></div>\n            <div class="call_connecting_text">\n                <h3>{this.connectingText}</h3>\n            </div>\n            <div class="call_loader_bottom"></div>\n            <div class="call-connecting-footer">\n                <button @click="endCall">{this.endCallButtonText}</button>\n            </div>\n        </div>\n        <div class="call-error">\n            <div>\n                <div class="card">\n                    <p class="text">{this.callErrorText}</p>\n                    <div class="call-error-footer">\n                       <button  @click="endCall">{this.endCallButtonText}</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="unsupported-device-error">\n            <div>\n                <div class="card">\n                    <p  class="text">{this.unsupportedDeviceErrorText}</p>\n                    <div class="call-error-footer">\n                       <button @click="switchToCallView">Close</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="media-settings-container">\n            <div id="videoSourceSettings"  :if="this.showCustomerCamera">\n                <label for="videoDevices">Camera </label>\n                <select id="videoDevices"></select>\n            </div>\n            <div>\n                <label for="inputDevices">Microphone </label>\n                <select id="inputDevices"></select>\n            </div>\n            <div>\n                <label for="outputDevices">Speaker </label>\n                <select id="outputDevices"></select>\n            </div>\n            <div class="speaker-volume-container">\n                <img src="{this.speakerMuteImg}" role="button" @click="muteVolume"/>\n                <input id="vol-control" type="range"\n                       min="0" max="100" step="1"\n                       @input="setVolume"\n                       @change="setVolume"\n                />\n                <img src="{this.speakerVolumeImg}" @click="unmuteVolume"/>\n            </div>\n            <div class="media-settings-footer card-container">\n                <button @click="hideDeviceSettings">Close</button>\n            </div>\n        </div>\n    </div>\n</div>'},function(e,t){e.exports='<div class="pre-call-instructions-view">\n    <h3>{this.headingText}</h3>\n    <div class="disclaimer-container">\n        <div class="disclaimer">\n            <div class="disclaimer-icon">\n            </div>\n            <div class="text" >\n                <p class="pre-call-disclaimer-text">{this.disclaimerText}</p>\n            </div>\n        </div>\n    </div>\n    <div class="pre-call-info">\n        <div class="text" >\n            <p>{this.primaryText} </p>\n            <p>{this.secondaryText}</p>\n            <p>Look for a pop-up like this near the top of your browser after you proceed to the next page:</p>\n        </div>\n    </div>\n\n    <div  class="pre-call-display-image">\n        <div class="card">\n            <p class="text">{this.browserSettingPopupText}</p>\n            <div class="card-container">\n               <button class="card-button">Don\'t Allow</button>\n               <button class="card-button allow-button">Allow</button>\n            </div>\n         </div>\n    </div>\n\n    <div class="pre-call-instructions-footer">\n        <button @click="onClickGetStarted" class="pre-call-instructions-footer-button">\n            <i class="fa fa-settings"></i> {this.startButtonText}\n        </button>\n    </div>\n</div>\n'},function(e,t){e.exports='<div id="device-settings-container">\n    <div class="device-settings-container">\n        <div>\n            <h3>{this.headingText}</h3> \n        </div>\n        <div :if="!this.saveAndContinueNext" class="device-media-container">\n            <p class="device-setting-tips">\n                {this.primaryText}\n            </p>\n            <p class="browser-tips">\n                {this.secondaryText}\n            </p>\n            <div class="preview-container">\n                <div :if="this.showCustomerCamera" class="camera-preview-lable">Preview</div>\n            </div>\n            <div class="device-media-source">\n                <div :if="this.showCustomerCamera">\n                    <label for="videoSource">Camera </label>\n                    <select id="videoSource"></select>\n                </div>\n                \n                <div>\n                    <label for="audioSource">Microphone </label>\n                    <select id="audioSource"></select>\n                    <div  class="microphone-volume-container">\n                        <img src="{this.microphoneVolumeImg}" />\n                        <div class="microphone-volume-level"></div>\n                        <div class="microphone-volume-level"></div>\n                        <div class="microphone-volume-level"></div>\n                        <div class="microphone-volume-level"></div>\n                        <div class="microphone-volume-level"></div>\n                        <div class="microphone-volume-level"></div>\n                        <div class="microphone-volume-level"></div>\n                        <div class="microphone-volume-level"></div>\n                        <div class="microphone-volume-level"></div>\n                        <div class="microphone-volume-level"></div>\n                        <div class="microphone-volume-level"></div>\n                        <div class="microphone-volume-level"></div>\n                        <div class="microphone-volume-level"></div>\n                        <div class="microphone-volume-level"></div>\n                    </div>\n                </div>\n            \n                <div>\n                    <label for="audioOutput">Speaker</label>\n                    <select id="audioOutput"></select>\n                    <div class="speaker-volume-container">\n                        <img src="{this.speakerMuteImg}" role="button" @click="muteVolume"/>\n                        <input id="vol-control" class="volume-range" type="range" \n                            min="0" max="100" step="1" \n                            @input="setVolume" \n                            @change="setVolume"\n                            />\n                        <img src="{this.speakerVolumeImg}" @click="unmuteVolume"/>\n                    </div>\n                    \n                </div>\n            </div>\n        </div>\n        <div :if="this.saveAndContinueNext">\n            <div>\n                <p class="device-setting-tips">\n                   {this.finalText}\n                </p>\n                <p class="browser-tips">\n                    {this.disclaimerText}\n                </p>\n            </div>    \n            <div class="pre-call-instructions-footer">\n                <button  id="getStartedBtn" class="pre-call-instructions-footer-button">\n                    <i :if="this.showCustomerCamera" class="fa fa-camera" ></i>\n                    <i :else class="fa fa-microphone" ></i>\n                    {this.startButtonText}\n                </button>\n            </div>\n        </div>\n    </div>\n    <div class="save-and-continue" @click="onClickSaveAndContinueNext">\n        <span :if="!this.saveAndContinueNext">save and continue</span>\n        <span :if="this.saveAndContinueNext">{this.checkDeviceSettingsBtnText}</span> \n        <i class="caret-next" ></i>\n    </div>\n    \n</div>'},function(e,t,i){var n=i(3);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){var n=i(15);e.exports=function(e){if(Array.isArray(e))return n(e)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){var n=i(15);e.exports=function(e,t){if(e){if("string"==typeof e)return n(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(e,t):void 0}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t){if(null==e)return{};var i,n,s={},a=Object.keys(e);for(n=0;n<a.length;n++)i=a[n],t.indexOf(i)>=0||(s[i]=e[i]);return s},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,i){var n=i(13),s=i(57);function a(t,i,o){return s()?(e.exports=a=Reflect.construct,e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=a=function(e,t,i){var s=[null];s.push.apply(s,t);var a=new(Function.bind.apply(e,s));return i&&n(a,i.prototype),a},e.exports.default=e.exports,e.exports.__esModule=!0),a.apply(null,arguments)}e.exports=a,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,i){var n=function(e){"use strict";var t=Object.prototype,i=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},s=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",o=n.toStringTag||"@@toStringTag";function r(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{r({},"")}catch(e){r=function(e,t,i){return e[t]=i}}function l(e,t,i,n){var s=t&&t.prototype instanceof h?t:h,a=Object.create(s.prototype),o=new C(n||[]);return a._invoke=function(e,t,i){var n="suspendedStart";return function(s,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===s)throw a;return x()}for(i.method=s,i.arg=a;;){var o=i.delegate;if(o){var r=S(o,i);if(r){if(r===u)continue;return r}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===n)throw n="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n="executing";var l=c(e,t,i);if("normal"===l.type){if(n=i.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n="completed",i.method="throw",i.arg=l.arg)}}}(e,i,o),a}function c(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function h(){}function d(){}function p(){}var m={};r(m,s,(function(){return this}));var f=Object.getPrototypeOf,g=f&&f(f(T([])));g&&g!==t&&i.call(g,s)&&(m=g);var v=p.prototype=h.prototype=Object.create(m);function y(e){["next","throw","return"].forEach((function(t){r(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){var n;this._invoke=function(s,a){function o(){return new t((function(n,o){!function n(s,a,o,r){var l=c(e[s],e,a);if("throw"!==l.type){var u=l.arg,h=u.value;return h&&"object"==typeof h&&i.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,o,r)}),(function(e){n("throw",e,o,r)})):t.resolve(h).then((function(e){u.value=e,o(u)}),(function(e){return n("throw",e,o,r)}))}r(l.arg)}(s,a,n,o)}))}return n=n?n.then(o,o):o()}}function S(e,t){var i=e.iterator[t.method];if(void 0===i){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var n=c(i,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,u;var s=n.arg;return s?s.done?(t[e.resultName]=s.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):s:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function T(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:x}}function x(){return{value:void 0,done:!0}}return d.prototype=p,r(v,"constructor",p),r(p,"constructor",d),d.displayName=r(p,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,r(e,o,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(b.prototype),r(b.prototype,a,(function(){return this})),e.AsyncIterator=b,e.async=function(t,i,n,s,a){void 0===a&&(a=Promise);var o=new b(l(t,i,n,s),a);return e.isGeneratorFunction(i)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},y(v),r(v,o,"Generator"),r(v,s,(function(){return this})),r(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var i in e)t.push(i);return t.reverse(),function i(){for(;t.length;){var n=t.pop();if(n in e)return i.value=n,i.done=!1,i}return i.done=!0,i}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(i,n){return o.type="throw",o.arg=e,t.next=i,n&&(t.method="next",t.arg=void 0),!!n}for(var s=this.tryEntries.length-1;s>=0;--s){var a=this.tryEntries[s],o=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var r=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(r&&l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(r){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n];if(s.tryLoc<=this.prev&&i.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var a=s;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,u):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),k(i),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var n=i.completion;if("throw"===n.type){var s=n.arg;k(i)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:T(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},function(e,t,i){"use strict";i.r(t);var n={};i.r(n),i.d(n,"VERSION",(function(){return Ls.e})),i.d(n,"restArguments",(function(){return Ps})),i.d(n,"isObject",(function(){return _s})),i.d(n,"isNull",(function(){return Ds})),i.d(n,"isUndefined",(function(){return Os})),i.d(n,"isBoolean",(function(){return Rs})),i.d(n,"isElement",(function(){return Bs})),i.d(n,"isString",(function(){return Ns})),i.d(n,"isNumber",(function(){return Hs})),i.d(n,"isDate",(function(){return Fs})),i.d(n,"isRegExp",(function(){return $s})),i.d(n,"isError",(function(){return qs})),i.d(n,"isSymbol",(function(){return Us})),i.d(n,"isArrayBuffer",(function(){return Ws})),i.d(n,"isDataView",(function(){return Zs})),i.d(n,"isArray",(function(){return ea})),i.d(n,"isFunction",(function(){return Ys})),i.d(n,"isArguments",(function(){return na})),i.d(n,"isFinite",(function(){return sa})),i.d(n,"isNaN",(function(){return aa})),i.d(n,"isTypedArray",(function(){return da})),i.d(n,"isEmpty",(function(){return ga})),i.d(n,"isMatch",(function(){return va})),i.d(n,"isEqual",(function(){return wa})),i.d(n,"isMap",(function(){return Ma})),i.d(n,"isWeakMap",(function(){return La})),i.d(n,"isSet",(function(){return Pa})),i.d(n,"isWeakSet",(function(){return _a})),i.d(n,"keys",(function(){return fa})),i.d(n,"allKeys",(function(){return ka})),i.d(n,"values",(function(){return Da})),i.d(n,"pairs",(function(){return Oa})),i.d(n,"invert",(function(){return Ra})),i.d(n,"functions",(function(){return Ba})),i.d(n,"methods",(function(){return Ba})),i.d(n,"extend",(function(){return Na})),i.d(n,"extendOwn",(function(){return Ha})),i.d(n,"assign",(function(){return Ha})),i.d(n,"defaults",(function(){return Fa})),i.d(n,"create",(function(){return qa})),i.d(n,"clone",(function(){return Ua})),i.d(n,"tap",(function(){return Wa})),i.d(n,"get",(function(){return Xa})),i.d(n,"has",(function(){return Ka})),i.d(n,"mapObject",(function(){return so})),i.d(n,"identity",(function(){return Ja})),i.d(n,"constant",(function(){return oa})),i.d(n,"noop",(function(){return ao})),i.d(n,"toPath",(function(){return Ga})),i.d(n,"property",(function(){return Za})),i.d(n,"propertyOf",(function(){return oo})),i.d(n,"matcher",(function(){return Qa})),i.d(n,"matches",(function(){return Qa})),i.d(n,"times",(function(){return ro})),i.d(n,"random",(function(){return lo})),i.d(n,"now",(function(){return co})),i.d(n,"escape",(function(){return po})),i.d(n,"unescape",(function(){return mo})),i.d(n,"templateSettings",(function(){return fo})),i.d(n,"template",(function(){return So})),i.d(n,"result",(function(){return wo})),i.d(n,"uniqueId",(function(){return Co})),i.d(n,"chain",(function(){return To})),i.d(n,"iteratee",(function(){return io})),i.d(n,"partial",(function(){return Io})),i.d(n,"bind",(function(){return jo})),i.d(n,"bindAll",(function(){return Lo})),i.d(n,"memoize",(function(){return Po})),i.d(n,"delay",(function(){return _o})),i.d(n,"defer",(function(){return Do})),i.d(n,"throttle",(function(){return Oo})),i.d(n,"debounce",(function(){return Ro})),i.d(n,"wrap",(function(){return Bo})),i.d(n,"negate",(function(){return Vo})),i.d(n,"compose",(function(){return No})),i.d(n,"after",(function(){return Ho})),i.d(n,"before",(function(){return Fo})),i.d(n,"once",(function(){return $o})),i.d(n,"findKey",(function(){return qo})),i.d(n,"findIndex",(function(){return Wo})),i.d(n,"findLastIndex",(function(){return Go})),i.d(n,"sortedIndex",(function(){return zo})),i.d(n,"indexOf",(function(){return Xo})),i.d(n,"lastIndexOf",(function(){return Ko})),i.d(n,"find",(function(){return Jo})),i.d(n,"detect",(function(){return Jo})),i.d(n,"findWhere",(function(){return Qo})),i.d(n,"each",(function(){return Zo})),i.d(n,"forEach",(function(){return Zo})),i.d(n,"map",(function(){return er})),i.d(n,"collect",(function(){return er})),i.d(n,"reduce",(function(){return ir})),i.d(n,"foldl",(function(){return ir})),i.d(n,"inject",(function(){return ir})),i.d(n,"reduceRight",(function(){return nr})),i.d(n,"foldr",(function(){return nr})),i.d(n,"filter",(function(){return sr})),i.d(n,"select",(function(){return sr})),i.d(n,"reject",(function(){return ar})),i.d(n,"every",(function(){return or})),i.d(n,"all",(function(){return or})),i.d(n,"some",(function(){return rr})),i.d(n,"any",(function(){return rr})),i.d(n,"contains",(function(){return lr})),i.d(n,"includes",(function(){return lr})),i.d(n,"include",(function(){return lr})),i.d(n,"invoke",(function(){return cr})),i.d(n,"pluck",(function(){return ur})),i.d(n,"where",(function(){return hr})),i.d(n,"max",(function(){return dr})),i.d(n,"min",(function(){return pr})),i.d(n,"shuffle",(function(){return fr})),i.d(n,"sample",(function(){return mr})),i.d(n,"sortBy",(function(){return gr})),i.d(n,"groupBy",(function(){return yr})),i.d(n,"indexBy",(function(){return br})),i.d(n,"countBy",(function(){return Sr})),i.d(n,"partition",(function(){return wr})),i.d(n,"toArray",(function(){return Cr})),i.d(n,"size",(function(){return Tr})),i.d(n,"pick",(function(){return Er})),i.d(n,"omit",(function(){return Ir})),i.d(n,"first",(function(){return Ar})),i.d(n,"head",(function(){return Ar})),i.d(n,"take",(function(){return Ar})),i.d(n,"initial",(function(){return jr})),i.d(n,"last",(function(){return Lr})),i.d(n,"rest",(function(){return Mr})),i.d(n,"tail",(function(){return Mr})),i.d(n,"drop",(function(){return Mr})),i.d(n,"compact",(function(){return Pr})),i.d(n,"flatten",(function(){return _r})),i.d(n,"without",(function(){return Or})),i.d(n,"uniq",(function(){return Rr})),i.d(n,"unique",(function(){return Rr})),i.d(n,"union",(function(){return Br})),i.d(n,"intersection",(function(){return Vr})),i.d(n,"difference",(function(){return Dr})),i.d(n,"unzip",(function(){return Nr})),i.d(n,"transpose",(function(){return Nr})),i.d(n,"zip",(function(){return Hr})),i.d(n,"object",(function(){return Fr})),i.d(n,"range",(function(){return $r})),i.d(n,"chunk",(function(){return qr})),i.d(n,"mixin",(function(){return Wr})),i.d(n,"default",(function(){return Gr}));var s=i(1),a=i.n(s),o=i(2),r=i.n(o),l=function(){function e(t,i,n,s){a()(this,e),this.x=t,this.y=i,this.width=n,this.height=s}return r()(e,[{key:"setBRPosition",value:function(e,t,i,n){this.r=e,this.b=t,this.width=i,this.height=n}},{key:"isXYAxisPos",value:function(){return this.x>=0&&this.y>=0}},{key:"toJSON",value:function(){return{x:this.x,y:this.y,r:this.r,b:this.b,width:this.width,height:this.height}}}]),e}(),c=function(){function e(){a()(this,e)}return r()(e,null,[{key:"setDeviceType",value:function(t){e.deviceType=t}},{key:"getScrollLeft",value:function(){try{var e=window.parent,t=e.document;return null!=e.pageXOffset?e.pageXOffset:null!=t.documentElement&&null!=t.documentElement.scrollLeft&&0!=t.documentElement.scrollLeft?t.documentElement.scrollLeft:t.body.scrollLeft}catch(e){}return 0}},{key:"getScrollTop",value:function(){try{var e=window.parent,t=e.document;return null!=e.pageYOffset?e.pageYOffset:null!=t.documentElement&&null!=t.documentElement.scrollTop&&0!=t.documentElement.scrollTop?t.documentElement.scrollTop:t.body.scrollTop}catch(e){}return 0}},{key:"getScrollWidth",value:function(){var t=window.parent,i=t.document,n=0;if(null==t.innerWidth)n=null!=i.documentElement&&0!=i.documentElement.clientWidth?i.documentElement.clientWidth:i.body.clientWidth;else{var s=t.innerWidth;s-=e.hasRightScrollBar()?e.getScrollBarWidth():0;var a=i.body.clientWidth;0==(n="Tablet"==e.deviceType||0==a?s:Math.min(a,s))&&(n=i.body.clientWidth)}return n}},{key:"getScrollHeight",value:function(){var t=0,i=window.parent.document;if(null==window.parent.innerHeight)t=null!=i.documentElement&&0!=i.documentElement.clientHeight?i.documentElement.clientHeight:i.body.clientHeight;else{var n=window.parent.innerHeight;n-=e.hasBottomScrollBar()?e.getScrollBarWidth():0;var s=i.body.clientHeight,a=i.body.scrollHeight;t=0,0==(t=0==s||a>=s?n:Math.min(s,n))&&(t=i.body.clientHeight)}return t}},{key:"hasRightScrollBar",value:function(){var e=window.parent.document.documentElement.clientHeight,t=window.parent.document.documentElement.clientWidth,i=window.parent.document.documentElement.scrollHeight,n=window.parent.innerWidth;return e<i||t<n}},{key:"hasBottomScrollBar",value:function(){var e=window.parent.document.documentElement.clientWidth,t=window.parent.document.documentElement.scrollWidth,i=window.parent.document.documentElement.clientHeight,n=window.parent.innerHeight;return e<t||i<n}},{key:"getScrollBarWidth",value:function(){var e,t,i,n;return(e=window.parent.document.createElement("div")).style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.width="100px",e.style.height="50px",e.style.overflow="hidden",(t=window.parent.document.createElement("div")).style.width="100%",t.style.height="200px",e.appendChild(t),window.parent.document.body.appendChild(e),i=t.offsetWidth,e.style.overflow="auto",n=t.offsetWidth,window.parent.document.body.removeChild(window.parent.document.body.lastChild),i-n}},{key:"getViewport",value:function(){var t=e.getScrollLeft(),i=e.getScrollTop(),n=parseInt(window.parent.innerWidth,10),s=parseInt(window.parent.innerHeight,10);return new l(t,i,n,s)}}]),e}(),u="openerTS",h="oDI",d="last",p="conference",m="transfer",f="reconnected",g=13,v="emailReq",y="soundState",b="co",S="ci_cdn",w="data-survey-url",k="#EmptyAnswer",C="vaTypingTimer",T="fullScreenOnly",x="withinBottom",E="withinTop",I="Remove",j="richMedia",A="scrollBtnTimer",M="Ok",L="Cancel",P="cls",_="voc",D=1,O=2,R="joined",B="error",V="agentVideoError",N="agentVideoPublished",H="localAudioError",F="localVideoError",$="localVideoPublished",q="customerCameraEnabled",U="voiceOnlyCall",W="networkMsgTimer",G="virtualkeyboard.displayed",z="window.resized",Y=1,X=1.2,K="mc",J="msgcnt",Q="eng",Z="MMM DD YYYY",ee="HH:mm",te="data-nuance-message-text",ie="data-nuance-message-data",ne="data-nuance-datapass",se="chatLine",ae="chat.communication",oe="chat.communication.opener",re="chat.communication_outcome",le="chat.activity",ce="chat.need_wait",ue="chat.accepted",he="chat.authorized",de="chat.exit",pe="chat.denied",me="chat.transfer_response",fe="chat.communication.queue",ge="chatroom.member_lost",ve="chatroom.member_connected",ye="nina.coach.chat.take.over",be="chat.automaton_request",Se="chat.communication.survey",we="authenticated.user.response",ke="chat.cobrowse",Ce="client.command",Te="messageType",xe="chatFinalText",Ee="messageTimestamp",Ie="timestamp",je="type",Ae="isAgentMsg",Me="senderName",Le="client.display.text",Pe="display.text",_e="ChatReInited",De="thank_you_image_label",Oe="tc.mode",Re="automaton.data",Be="agent.alias",Ve="chatroom.member.name",Ne="customerAlias",He="messageText",Fe="agentID",$e="messageData",qe="forced_close",Ue="config.agent_alias",We="chat.replay",Ge="windowId",ze="chat.cmd",Ye="engagementID",Xe="conversationID",Ke="conversationId",Je="queued",Qe="denied",Ze="exit",et="transferInit",tt="transferJoined",it="lost",nt="conf",st="networkFailed",at="networkDisconnected",ot="networkReconnected",rt="uploadSuccess",lt="loading",ct="typing",ut="notTyping",ht="STARTING",dt="PRECHAT",pt="ENGAGED",mt="ENDED",ft="PRECALL",gt="INCALL",vt=1,yt=2,bt="receipt",St="quickreply",wt="card",kt="form",Ct="inline",Tt=1,xt=2,Et=3,It=4,jt=5,At="textEntered",Mt="inputEnabled",Lt="grow.fileupload",Pt="hide.fileupload",_t="callInvitation",Dt="newCallRequest",Ot="newVoiceCallRequest",Rt="createRoomSuccess",Bt="callEnded",Vt="roomAgentJoin",Nt="roomAgentLeave",Ht=0,Ft=1,$t=2,qt=3,Ut=4,Wt=5,Gt=6,zt="on",Yt="portrait",Xt="landscape",Kt="onInput",Jt="onInteractiveElement",Qt="onNewAgentMessage",Zt="onInput",ei="onOpener",ti="all",ii="mobile",ni="phone";function si(e,t,i){var n;return function(){var s=this,a=arguments,o=function(){n=null,i||e.apply(s,a)},r=i&&!n;clearTimeout(n),n=setTimeout(o,t),r&&e.apply(s,a)}}function ai(e){console.log("Messaging-UI:".concat(e))}function oi(e,t,i,n){n||(n=!1),e.addEventListener?e.addEventListener(t,i,n):e.attachEvent&&e.attachEvent("on".concat(t),i)}function ri(e,t,i,n){n||(n=!1),e.removeEventListener?e.removeEventListener(t,i,n):e.attachEvent&&e.detachEvent("on".concat(t),i)}function li(){return/(iPad|iPhone|iPod)/g.test(window.navigator.userAgent)}var ci=function e(t,i){a()(this,e),this.p1=t,this.p2=i};function ui(e,t){e?(t.setAttribute("aria-hidden",!0),t.setAttribute("hidden",!0)):(t.removeAttribute("aria-hidden"),t.removeAttribute("hidden"))}function hi(e,t){try{var i=parseInt(t==Yt?window.parent.screen.width:window.parent.screen.height);return Math.round(i/e.width*100)/100}catch(e){return 1}}var di=i(9),pi=i.n(di),mi=i(10),fi=i.n(mi),gi=i(3),vi=i.n(gi),yi=i(6),bi=i.n(yi),Si=function(){function e(){a()(this,e),this.className="DragResize",this.styleSaved="",this.cursor="default",this.pDraggerNow=null,this.touchIdentifier=e.TOUCH_IDENTIFER_UNUSED,this.uponMouseDropClosure=null,this.uponMouseDragClosure=null,this.uponMouseOutClosure=null,this.uponMouseDragStartClosure=null,this.uponTouchDragClosure=null,this.uponTouchEndClosure=null,this.uponTouchCancelClosure=null,this.uponTouchStartClosure=null,this.deltaY=null,this.deltaX=null,this.pMax=null,this.pMin=null,this.rootWidth=null,this.rootHeight=null,this.draggerHeight=null,this.draggerWidth=null,this.pDraggerNow=null,this.pDraggerStart=null,this.pStart=null,this.pLast=null,this.touchOffsetY=null,this.touchOffsetX=null,this.clickOffsetY=null,this.clickOffsetX=null,this.touch=null,this.styleSaved=null,this.cursor=null,this.root=null,this.dragImage=null,this.obj=null}return r()(e,[{key:"_removeEventListener",value:function(e,t,i){ri(e,t,i)}},{key:"_attachEventListener",value:function(e,t,i){oi(e,t,i)}},{key:"bindClosures",value:function(){this.uponTouchStartClosure=this.uponTouchStart.bind(this),this.uponTouchCancelClosure=this.uponTouchCancel.bind(this),this.uponTouchEndClosure=this.uponTouchEnd.bind(this),this.uponTouchDragClosure=this.uponTouchDrag.bind(this),this.uponMouseDragStartClosure=this.uponDragStart.bind(this),this.uponMouseOutClosure=this.uponMouseOut.bind(this),this.uponMouseDragClosure=this.uponDrag.bind(this),this.uponMouseDropClosure=this.uponDrop.bind(this)}},{key:"init",value:function(t,i){null!=t&&(this.dragImage=this.fixDragImage(t),this.obj=t,null!=t[e.INSTANCE_LABEL]?ai("o already has property for "+e.INSTANCE_LABEL+": "+t[e.INSTANCE_LABEL]):(t[e.INSTANCE_LABEL]=this,i[e.INSTANCE_LABEL]=this,this.root=i&&null!=i?i:t,this.bindClosures(),this.isSupported("touchstart")?(this.obj[e.INSTANCE_LABEL]=this,this._removeEventListener(this.dragImage,"touchstart",this.uponTouchStartClosure),this._attachEventListener(this.dragImage,"touchstart",this.uponTouchStartClosure)):this.isSupported("mousedown")&&(this._removeEventListener(this.dragImage,"mousedown",this.uponMouseDragStartClosure),this._attachEventListener(this.dragImage,"mousedown",this.uponMouseDragStartClosure))))}},{key:"fixDragImage",value:function(e){return"DIV"==e.nodeName.toUpperCase()&&(this.dInputel=e),e}},{key:"isLeftClick",value:function(e){var t=e||window.event,i=1;return i="Netscape"==window.navigator.appName?e.which:window.parent.event.button,0==t.type.indexOf("touch")||1==i}},{key:"fireDone",value:function(){this.whenDone()}},{key:"fireDoneState",value:function(){e.instance=this,window.setTimeout(e.WhenDone,1)}},{key:"removeTouchEvents",value:function(){this._removeEventListener(e.doc,"touchcancel",this.uponTouchCancelClosure),this._removeEventListener(e.doc,"touchend",this.uponTouchEndClosure),this._removeEventListener(e.doc,"touchmove",this.uponTouchDragClosure)}},{key:"removeMouseEvents",value:function(){this._attachEventListener(this.dragImage,"touchstart",this.uponTouchStartClosure),this._removeEventListener(e.doc,"mouseout",this.uponMouseOutClosure),this._removeEventListener(e.doc,"mousemove",this.uponMouseDragClosure),this._removeEventListener(e.doc,"mouseup",this.uponMouseDropClosure),this._removeEventListener(window.parent.document,"mousemove",this.uponMouseDragClosure)}},{key:"addTouchEvents",value:function(){this._removeEventListener(this.dragImage,"mousedown",this.uponMouseDragStartClosure),this._attachEventListener(e.doc,"touchcancel",this.uponTouchCancelClosure),this._attachEventListener(e.doc,"touchend",this.uponTouchEndClosure)}},{key:"addMouseEvents",value:function(){this._removeEventListener(this.obj,"touchstart",this.uponTouchStartClosure),this._attachEventListener(e.doc,"mouseout",this.uponMouseOutClosure),this._attachEventListener(e.doc,"mouseup",this.uponMouseDropClosure)}},{key:"removeEvents",value:function(){this.removeMouseEvents(),this.fireDoneState()}},{key:"uponTouchCancel",value:function(e){var t=e||window.event;return null!=t.preventDefault&&t.preventDefault(),!1}},{key:"uponTouchEnd",value:function(e){try{var t=e||window.event;if(clearTimeout(this.holdTimer),this.removeTouchEvents(),this.touch=this.getTouchByIdentifer(t),null==this.touch)return;var i={X:this.touch.pageX+parseInt(this.root.offsetLeft,10)-this.touchOffsetX,Y:this.touch.pageY+parseInt(this.root.offsetTop,10)-this.touchOffsetY};this.mouseIsDown&&(null!=t.preventDefault&&t.preventDefault(),this.repositionTouch(i),this.done()),this.mouseIsDown=!1,this.dInputel.style.cursor="default"}catch(e){ai("ERROR: uponTouchEnd: "+e)}}},{key:"getTouchByIdentifer",value:function(t){try{var i=t.changedTouches;if(null==i)return null;if(this.touchIdentifier==e.TOUCH_IDENTIFER_UNUSED)return null;if(null==i.identifiedTouch){for(var n=0,s=i.length;n<s;){var a=n++;if(i[a].identifier==this.touchIdentifier)return i[a]}return null}return i.identifiedTouch(this.touchIdentifier)}catch(e){ai("ERROR: getTouchByIdentifer: "+e)}return null}},{key:"done",value:function(){this.touchIdentifier=e.TOUCH_IDENTIFER_UNUSED,window.setTimeout(this.whenDone.bind(this),1)}},{key:"uponDrop",value:function(t){var i=t||window.event;null!=i.preventDefault&&i.preventDefault();var n=this.getPosition(i);return this.removeEvents(),this.mouseIsDown?(this.done(),this.reposition(n)):e.instance=null,this.mouseIsDown=!1,this.dInputel.style.cursor="default",clearTimeout(this.holdTimer),!1}},{key:"uponMouseOut",value:function(t){var i=t||window.event;null!=i.preventDefault&&i.preventDefault();var n=this.getDefaultMin(),s=this.getDefaultMax(),a=this.getPosition(i),o=!1;return a.Y<n.Y&&(a.Y=n.Y,o=!0),a.X<n.X&&(a.X=n.X,o=!0),a.Y>=s.Y+this.root.offsetHeight&&(a.Y=s.Y+this.root.offsetHeight,o=!0),a.X>=s.X+this.root.offsetWidth&&(a.X=s.X+this.root.offsetWidth,o=!0),o||!this.mouseIsDown?(this.removeEvents(),this.mouseIsDown?(this.reposition(a),this.fireDoneState()):e.instance=null,this.mouseIsDown=!1,this.dInputel.style.cursor="default",clearTimeout(this.holdTimer),!1):this.uponDrag(i)}},{key:"getScreenMax",value:function(){return{X:c.getScrollWidth()-5,Y:c.getScrollHeight()-5}}},{key:"repositionTouch",value:function(e){try{if(null!=this.pLast&&e.X==this.pLast.X&&e.Y==this.pLast.Y)return!1;var t,i;i=e.X,e.X!=this.pLast.X&&i>=this.pMin.X&&i<this.pMax.X?this.setLeft(i):i>=this.pMax.X?this.setLeft(i=this.pMax.X):i<this.pMin.X&&this.setLeft(i=this.pMin.X),t=e.Y,e.Y!=this.pLast.Y&&t>=this.pMin.Y&&t<this.pMax.Y?this.setTop(t):t>=this.pMax.Y?this.setTop(t=this.pMax.Y):t<this.pMin.Y&&this.setTop(t=this.pMin.Y),this.pDraggerNow={X:i,Y:t},this.pLast=e}catch(e){ai("ERROR: repositionTouch: "+e)}return!1}},{key:"reposition",value:function(e){var t=e.Y-this.deltaY,i=e.X-this.deltaX;return i>=this.pMin.X&&i<this.pMax.X?this.pDraggerNow.X=i:i>=this.pMax.X?this.pDraggerNow.X=this.pMax.X:i<this.pMin.X&&(this.pDraggerNow.X=this.pMin.X),t>=this.pMin.Y&&t<this.pMax.Y?this.pDraggerNow.Y=t:t>=this.pMax.Y?this.pDraggerNow.Y=this.pMax.Y:t<this.pMin.Y&&(this.pDraggerNow.Y=this.pMin.Y),this.setTop(this.pDraggerNow.Y),this.setLeft(this.pDraggerNow.X),this.pLast=e,!1}},{key:"uponTouchDrag",value:function(e){var t=e||window.event;null!=t.preventDefault&&t.preventDefault();try{if(this.obj.dragging)return!1;if(this.obj.dragging=!0,this.touch=this.getTouchByIdentifer(t),null==this.touch)return!1;var i={X:this.touch.pageX+parseInt(this.root.offsetLeft,10)-this.touchOffsetX,Y:this.touch.pageY+parseInt(this.root.offsetTop,10)-this.touchOffsetY};this.timeout&&(window.cancelAnimationFrame(this.timeout),this.timeout=null),this.timeout=window.requestAnimationFrame(function(){this.timeout=null,this.repositionTouch(i)}.bind(this)),this.obj.dragging=!1}catch(e){ai("uponTouchDrag ERROR: "+e)}return!1}},{key:"uponDrag",value:function(e){var t=e||window.event;if(this.obj.dragging)return!1;this.obj.dragging=!0,null!=t.preventDefault&&t.preventDefault();var i=t.currentTarget==window.parent.document?{X:e.clientX,Y:e.clientY}:this.getPosition(t);return this.timeout&&(window.cancelAnimationFrame(this.timeout),this.timeout=null),this.timeout=window.requestAnimationFrame(function(){this.timeout=null,this.reposition(i)}.bind(this)),this.obj.dragging=!1,!1}},{key:"uponTouchStart",value:function(t){var i=t||window.event;this.obj.style;this.touchIdentifier==e.TOUCH_IDENTIFER_UNUSED&&(this.addTouchEvents(),this.holdTimer=setTimeout(function(){this.dInputel.style.cursor="move",this.touch=i.changedTouches[0],this.pLast={X:this.touch.pageX+parseInt(this.root.offsetLeft,10),Y:this.touch.pageY+parseInt(this.root.offsetTop,10)},this.touchOffsetX=this.pLast.X-parseInt(this.root.offsetLeft,10),this.touchOffsetY=this.pLast.Y-parseInt(this.root.offsetTop,10),this.touchIdentifier=this.touch.identifier,this.pMin=this.getDefaultMin(),this.pMax=this.getDefaultMax(),this.mouseIsDown=!0,this._attachEventListener(e.doc,"touchmove",this.uponTouchDragClosure)}.bind(this),50))}},{key:"uponDragStart",value:function(t){var i=t||window.event;null!=i.preventDefault&&i.preventDefault();this.obj;var n=this;return!!this.isLeftClick(i)&&(e.instance=this,n.addMouseEvents(),this.holdTimer=setTimeout((function(){n.dInputel.style.cursor="move",n.pDraggerNow={X:parseInt(n.root.offsetLeft,10),Y:parseInt(n.root.offsetTop,10)},n.pLast=n.getPosition(i),n.deltaX=n.pLast.X-n.pDraggerNow.X,n.deltaY=n.pLast.Y-n.pDraggerNow.Y,n.pMin=n.getDefaultMin(),n.pMax=n.getDefaultMax(),n.mouseIsDown=!0,n._attachEventListener(e.doc,"mousemove",n.uponMouseDragClosure),n._attachEventListener(window.parent.document,"mousemove",n.uponMouseDragClosure)}),50),!1)}},{key:"setDragBorder",value:function(){}},{key:"getDefaultMax",value:function(){return{X:1e4,Y:1e4}}},{key:"getDefaultMin",value:function(){return{X:0,Y:0}}},{key:"setLeft",value:function(e){ai("setLeft override failed")}},{key:"setTop",value:function(e){ai("setTop override failed")}},{key:"whenDone",value:function(){}},{key:"isSupported",value:function(e){return"on"+e in document.documentElement}},{key:"getPositionIE",value:function(e){return{X:window.parent.event.clientX,Y:window.parent.event.clientY}}},{key:"getPositionGecko",value:function(e){return{X:e.clientX,Y:e.clientY}}},{key:"getPosition",value:function(e){return{X:e.clientX+parseInt(this.root.offsetLeft,10),Y:e.clientY+parseInt(this.root.offsetTop,10)}}},{key:"clear",value:function(){this.root[e.INSTANCE_LABEL]=null,this.obj[e.INSTANCE_LABEL]=null,this._removeEventListener(this.obj,"touchstart",this.uponTouchStartClosure),this._removeEventListener(this.dragImage,"mousedown",this.uponMouseDragStartClosure)}}],[{key:"WhenDone",value:function(){null!=e.instance&&e.instance.whenDone(),e.instance=null}}]),e}();function wi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=vi()(e);if(t){var s=vi()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return fi()(this,i)}}Si.o=null,Si.typeof=function(e){return bi()(e)},Si.TOUCH_IDENTIFER_UNUSED=-1,Si.INSTANCE_LABEL="instDragResize",Si.doc=window.document,Si.instance=null,Si.DEFAULT_BORDER_COLOR="SlateGray";var ki=function(e){pi()(i,e);var t=wi(i);function i(){var e;return a()(this,i),(e=t.call(this)).className="Move",e.cursor="move",e}return r()(i,[{key:"setTop",value:function(e){this.root.style.top="".concat(e,"px")}},{key:"setLeft",value:function(e){this.root.style.left="".concat(e,"px")}},{key:"whenDone",value:function(){this.root.style.left="".concat(String(this.pDraggerNow.X),"px"),this.root.style.top="".concat(String(this.pDraggerNow.Y),"px");var e={X:this.pDraggerNow.X,Y:this.pDraggerNow.Y};messagingApp.messageWindow.moveStage(e.X,e.Y)}},{key:"getDefaultMax",value:function(){var e=parseInt(window.getComputedStyle(this.root).width,10),t=parseInt(window.getComputedStyle(this.root).height,10);return{X:c.getScrollWidth()-e,Y:c.getScrollHeight()-t-("horizontal"==this.dm?parseInt(this.root.style.bottom,10):0)}}},{key:"getDefaultMin",value:function(){var e=parseInt(window.getComputedStyle(this.root).height,10);return{X:0,Y:"horizontal"==this.dm?c.getScrollHeight()-parseInt(this.root.style.bottom,10)-e:0}}}],[{key:"setDragable",value:function(e,t){var n=new i;n.dm=e;var s=window.parent.document.getElementById(messagingApp.config.chatDivID),a=t;n.init(a,s)}},{key:"setClicked",value:function(e){e[Si.INSTANCE_LABEL].uponClick()}}]),i}(Si),Ci=function(){function e(){a()(this,e),this._callbackList={}}return r()(e,[{key:"publish",value:function(e,t){for(var i=Object.keys(this._callbackList),n=0;n<i.length;n++){var s=this._callbackList[i[n]];e===s.stateName&&s.callback(t)}}},{key:"subscribe",value:function(e,t){if("function"!=typeof e)throw new Error("callback should be a function");if("string"!=typeof t)throw new Error("stateName should be a string");var i=Math.round(Math.random()*Number.MAX_SAFE_INTEGER);return this._callbackList[i]?this.subscribe(e,t):(this._callbackList[i]={callback:e,stateName:t},i)}},{key:"unsubscribe",value:function(e){return!!this._callbackList[e]&&(delete this._callbackList[e],!0)}}]),e}(),Ti=new Ci,xi=function(){function e(t){a()(this,e),this.frame=t.getStage(),this.area=null,this.resizeHandler=si(this.onBrowserResize.bind(this),100),this.minimizedCount=0,this.chatActive=!1,li()&&(this.scrollHandler=si(this.scrollDebouncedEvent.bind(this),100),this.keyboardScrollHandler=si(this.keyboardScrollDebouncedEvent.bind(this),100),this.moveScrollHandler=si(this.touchMoveScrollHandler.bind(this),100),this.iphoneModel=function(){var e=document.createElement("canvas"),t="",i="";if(e){var n=e.getContext("webgl")||e.getContext("experimental-webgl");if(n){var s=n.getExtension("WEBGL_debug_renderer_info");s&&(t=n.getParameter(s.UNMASKED_RENDERER_WEBGL))}}if(window.parent.screen.height/window.parent.screen.width==896/414&&3==window.devicePixelRatio)switch(t){case"Apple A12 GPU":i="iPhoneXSMax";break;default:i="iPhoneXSMax"}else if(window.parent.screen.height/window.parent.screen.width==896/414&&2==window.devicePixelRatio)switch(t){case"Apple A12 GPU":i="iPhoneXR";break;default:i="iPhoneXR"}else if(window.parent.screen.height/window.parent.screen.width==812/375&&3==window.devicePixelRatio)switch(t){case"Apple A12 GPU":i="iPhoneXS_XSMaxZoomed";break;case"Apple A11 GPU":i="iPhoneX";break;default:i="iPhoneX"}else if(window.parent.screen.height/window.parent.screen.width==812/375&&2==window.devicePixelRatio)switch(t){case"Apple A12 GPU":i="iPhoneXRZoomed";break;default:i="iPhoneXRZoomed"}else if(window.parent.screen.height/window.parent.screen.width==736/414&&3==window.devicePixelRatio)switch(t){case"Apple A8 GPU":i="iPhone6Plus";break;case"Apple A9 GPU":i="iPhone6sPlus";break;case"Apple A10 GPU":i="iPhone7Plus";break;case"Apple A11 GPU":i="iPhone8Plus";break;default:i="iPhone6Plus"}else if(window.parent.screen.height/window.parent.screen.width==667/375&&3==window.devicePixelRatio)switch(t){case"Apple A8 GPU":i="iPhone6PlusZoomed";break;case"Apple A9 GPU":i="iPhone6sPlusZoomed";break;case"Apple A10 GPU":i="iPhone7PlusZoomed";break;case"Apple A11 GPU":i="iPhone8PlusZoomed";break;default:i="iPhone6PlusZoomed"}else if(window.parent.screen.height/window.parent.screen.width==667/375&&2==window.devicePixelRatio)switch(t){case"Apple A8 GPU":i="iPhone6";break;case"Apple A9 GPU":i="iPhone6s";break;case"Apple A10 GPU":i="iPhone7";break;case"Apple A11 GPU":i="iPhone8";break;default:i="iPhone6"}else if(window.parent.screen.height/window.parent.screen.width==1.775&&2==window.devicePixelRatio)switch(t){case"PowerVR SGX 543":i="iPhone5";break;case"Apple A7 GPU":i="iPhone5s";break;case"Apple A8 GPU":i="iPhone6Zoomed";break;case"Apple A9 GPU":i="iPhone6sZoomed";break;case"Apple A10 GPU":i="iPhone7Zoomed";break;case"Apple A11 GPU":i="iPhone8Zoomed";break;default:i="iPhone6Zoomed"}else i="Not an iPhone";return i}());var i=t.getUIConfig().skinConfig;e.bottomDelta=0,e.minFrameHeight=0,i&&(e.bottomDelta=i.bottomOffset||0,e.screenOffset=i.fullScreenOffset||0),this.doc=this.frame.ownerDocument,this.ciApp=t.getCIAppInstance(),this.mApp=t}return r()(e,[{key:"render",value:function(t){var i=c.getViewport();if(this.theme=t,c.setDeviceType(this.theme.deviceType),!this.minimized&&t&&t.minimized&&t.minimized.state)return this.minimized=!0,this.minimizedCount=t.minimized.count,void(messagingApp.getPluginInstance()&&messagingApp.getPluginInstance().setMinimized(this.minimizedCount));if(t.embedded)this.frame.classList.add("embedded");else if(this.mApp.getSDKInstance().isPersistentWindow())this.frame.classList.add("persistent-chat");else if(this.isPhone())this.chatActive=!0,this.currentOrientation=this.getOrientation(i),li()?(this.addViewPort(),ri(window.top,"scroll",this.scrollHandler),oi(window.top,"scroll",this.scrollHandler),this.doc.body.classList.add("chatopen"),window.top.scrollTo(0,1)):this.doc.documentElement.style.overflow="hidden",setTimeout(function(){this.resizeForPhone(i)}.bind(this),100);else{var n=messagingApp.config;this.area=new l,this.area.width=n.frameW?n.frameW:this.theme.skinWidth,this.area.height=(n.frameH?n.frameH:this.theme.skinHeight+this.theme.titleBarHeight)+e.bottomDelta,setTimeout(function(){this.setWH(),this.resizeWindow(),this.onBrowserResize()}.bind(this),25)}ri(window.top,"resize",this.resizeHandler),oi(window.top,"resize",this.resizeHandler),ui(!1,this.frame.querySelector("iframe"))}},{key:"getOrientation",value:function(e){return li()?e.height>e.width?Yt:Xt:window.screen.availHeight>window.screen.availWidth?Yt:Xt}},{key:"resizeForPhone",value:function(){if(!this.isMinimized()&&this.chatActive){var e=c.getViewport();this.area=new l(0,0,e.width,e.height),this.setWH(),this.updatePosition()}}},{key:"addViewPort",value:function(){this.metaTag=this.doc.createElement("meta"),this.metaTag.name="viewport",this.metaTag.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0",this.doc.getElementsByTagName("head")[0].appendChild(this.metaTag)}},{key:"keyboardScrollDebouncedEvent",value:function(){ri(window.top,"scroll",this.keyboardScrollHandler),this.keyboardUpTimer=setTimeout(function(){this.onVirtualKeyboardOpen()}.bind(this),100)}},{key:"scrollDebouncedEvent",value:function(t){if(1==this.scrollState)return this.scrollState=0,this.forceScrollTimer&&clearTimeout(this.forceScrollTimer),void setTimeout(function(){this.isVirtualKeyboardPresent=!0,window.top.scrollTo(0,0),setTimeout(function(){2==this.scrollState&&this.scrollDebouncedEvent()}.bind(this),500),this.scrollState=2}.bind(this),200);if(this.isVirtualKeyboardPresent){this.scrollState=0;var i,n=c.getViewport(),s=this.frame.querySelector("#".concat(this.mApp.config.frameID));window.parent.visualViewport?0==(i=n.height-function(){if(window.parent.visualViewport){var e=window.parent.visualViewport.height;return Math.round(e)}return 0}())&&this.onForcedInputFocus():i=n.height>n.width?this.area.height*(e.keyBoardValuePort()[this.iphoneModel]||.43):.6*this.area.height,this.frame.style.height=null,this.frame.style.bottom="".concat(i,"px");var a=getComputedStyle(this.frame),o=parseInt(n.height,10),r=parseInt(a.paddingTop,10)+parseInt(a.paddingBottom,10);s.style.height="".concat(o-i-r,"px"),this.reLayout(),this.scrolled=window.top.pageYOffset,ri(window.top,"scroll",this.scrollHandler),ri(window.top,"scroll",this.moveScrollHandler),oi(window.top,"scroll",this.moveScrollHandler),i>0&&Ti.publish(G,t)}}},{key:"touchMoveScrollHandler",value:function(e){e.preventDefault(),e.stopPropagation(),window.top.scrollTo(0,this.scrolled)}},{key:"onVirtualKeyboardOpen",value:function(){if(!this.theme||!this.theme.embedded){var e=hi(c.getViewport(),this.currentOrientation),t=this.currentOrientation==Yt&&e>Y,i=this.currentOrientation==Xt&&e>X;t||i||this.isIpad()||(ri(window.top,"scroll",this.scrollHandler),oi(window.top,"scroll",this.scrollHandler),this.keyboardUpTimer&&(clearTimeout(this.keyboardUpTimer),this.keyboardUpTimer=null),this.scrollState=1,this.forceScrollTimer=setTimeout((function(){window.top.scrollBy(0,10)}),200))}}},{key:"onForcedInputFocus",value:function(){oi(window.top,"scroll",this.keyboardScrollHandler)}},{key:"onVirtualKeyboardHidden",value:function(){if(!this.theme||!this.theme.embedded){var e=hi(c.getViewport(),this.currentOrientation),t=this.currentOrientation==Yt&&e>Y,i=this.currentOrientation==Xt&&e>X;t||i?this.isVirtualKeyboardPresent=!1:this.isIpad()||(this.isVirtualKeyboardPresent&&(this.kbHiddenTimer&&clearTimeout(this.kbHiddenTimer),this.kbHiddenTimer=setTimeout(function(){var e=c.getViewport();this.isVirtualKeyboardPresent=!1,this.frame.style.bottom=null,this.resizeForPhone(e),this.kbHiddenTimer=null}.bind(this),250)),ri(window.top,"scroll",this.moveScrollHandler))}}},{key:"onBrowserResize",value:function(t){this.timeout&&window.cancelAnimationFrame(this.timeout),this.timeout=window.requestAnimationFrame(function(){if(this.mApp.getSDKInstance().isPersistentWindow()||this.theme.embedded);else if(this.isPhone()){var i=c.getViewport(),n=this.getOrientation(i),s=hi(i,n);if(this.currentOrientation!==n){if(this.currentOrientation=n,this.resizeForPhone(i),li()&&this.isVirtualKeyboardPresent)return void this.handleIOSVirtualKeyboardWhenResized(i,t);li()&&setTimeout((function(){window.top.scrollTo(0,0)}),200),Ti.publish(z,t)}else(n==Yt&&s<=Y||n==Xt&&s<=X)&&(li()&&this.isVirtualKeyboardPresent?this.handleIOSVirtualKeyboardWhenResized(i,t):li()?setTimeout(function(){this.resizeForPhone(i)}.bind(this),200):(this.resizeForPhone(i),Ti.publish(z,t)))}else{var a=e.screenOffset,o=parseInt(this.frame.style.height,10),r=c.getScrollHeight();r>o&&0===a||(a>0&&r-a)>o?(this.frame.classList.contains("adjust-height")&&(this.frame.classList.remove("adjust-height"),this.ciApp.toggleFullScreen(!1)),this.resizeWindow(),this.area.height=parseInt(this.frame.style.height,10)):(this.frame.classList.contains("adjust-height")||(this.frame.classList.add("adjust-height"),this.ciApp.toggleFullScreen(!0)),this.area.height=c.getViewport().height),c.getScrollWidth()>parseInt(this.frame.style.width,10)?(this.frame.classList.contains("adjust-width")&&this.frame.classList.remove("adjust-width"),this.resizeWindow(),this.area.width=parseInt(this.frame.style.width,10)):(this.frame.classList.contains("adjust-width")||this.frame.classList.add("adjust-width"),this.area.width=c.getViewport().width)}}.bind(this))}},{key:"handleIOSVirtualKeyboardWhenResized",value:function(e,t){e.width>e.height?this.scrollDebouncedEvent(t):(this.scrollState=1,ri(window.top,"scroll",this.scrollHandler),oi(window.top,"scroll",this.scrollHandler),this.forceScrollTimer=setTimeout((function(){window.top.scrollBy(0,10)}),200))}},{key:"setWH",value:function(){var t=this.frame.querySelector("#".concat(this.mApp.config.frameID)),i=getComputedStyle(this.frame);this.frame.style.width="".concat(this.area.width,"px"),t.classList.add("enter"),t.style.width="".concat(this.area.width-(parseInt(i.paddingLeft,10)+parseInt(i.paddingRight,10)),"px"),this.frame.style.height="".concat(this.area.height,"px"),this.isPhone()?t.style.height="".concat(this.area.height-(parseInt(i.paddingTop,10)+parseInt(i.paddingBottom,10)),"px"):t.style.height="".concat(this.area.height-e.bottomDelta-(parseInt(i.paddingTop,10)+parseInt(i.paddingBottom,10)),"px")}},{key:"setPersistentChatWH",value:function(){}},{key:"resizeWindow",value:function(){var t,i=this.area.width,n=this.area.height;if(this.theme&&-1!=this.theme.skinRightSaved&&-1!=this.theme.skinBottomSaved)(t=new ci).p1=this.theme.skinRightSaved,t.p2=this.theme.skinBottomSaved;else{var s=messagingApp.config;t=e.calcChatLocation(i,n,this.theme?this.theme.skinLeft:0,this.theme?this.theme.skinTop:0,s.framePos?s.framePos:this.theme.skinPosition)}t.p1=e.setFixedRPosition(t.p1,i),t.p2=e.setFixedBPosition(t.p2,n),this.area.setBRPosition(t.p1,t.p2,i,n),this.updatePosition()}},{key:"moveStage",value:function(e,t){var i=c.getScrollWidth()-(e+this.area.width),n=c.getScrollHeight()-(t+this.area.height);this.area.setBRPosition(i,n,this.area.width,this.area.height),this.theme.skinRightSaved==i&&this.theme.skinBottomSaved==n||(messagingApp.getSDKInstance().saveWindowPosition(this.area.b,this.area.r),this.updatePosition()),this.theme.skinRightSaved=i,this.theme.skinBottomSaved=n}},{key:"addDragElement",value:function(e,t){if(!this.isPhone()&&e&&!this.mApp.getSDKInstance().isPersistentWindow()&&!e.embedded){var i=messagingApp.getUIConfig();ki.setDragable(i.appConfigProps.dragMode,t||this.frame)}}},{key:"updatePosition",value:function(){this.reLayout()}},{key:"reLayout",value:function(){this.area.isXYAxisPos()?(this.frame.style.left="".concat(this.area.x,"px"),this.frame.style.top="".concat(this.area.y,"px")):(this.frame.style.right="".concat(this.area.r,"px"),this.frame.style.bottom="".concat(this.area.b,"px"),this.frame.style.left=null,this.frame.style.top=null)}},{key:"minimize",value:function(){this.setVisible(!1),this.minimized=!0}},{key:"isMinimized",value:function(){return this.minimized}},{key:"isChatActive",value:function(){return this.chatActive}},{key:"setVisible",value:function(e){if(e)this.minimized=!1,this.theme.minimized={},this.render(this.theme),this.minimizedCount=0,this.ciApp.onResumeFrame();else{if(ri(window.top,"resize",this.resizeHandler),this.messagingTopBarEl){var t=this.messagingTopBarEl.div[Si.INSTANCE_LABEL];t&&t.clear(),this.messagingTopBarEl.delete()}else ri(window.top,"scroll",this.scrollHandler),ri(window.top,"scroll",this.moveScrollHandler),ri(window.top,"scroll",this.keyboardScrollHandler),li()?(this.metaTag&&this.metaTag.parentElement.removeChild(this.metaTag),this.doc.body.classList.remove("chatopen")):this.doc.documentElement.style.overflow="scroll";var i=this.frame.querySelector("#".concat(this.mApp.config.frameID));this.frame.classList.remove("embedded"),this.frame.style.height="1px",i.classList.remove("enter"),i.style.width=null,i.style.height=null,this.frame.style.width="1px",this.frame.classList.remove("adjust-height"),this.frame.classList.remove("adjust-width"),this.kbHiddenTimer&&clearTimeout(this.kbHiddenTimer),ui(!0,i),this.chatActive=!1}}},{key:"clear",value:function(){this.setVisible(!1),setTimeout(function(){this.frame.style.bottom=null,this.frame.style.right=null}.bind(this),500),this.ciApp.onDestroyFrame()}},{key:"isPhone",value:function(){return"Phone"==this.theme.deviceType}},{key:"isTablet",value:function(){return"Tablet"==this.theme.deviceType}},{key:"isMobile",value:function(){return this.isPhone()||this.isTablet()}},{key:"isIpad",value:function(){return this.isTablet()&&li()}}],[{key:"setFixedRPosition",value:function(t,i){return e.FixR(t,i)}},{key:"setFixedBPosition",value:function(t,i){return e.FixB(t,i)}},{key:"FixR",value:function(e,t){var i=e<0?0:e,n=i+t,s=c.getScrollWidth();return n>s&&0!=i&&(i=s-t),i<0&&(i=0),i}},{key:"FixB",value:function(e,t){var i=e<0?0:e,n=c.getScrollHeight()-t;return i>n&&0!=i&&(i=n),i<0&&(i=0),i}},{key:"calcChatLocation",value:function(t,i,n,s,a){var o,r,l=0,u=0;c.hasRightScrollBar(),c.hasBottomScrollBar();if("Microsoft Internet Explorer"==window.navigator.appName||-1!=window.navigator.userAgent.indexOf("Trident")){var h=window.parent.document;0==(r=h.documentElement.clientHeight)&&(r=h.body.clientHeight),0==(o=h.documentElement.clientWidth)&&(o=h.body.clientWidth)}else r=window.parent.innerHeight,o=window.parent.innerWidth;switch(t<e.minWidth&&(t=e.minWidth),i<e.minHeight&&(i=e.minHeight),a.toUpperCase()){case"UPPER CENTER":case"UPPER_CENTER":case"TOP_CENTER":u=r-i,l=o/2-t/2;break;case"UPPER_RIGHT":case"TOP_RIGHT":u=r-i,l=0;break;case"UPPER_LEFT":case"TOP_LEFT":u=r-i,l=o-t;break;case"CENTER_LEFT":u=r/2-i/2,l=o-t;break;case"CENTER_RIGHT":u=r/2-i/2,l=0;break;case"LOWER_LEFT":case"BOTTOM_LEFT":u=0,l=o-t;break;case"LOWER_CENTER":case"BOTTOM_CENTER":u=0,l=o/2-t/2;break;case"LOWER_RIGHT":case"BOTTOM_RIGHT":l=0,u=0;break;case"POP_UNDER_CENTER":l=o/2-t/2,u=r/2-i;break;case"ABSOLUTE":case"FIXED":case"RELATIVE":l=n,u=s;break;case"CENTER":l=o/2-t/2,u=r/2-i/2}return(null==l||l<0)&&(l=0),(null==u||u<0)&&(u=0),new ci(0|l,0|u)}},{key:"keyBoardValuePort",value:function(){return{iPhoneX:.45}}}]),e}(),Ei=i(8),Ii=i.n(Ei),ji=i(11),Ai=i.n(ji),Mi={AGENT_MESSAGE:1,CUSTOMER_MESSAGE:2,TYPING_MESSAGE:3,SYSTEM_MESSAGE:4,VIRTUAL_AGENT_MESSAGE:5,OPENER_MESSAGE:6,CONVERSATION_HEADER:7,DISCLAIMER_TEXT:8,RICH_MESSAGE_QR:9,RICH_MESSAGE_CARD:10,RICH_MESSAGE_FORM:11,RICH_MESSAGE_RECEIPT:12,RICH_MESSAGE_OTHER:13},Li=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.bubbleType,n=void 0===i?Mi.AGENT_MESSAGE:i,s=t.messageText,o=void 0===s?"":s,r=t.isAuto,l=void 0!==r&&r,c=t.name,u=void 0===c?"":c,h=t.timestamp,d=void 0===h?Date.now():h;a()(this,e),this.bubbleType=n,this.text=o,this.auto=l,this._name=u,this._timestamp=d,this._persistInTranscript=!!Mi.TYPING_MESSAGE,this._agentIndex=0,this._isLast=!1}return r()(e,[{key:"setMessageBubble",value:function(e){this.bubbleType=e}},{key:"getMessageBubble",value:function(){return this.bubbleType}},{key:"getName",value:function(){return this._name}},{key:"setName",value:function(e){this._name=e}},{key:"isVA",value:function(){return this.auto}},{key:"setVA",value:function(){this.auto=!0}},{key:"getMessageText",value:function(){return this.text}},{key:"setMessageText",value:function(e){this.text=e}},{key:"getTimeStamp",value:function(){return this._timestamp}},{key:"setTimeStamp",value:function(e){this._timestamp=e}},{key:"setSamePreviousType",value:function(e){this.samePreviousType=e}},{key:"isSamePreviousType",value:function(){return this.samePreviousType||!1}},{key:"setRestore",value:function(e){this.restore=e}},{key:"getIsRestore",value:function(){return this.restore}},{key:"setIsLast",value:function(e){this._isLast=e}},{key:"isLast",value:function(){return this._isLast}},{key:"persistInTranscript",value:function(e){this._persistInTranscript=e}},{key:"getPersistInTranscriptState",value:function(){return this._persistInTranscript}},{key:"setInternalState",value:function(e){this._state=e}},{key:"setTypingState",value:function(e){this._state=e}},{key:"getInternalState",value:function(){return this._state}},{key:"setRichData",value:function(e){this._richData=e}},{key:"getRichData",value:function(){return this._richData}},{key:"setRichInstance",value:function(e){this._richInstance=e}},{key:"getRichInstance",value:function(){return this._richInstance}},{key:"setAgentIndex",value:function(e){this._agentIndex=e}},{key:"getAgentIndex",value:function(){return this._agentIndex}},{key:"isEmptyResponse",value:function(){return this.text===k}}]),e}();function Pi(e,t){return e.filter((function(e){var i=e.hiddenDeviceTypes;return!i||-1===i.indexOf(t)}))}var _i=function(){function e(){a()(this,e)}return r()(e,[{key:"initAppStringProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var t in this.typingMsg=e.startTyping||"Agent is typing",this.stoppedTypingMsg=e.stoppedTyping||"Agent stopped typing",this.openerText=e.openerText,this.serviceNotAvailable=void 0===e.messagingNotAvailable?"Messaging service not available at this time. Please try again later.":e.messagingNotAvailable,this.networkDisconnected=e.messagingDisconnected||"Connection to messaging server is disconnected. Please check your network.",this.networkConnected=e.messagingReconnected||"Connection to messaging server is restored.",this.networkFailed=e.messagingFailed||"Unable to establish a connection to server. please try again later.",this.customerName=e.customerName||this.CIAPIInstance.getCustomerName(),this.agentAlias=e.agentAlias,this.serviceQueued=void 0===e.serviceQueued?"An agent will respond as soon as they are available":e.serviceQueued,this.agentAvailable=void 0===e.agentAvailable?"Agent now available":e.agentAvailable,this.agentExitText=e.agentExitText,this.agentResolvedText=e.agentResolvedText,this.agentInitiateTransfer=e.agentInitiateTransfer,this.agentLostText=e.agentLostText,this.agentTransferLostText=e.agentTransferLostText,this.agentTransferStatusText=e.agentTransferStatusText,this.ninaCoachStatusText=e.ninaCoachStatusText,this.conferenceModeText=e.conferenceModeText,this.closeConfirmationText=e.closeConfirmationText||"Are you sure you want to end the chat?",this.closeModalNegativeButtonText=e.closeModalNegativeButtonText||L,this.closeModalPositiveButtonText=e.closeModalPositiveButtonText||"End Chat",this.historyLoadingText=e.historyLoadingText||"We are loading recent chat history, please hold...",this.emailModalInputLabel=e.emailModalInputLabel||"Enter your email address.",this.emailModalOkButtonText=e.emailModalOkButtonText||M,this.emailModalCancelButtonText=e.emailModalCancelButtonText||L,this.emailModalSendButtonText=e.emailModalSendButtonText||"Send",this.emailModalMailFailText=e.emailModalMailFailText||"Invalid mail address. Please enter a valid email address.",this.emailModalMailSentText=e.emailModalMailSentText||"Your transcript has been sent to your mail.",this.emailModalMailValidText=e.emailModalMailValidText||"Valid mail address.",this.disclaimerText=e.disclaimerHeaderText,this.autoEngageText=e.autoEngageText,this.audioTextOn=e.audioTextOn,this.audioTextOff=e.audioTextOff,this.ariaStrings={opensNewWindow:"Opens in a new window",cardDeckReader:"Card, 1 of {total}. Navigate to other entries with buttons in transcript.",quickReplyReader:"Interactive buttons, group of {total}.",transcriptLabel:"Chat transcript"},e.ariaStrings)this.ariaStrings[t]=e.ariaStrings[t]}},{key:"initConfigProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.queuedMsgInAsync=void 0!==e.displayQueuedMessagesInAsync&&e.displayQueuedMessagesInAsync,this.persistQueueMessages=e.persistQueueMessages,this.showConvHeader=void 0===e.showConversationHeader||e.showConversationHeader,this.showStoppedTyping=void 0===e.shouldDisplayStoppedTyping||e.shouldDisplayStoppedTyping,this.showTransferInitiateMessage=void 0===e.showTransferInitiateMessage||e.showTransferInitiateMessage,this.showTransferStatusMessage=void 0===e.showTransferStatusMessage||e.showTransferStatusMessage,this.showNinaCoachStatusMessage=void 0===e.showNinaCoachStatusMessage||e.showNinaCoachStatusMessage,this.showConferenceModeMessage=void 0===e.showConferenceModeMessage||e.showConferenceModeMessage,this.enableMsgGrouping=e.enableMsgGrouping,this.showTransferLostMessage=e.showTransferLostMessage,this.showMemberLostMessage=void 0===e.showMemberLostMessage||e.showMemberLostMessage,this.openerDelay=e.openerDisplayInterval||3e3,this.showAsyncChatExitMsg=void 0!==e.showAsyncChatExitMsg&&e.showAsyncChatExitMsg,this.showAsyncChatResolvedMsg=void 0!==e.showAsyncChatResolvedMsg&&e.showAsyncChatResolvedMsg,this.showDisclaimerText=void 0!==e.showHeaderDisclaimer&&e.showHeaderDisclaimer,this.vaTyping=e.vaTypingIndiatorDelay||0,this.startAutoEngagement=e.startAutoEngagement,this.waitForOpener=e.disableFooterUntilOpener,this.queueAsAgent=e.showQueueMsgAsAgent,this.audioInitialSetting=e.audioInitialSetting||zt,this.networkMessageDelay=e.networkMessageDelay||3e3,this.focusOnInteractiveElement=void 0===e.focusOnInteractiveElement||e.focusOnInteractiveElement,this.focusOnAgentMessage=e.focusOnAgentMessage||Kt,this.focusOnOpen=e.focusOnOpen||Zt,this.focusInputOnVADialogClick=e.focusInputOnVADialogClick,this.minimizeOnNewPage=e.minimizeOnNewPage||ni,this.minimizeAndCloseAccessKeys=e.minimizeAndCloseAccessKeys||{mainKey:"altKey",closeKey:57,minimizeKey:50},this.reverseCloseModalButtons=e.reverseCloseModalButtons,this.reverseEmailModalButtons=e.reverseEmailModalButtons,this.moveEmailCancelBtnToBottom=void 0===e.moveEmailCancelBtnToBottom||e.moveEmailCancelBtnToBottom}},{key:"filterHiddenMenu",value:function(e){var t=e.topBarConfig.topBarSettings;t&&t.extendedTopBarItems&&(t.extendedTopBarItems=Pi(t.extendedTopBarItems,this.CIAPIInstance.getDeviceType()),0===t.extendedTopBarItems.length&&(t.extendedTopBarItems=null));var i=e.footerConfig.footerSettings;i&&i.extendedFooterItems&&(i.extendedFooterItems=Pi(i.extendedFooterItems,this.CIAPIInstance.getDeviceType()),0===i.extendedFooterItems.length&&(i.extendedFooterItems=null))}},{key:"filterSurveyItem",value:function(e,t){e&&(this.extendedSurveyTopBarVisible=!(!e.extendedTopBarInSurvey||!e.extendedTopBarItems)),t&&(this.extendedSurveyFooterVisible=!(!t.extendedFooterInSurvey||!t.extendedFooterItems))}}]),e}(),Di=i(7),Oi=i.n(Di);function Ri(){return/(iPad|iPhone|iPod)/g.test(window.navigator.userAgent)}function Bi(e,t){for(var i=0,n=(t=t.split(".")).length;i<n;i++)e=e[t[i]];return e}function Vi(e,t){var i=e.imgsrc&&"undefined"!==e.imgsrc?e.imgsrc:e.imgname||"",n={type:"Chime"};if(!("undefined"===e.audioonimgname||"undefined"===e.audiooffimgname))t.isSoundEnabled()?n.imgname=e.audiooffimgname:n.imgname=e.audioonimgname;else if(i){var s=i.lastIndexOf("."),a=i.substring(0,s)+(t.isSoundEnabled()?"_off":"_on")+i.substring(s,i.length);e.imgsrc&&"undefined"!==e.imgsrc?n.imgsrc=a:a&&(n.imgname=a)}return n}function Ni(e,t){var i=t.audioTextOff||"".concat(e," ","off"),n=t.audioTextOn||"".concat(e," ","on");return t.isSoundEnabled()?i:n}function Hi(e,t){t.classList.remove("chimeon","chimeoff"),t.classList.add(e?"chimeoff":"chimeon")}function Fi(e,t){Object.assign(t.style,e)}function $i(e,t){return e&&(e=e.replace(/%(\S+)%/g,(function(e,i){return t[i]||i}))),e}function qi(e,t){var i=Yi(e,t);return i?"url('".concat(i,"')"):""}function Ui(e,t,i,n){"insertRule"in e?e.insertRule("".concat(t,"{").concat(i,"}"),n):"addRule"in e&&e.addRule(t,i,n)}var Wi={nbsp:" ",cent:"¢",pound:"£",yen:"¥",euro:"€",copy:"©",reg:"®",lt:"<",gt:">",quot:'"',amp:"&",apos:"'"};function Gi(e){return(e=e.replace(/\&amp;/g,"&")).replace(/\&([^\s;]+);/g,(function(e,t){var i;return t in Wi?Wi[t]:(i=t.match(/^#x([\da-fA-F]+)$/))?String.fromCharCode(parseInt(i[1],16)):(i=t.match(/^#(\d+)$/))?String.fromCharCode(~~i[1]):e}))}function zi(e,t,i){var n;return function(){var s=this,a=arguments,o=function(){n=null,i||e.apply(s,a)},r=i&&!n;clearTimeout(n),n=setTimeout(o,t),r&&e.apply(s,a)}}function Yi(e,t){var i;return e.imgsrc&&"undefined"!==e.imgsrc||e.imgSrc?i=e.imgsrc||e.imgSrc:(e.imgname&&"undefined"!==e.imgname||e.imgName)&&(i="".concat(t.getImagePath()).concat(e.imgname||e.imgName)),i}var Xi=["January","February","March","April","May","June","July","August","September","October","November","December"],Ki=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Ji(e,t){var i=new Date(e),n=function(e){return(e<10?"0":"")+e},s="";return t.replace(/yyyy|YYYY|MMM|MM|DD|dd|HH|H|hh|h|mm|ss|month/g,(function(e){switch(e){case"yyyy":case"YYYY":return n(i.getFullYear());case"MMM":return Ki[i.getMonth()];case"MM":return n(i.getMonth()+1);case"mm":return n(i.getMinutes());case"dd":case"DD":return n(i.getDate());case"HH":case"H":var t=i.getHours();return"H"==e?t:n(t);case"hh":case"h":var a=i.getHours();return s=" AM",0==(a=(a+24)%24)?a=12:a>=12&&(0==(a%=12)&&(a=12),s=" PM"),"h"==e?a:n(a);case"ss":return n(i.getSeconds());case"month":return Xi[i.getMonth()]}return e}))+s}var Qi=function(e){return JSON.parse(JSON.stringify(e))},Zi=function(e){return null!=e&&"object"===bi()(e)&&!1===Array.isArray(e)},en=function(e,t){return JSON.stringify(e)===JSON.stringify(t)};function tn(e){e.scrollTop=e.scrollHeight}function nn(e,t){return sn(e,e.scrollHeight,t)}function sn(e,t,i){if(t=Math.round(t),(i=Math.round(i))<0)return Promise.reject("bad duration");if(0===i)return e.scrollTop=t,Promise.resolve();var n=Date.now(),s=n+i,a=e.scrollTop,o=t-a-e.clientHeight,r=!1;return{interrupt:function(){r=!0},p:new Promise((function(t,i){var l=e.scrollTop;window.raf((function c(){if(r)i("interrupted");else{var u=Date.now(),h=function(e,t,i){if(i<=e)return 0;if(i>=t)return 1;var n=(i-e)/(t-e);return n*n*(3-2*n)}(n,s,u),d=Math.round(a+o*h);if(e.scrollTop=d,u>=s)return e.scrollTop=a+o,void t();if(e.scrollTop===l&&e.scrollTop!==d)return e.scrollTop=a+o,void t();l=e.scrollTop,window.raf(c)}}))}))}}function an(e,t,i){e===document&&(e=document.scrollingElement||document.documentElement||document.body.parentNode||document.body);var n,s=!1,a=!1,o=e.scrollTop,r=e===document.body&&document.documentElement?document.documentElement:e;function l(i){if(i.preventDefault(),!a){var n=function(e){if(e.detail)return e.wheelDelta?e.wheelDelta/e.detail/40*(e.detail>0?1:-1):-e.detail/3;return e.wheelDelta/120}(i);o=e.scrollTop,o+=Math.round(-n*t),o=Math.max(0,Math.min(o,e.scrollHeight-r.clientHeight)),s||c()}}function c(){if(a)s=!1;else{s=!0;var t=o-e.scrollTop,n=t/i;e.scrollTop+=n,Math.abs(n)>=1?u(c):Math.abs(n)<1&&Math.abs(n)>0?Math.abs(t)<=1?(e.scrollTop=o,s=!1):(e.scrollTop+=Math.ceil(n),u(c)):s=!1}}Ri()?(e.addEventListener("touchstart",(function(e){var t=e.touches[0].clientY;n=t}),{passive:!1}),e.addEventListener("touchmove",(function(i){if(i.preventDefault(),a)return;var l=i.changedTouches[0].clientY,u=l-n;o=e.scrollTop,o+=u*t*-1,o=Math.max(0,Math.min(o,e.scrollHeight-r.clientHeight)),n=l,s||c()}),{passive:!1})):(e.addEventListener("mousewheel",l,{passive:!1}),e.addEventListener("DOMMouseScroll",l,{passive:!1})),this.pause=function(){a=!0},this.resume=function(){a=!1},this.reset=function(){e.removeEventListener("mousewheel",l,{passive:!1}),e.removeEventListener("DOMMouseScroll",l,{passive:!1})},this.resume();var u=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,20)}}var on,rn,ln,cn,un,hn,dn,pn,mn,fn,gn,vn,yn,bn=(on={},rn={},ln={},un=function(){for(var e,t,i,n,s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];if(0===a.length)throw Error("Timeout.set() requires at least one argument");if("function"==typeof a[1]?(e=a[0],t=a[1],i=a[2],n=a.slice(3)):(t=a[0],i=a[1],n=a.slice(2),e=t.toString()),!t)throw Error("Timeout.set() requires a function parameter");cn(e);var r=function(){return ln[e]=!1,t.apply(void 0,Oi()(n))};return on[e]=setTimeout(r,i||0),rn[e]=rn[e]||i,ln[e]={func:t,key:e,ms:i,params:n,paused:!1,startTime:(new Date).getTime(),timeSpentWaiting:0},function(){return dn(e)}},pn=function(e){return hn(e)&&!dn(e)},mn=function(e){return hn(e)&&ln[e].paused},fn=function(e){return!(!ln[e]||mn(e))&&(cn(e,!1),ln[e].paused=!0,ln[e].timeSpentWaiting=(new Date).getTime()-ln[e].startTime,ln[e].timeSpentWaiting)},vn=function(e){if(!ln[e])return 0;var t=ln[e],i=t.ms,n=t.startTime,s=t.timeSpentWaiting;return mn(e)?i-s:Math.max(0,n+i-(new Date).getTime())},yn=function(e){if(!ln[e])return!1;var t=ln[e],i=t.func,n=t.params,s=t.paused;return cn(e,!1),s&&(ln[e].paused=!1),un.apply(void 0,[e,i,rn[e]].concat(Oi()(n)))},{clear:cn=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];clearTimeout(on[e]),delete on[e];var i=ln[e]&&ln[e].func;return t&&(delete ln[e],delete rn[e]),i},executed:dn=function(e){return!1===ln[e]},exists:hn=function(e){return e in on||void 0!==ln[e]},instantiate:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e)throw Error("Timeout.instantiate() requires a function parameter");for(var i="".concat(Math.random()).concat(e).replace(/\s/g,""),n=arguments.length,s=new Array(n>2?n-2:0),a=2;a<n;a++)s[a-2]=arguments[a];return un.apply(void 0,[i,e,t].concat(s)),{clear:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return cn(i,e)},executed:function(){return dn(i)},exists:function(){return hn(i)},pause:function(){return fn(i)},paused:function(){return mn(i)},pending:function(){return pn(i)},remaining:function(){return vn(i)},restart:function(){return yn(i)},resume:function(){return gn(i)},set:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length,s=new Array(n>2?n-2:0),a=2;a<n;a++)s[a-2]=arguments[a];return un.apply(void 0,[i,e,t].concat(s))}}},pause:fn,paused:mn,pending:pn,remaining:vn,restart:yn,resume:gn=function(e){if(!ln[e])return!1;var t=ln[e],i=t.func,n=t.ms,s=t.params,a=t.paused,o=t.timeSpentWaiting;return!!a&&un.apply(void 0,[e,i,n-o].concat(Oi()(s)))},set:un});!function(e,t,i){for(var n=0,s="requestAnimationFrame",a="cancelAnimationFrame",o="AnimationFrame",r=["ms","moz","webkit","o"],l=0;l<r.length&&!e[s];++l)e[s]=e["".concat(r[l],"Request").concat(o)],e[a]=e["".concat(r[l],"Cancel").concat(o)]||e["".concat(r[l],"CancelRequest").concat(o)];e[s]||(e[s]=function(t){var i=(new Date).getTime(),s=Math.max(0,16-(i-n)),a=e.setTimeout((function(){t(i+s)}),s);return n=i+s,a}),e[a]||(e[a]=function(t){e.clearTimeout(t)});var c=[],u={},h=0,d=e[s];e[a];function p(e){if(c.length&&m.running){for(var t=c.splice(0),i=0,n=null,s=t.length;i<s;i++)(n=t[i]).cancel||n.fn(e),delete u[n.guid];d(p)}else m.running=!1}var m=function e(t){return h++,u[h]=t,c.push({guid:h,cancel:!1,fn:t}),e.running||(e.running=!0,d(p)),h};m.running=!0,m.cancel=function(e){return!!u[e]&&(u[e].cancel=!0,!0)},m.fps=function(e,t){var i=0,n=1e3/t;!function t(s){var a=s-(i||0);m(t),i&&a<n||(i=s,e(s))}()},e.caf=m.cancel,t||(t="raf"),d(p),e[t]=m}(window,"raf");function Sn(e){return e=(e=e.replace(/'/g,'"')).replace(/\\/g,""),e=JSON.parse(Gi(e))}function wn(e,t,i,n){var s=document.createElement("button");return s.classList.add(e),s.innerText=t,i&&Fi(i,s),s.onclick=n,s}function kn(e,t,i,n){if(t){var s=new Li({bubbleType:Mi.SYSTEM_MESSAGE,messageText:t});s.setInternalState(i),s.persistInTranscript(!!n),e.addToUI(s)}}function Cn(e,t){e?t.parentElement.removeChild(t):window.raf((function(){t.parentElement.removeChild(t)}))}var Tn=i(5),xn=i.n(Tn),En=function(){function e(t){a()(this,e),this.$app=t}return r()(e,[{key:"displayInfoModalWindow",value:function(e){e=e||"",this.$app.shoutui.getLayoutEl().showInfoModalView(e),this.setAriaReaderTextOfInfoModal(e)}},{key:"setAriaReaderTextOfInfoModal",value:function(e){var t=e.replace(/(<([^>]+)>)/gi,"");t=(t=t.replace(/(\r\n|\n|\r)/gm,".")).replace(/\s+/g," "),this.$app.getStateMgr().setState({ariaReaderSay:t})}},{key:"requestEmail",value:function(){this.$app.shoutui.getLayoutEl().showEmailModal()}},{key:"showFileUploadModal",value:function(){this.$app.shoutui.getLayoutEl().showFileUploadModal()}},{key:"hideFileUploadModal",value:function(){this.$app.shoutui.getLayoutEl().hideFileUploadModal()}}],[{key:"setFocusWithinModalWindow",value:function(e){for(var t,i=e.querySelectorAll('a, button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),n=document.querySelectorAll('a, button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),s=0;s<n.length;s++)"-1"!=(t=n[s].getAttribute("tabindex")||0)&&(n[s].setAttribute("tabindex","-1"),n[s].setAttribute("data-custom-index",t));for(var a=0;a<i.length;a++)i[a].hasAttribute("tabindex")&&i[a].setAttribute("tabindex",a+1)}},{key:"removeNegativeTabIndexOnClosingModal",value:function(){for(var e,t=document.querySelectorAll("[data-custom-index]"),i=0;i<t.length;i++)e=t[i].getAttribute("data-custom-index"),t[i].setAttribute("tabindex",e),t[i].removeAttribute("data-custom-index")}}]),e}(),In=function(){function e(t){a()(this,e),this.$app=t,this.isQueued=!1,this.agents=[],this.statusObj=t.statusItems,this.confAgents=[],this.currentWindowId=null}return r()(e,[{key:"onNewMessage",value:function(e,t,i){var n=parseInt(this.getProperty(e,Ee)||Date.now(),10),s=!1;if(e)switch(this.getProperty(e,Te)){case ae:var a=this.getProperty(e,xe),o=this.getProperty(e,Ae),r=n,l=this.getProperty(e,Me),c="1"===this.getProperty(e,We),h=this.getProperty(e,Ge);if(o){t||Ti.publish("new.agentMsg",e);var d=this.getDataMessage(e);if(d&&this.displayDataMessage(d,a,t,!1,l,r,i));else{if(a==k)return;var g=new Li({messageText:a,isAuto:!1,name:l,timestamp:r});g.setRestore(t),g.setIsLast(i),this.$app.getIsMinimized()&&!t&&this.$app.getBridge().messageOnMinimized(e),g.setAgentIndex(this.setAgentIndex(l)),this.$app.addToUI(g)}t||this.$app.sndMgr.playSound()}else if(t||!c&&this.currentWindowId!==h)if(a.startsWith(k)){var v=this.getDataMessage(e);v&&this.displayDataMessage(v,a,!0,!1,l,r,!1,!0)}else this.$app.addCustomerBubble(a,!0,r);else this.$app.getIsMinimized()&&(this.$app.addCustomerBubble(a,!0,r),this.$app.getCIAPIInstance().resetMinimizedCount());break;case oe:s=!0;case re:if(t){var y=this.getProperty(e,xe),b=n,S=this.getProperty(e,Me);if(s&&this.displayOpenerRichMessage(y,!0,!1,S,b))return;var w=new Li({messageText:y,isAuto:!1,name:S,timestamp:b});w.setRestore(!0),w.setAgentIndex(this.setAgentIndex(S)),s&&w.setMessageBubble(Mi.OPENER_MESSAGE),this.$app.openerText=y,this.$app.addToUI(w)}break;case Se:var T=this.getProperty(e,He),x=this.getProperty(e,Be),E=n;this.$app.getIsMinimized()&&!t&&this.$app.getBridge().messageOnMinimized(e);var I=new Li({messageText:T,isAuto:!1,name:x,timestamp:E});I.setRestore(t),I.setAgentIndex(this.setAgentIndex(x)),this.$app.addToUI(I),t||this.$app.sndMgr.playSound();break;case be:bn.exists(C)&&bn.clear(C);var j=this.getProperty(e,Re),A=this.getProperty(e,Be),M=n,L=this.getDataMessage(e);if(L&&this.displayDataMessage(L,j,t,!0,A,M,i));else{var P=new Li({bubbleType:Mi.VIRTUAL_AGENT_MESSAGE,messageText:j,isAuto:!0,name:A,timestamp:M});P.setRestore(t),P.setIsLast(i),P.setAgentIndex(this.setAgentIndex(A)),this.$app.getIsMinimized()&&!t&&this.$app.getBridge().messageOnMinimized(P),this.$app.addToUI(P)}t||this.$app.sndMgr.playSound();break;case le:t||this.processTypingMessages(e);break;case ce:t||(this.isQueued=!0,!this.$app.queuedMsgInAsync&&this.$app.isAsyncChat||this.addSystemMessage(this.$app.serviceQueued,Je));break;case he:var _=this.getProperty(e,Ke);_&&this.$app.setConversationID(_);break;case ue:var D=this.$app.getCIAPIInstance(),O=this.getProperty(e,Ye),R=this.getProperty(e,Fe);O&&this.$app.setEngagementID(O),R&&this.$app.setAgentID(R);var B=this.getProperty(e,Be)?this.getProperty(e,Be):R;t||(this.isQueued&&(this.isQueued=!1,this.addSystemMessage(this.$app.agentAvailable,Je)),this.$app.persistValue(u,Date.now())),this.updateMessagingTopBarStatus(D.isVirtualAgent()?xt:Tt,B),function(e){var t=e.getUIConfig().appStringProps;e.getUIConfig().appConfigProps.logDisclaimer&&!e.getRestoring()&&(t.disclaimerHeaderText&&e.getCIAPIInstance().sendDataPass({disclaimer:t.disclaimerHeaderText}),t.disclaimerFooterText&&e.getCIAPIInstance().sendDataPass({disclaimer:t.disclaimerFooterText}))}(this.$app);break;case de:var V=!1,N=this.getProperty(e,Me),H=this.getProperty(e,Pe);if(this.$app.isAsyncChat){H&&(H=H.trim());var F=e.getPropertyValueAsBoolean(qe);"true"!==this.getProperty(e,"conversation_resolved")?(this.$app.showAsyncChatExitMsg?this.addSystemMessage($i(this.$app.agentExitText,e.data)||H,Ze):this.$app.shoutui.getTranscriptEl().hideTyping(),F?(V=!0,this.disableFooter()):(this.$app.disableEmailButtonWhenAsync(),this.getProperty(e,_e)&&this.$app.reInitCIAPI())):(this.$app.showAsyncChatResolvedMsg?this.addSystemMessage($i(this.$app.agentResolvedText,e.data)||H,Ze):this.$app.shoutui.getTranscriptEl().hideTyping(),this.$app.agentResolved(),!this.$app.getCIAPIInstance().getChatParams().isCiEnabledOnResolve()||F?(this.disableFooter(),V=!0):this.$app.disableEmailButtonWhenAsync())}else this.addSystemMessage($i(this.$app.agentExitText,e.data)||H,Ze),V=!0,this.disableFooter();V&&this.handleInfoWidgetOnAgExit(t,N,n,i);break;case me:if(this.$app.showTransferInitiateMessage&&!t){var $=this.getProperty(e,Le).trim();this.addSystemMessage(this.$app.agentInitiateTransfer||$,et,!0)}break;case fe:if(this.$app.queuedMsgInAsync||!this.$app.isAsyncChat){var q=this.getProperty(e,xe),U=this.getProperty(e,Ue);if(this.$app.queueAsAgent&&q){var W=new Li({messageText:q,isAuto:!1,name:U,timestamp:n});W.setRestore(t),W.setAgentIndex(this.setAgentIndex(U)),this.$app.addToUI(W)}else this.addSystemMessage(q,Je,this.$app.persistQueueMessages);this.updateMessagingTopBarStatus(Et)}break;case ge:var G=this.getProperty(e,Pe).trim();if(this.confAgents.length>0){if(this.confAgents=this.confAgents.filter((function(e){return-1!==G.indexOf(e)})),1==this.confAgents.length)this.updateMessagingTopBarStatus(Tt,this.confAgents[0]),this.confAgents=[];else if(this.confAgents.length>1){var z=this.confAgents;this.confAgents=this.confAgents.slice(0,this.confAgents.length-1),this.updateMessagingTopBarStatus(jt,z[z.length-1])}}else this.getProperty(e,Oe)===m?this.$app.showTransferLostMessage&&this.addSystemMessage(this.$app.agentTransferLostText||G,it,!0):this.$app.showMemberLostMessage&&this.addSystemMessage(this.$app.agentLostText||G,it,!1);break;case ve:var Y=(this.getProperty(e,Le)||this.getProperty(e,Pe)).trim(),X=this.getProperty(e,Be)?this.getProperty(e,Be):this.getProperty(e,Ve),K=this.getProperty(e,Fe);this.getProperty(e,Oe)===f?this.addSystemMessage(Y,tt,!1):this.$app.showConferenceModeMessage&&this.getProperty(e,Oe)===p?(this.updateMessagingTopBarStatus(jt,X),this.addSystemMessage($i(this.$app.conferenceModeText,e.data)||Y,nt,!0)):this.$app.showTransferStatusMessage&&(this.updateMessagingTopBarStatus(this.$app.getCIAPIInstance().isVirtualAgent()?xt:Tt,X),this.addSystemMessage($i(this.$app.agentTransferStatusText,e.data)||Y,tt,!0)),bn.exists(C)&&bn.clear(C),K&&this.$app.setAgentID(K);break;case ye:if(this.$app.showNinaCoachStatusMessage){var J=this.getProperty(e,Pe).trim();this.addSystemMessage(this.$app.ninaCoachStatusText||J,nt,!0)}break;case pe:var Q=this.getProperty(e,De);this.addSystemMessage(this.$app.serviceNotAvailable||Q),this.disableFooter();break;case we:this.$app.getPrevConversation(!0);break;case ke:var Z=this.getProperty(e,He),ee=n,te=this.getProperty(e,Me)||this.getProperty(e,Be),ie=new Li({messageText:Z,name:te,timestamp:ee});ie.setAgentIndex(this.setAgentIndex(te)),this.$app.addToUI(ie);break;case Ce:var ne=this.getProperty(e,ze)||this.getProperty(e,He),se=Lt,Ie=Pt,je=ne&&ne.toLowerCase();!t&&je&&je.contains(se)?new En(this.$app).showFileUploadModal():je&&je.contains(Ie)&&new En(this.$app).hideFileUploadModal()}}},{key:"handleInfoWidgetOnAgExit",value:function(e,t,i,n){var s=this.$app.getUIConfig().agentExitWidgetJSON;s&&this.displayDataMessage(s,k,e,!1,t,i,n,!1,!1)}},{key:"getProperty",value:function(e,t){return e.getPropertyValue(t)}},{key:"processTypingMessages",value:function(e){var t,i="";switch(this.getProperty(e,je)){case"2":i=this.$app.typingMsg,t=ct;break;case"16":if(!this.$app.showStoppedTyping)return void this.$app.getRenderingEngine().deleteLastItem();i=this.$app.stoppedTypingMsg,t=ut}if(i){var n=new Li({bubbleType:Mi.TYPING_MESSAGE,messageText:i});n.setTypingState(t),this.$app.addToUI(n)}}},{key:"addSystemMessage",value:function(e,t,i){kn(this.$app,e,t,i)}},{key:"disableFooter",value:function(){this.$app.disableFooter(!0)}},{key:"isDataMsginHistoricHiddenLocked",value:function(e,t){return t||(e.lockView=void 0===e.historicLockView||e.historicLockView),t?e.receipt.historicHidden:e.historicHidden}},{key:"displayDataMessage",value:function(e,t,i,n,s,a,o,r,l){var c=r?e.receipt.widgetType:e.widgetType,u=!1;if(i&&l&&(u=this.isDataMsginHistoricHiddenLocked(e,r)),(!i||1==o||c==bt||e.displayInRestore)&&!u){var h=e.widgetAction||"optional";!h||h.startsWith("optional")||i&&!o||this.$app.disableFooter(!1);var d=(r?e.receipt.widgetView:e.widgetView)||Ct;if("bubble"==d){var p=new Li({bubbleType:r?Mi.CUSTOMER_MESSAGE:Mi.AGENT_MESSAGE,messageText:t,isAuto:n,name:s,timestamp:a});p.setRichData(e),e.customerAction=r,p.setRestore(i),p.setIsLast(o),l?this.$app.renderEngine.addNewItemToTop(p):this.$app.addToUI(p)}else if(d==Ct){var m=Mi.RICH_MESSAGE_OTHER;switch(c){case St:m=Mi.RICH_MESSAGE_QR;break;case wt:m=Mi.RICH_MESSAGE_CARD;break;case kt:m=Mi.RICH_MESSAGE_FORM;break;case bt:m=Mi.RICH_MESSAGE_RECEIPT}var f=new Li({bubbleType:m,messageText:t,isAuto:n,name:s,timestamp:a});f.setRichData(e),f.setIsLast(o),f.setRestore(i),f.setAgentIndex(this.setAgentIndex(s)),r&&!i&&e.receipt.widgetAction&&e.receipt.widgetAction.endsWith(I)?(e.customerAction=!0,this.$app.updateLastMessage(f)):(e.customerAction=r,l?this.$app.renderEngine.addNewItemToTop(f):this.$app.addToUI(f))}}else if(i&&(e.showMessageText||e.showMessageTextInRestore))return!1;return!0}},{key:"displayOpenerRichMessage",value:function(e,t,i,n,s){if(e.startsWith("{")&&e.endsWith("}"))try{var a=JSON.parse(Gi(e));return this.displayDataMessage(a,k,t,i,n,s,!1),!0}catch(e){}return!1}},{key:"getDataMessage",value:function(e){var t=this.getProperty(e,$e);if(t){var i=JSON.parse(t);return i.webRTCEvent?(this.handleWebRTCEvent(i.webRTCEvent),null):i.richWidget?i.richWidget:i}return null}},{key:"setAgentIndex",value:function(e){var t=this.agents.indexOf(e);return-1==t&&(this.agents.push(e),t=this.agents.length-1),t}},{key:"updateMessagingTopBarStatus",value:function(e,t){if(this.statusObj)switch(e){case Tt:this.$app.shoutui.updateStatus(t,this.statusObj.agentSubtext);break;case xt:this.$app.shoutui.updateStatus(t,this.statusObj.vaSubtext);break;case Et:this.$app.shoutui.updateStatus(this.statusObj.queueText,this.statusObj.queueSubText);break;case It:this.$app.shoutui.updateStatus(this.statusObj.disconnectText,this.statusObj.disconnectSubtext);break;case jt:0==this.confAgents.length&&this.confAgents.push(this.agents[this.agents.length-1]),this.$app.shoutui.updateStatus([this.confAgents.join(","),this.statusObj.conferenceConjunction||" and ",t].join(""),this.statusObj.conferenceSubText),this.confAgents.length>=1&&this.confAgents.push(t)}}},{key:"isDuplicateMessage",value:function(e,t,i){var n=this.$app.getRenderingEngine().getLastMsgOfType(i);return!!(n&&e<=n.getTimeStamp()&&n.getMessageText()===t)}},{key:"setWindowId",value:function(e){this.currentWindowId=e}},{key:"handleWebRTCEvent",value:function(e){var t,i,n=this,s=this.$app.shoutui.getLayoutEl(),a=this.$app.getRestoring(),o=this.$app.getPersistedValue(P,Ft),r=o==qt,l=this.$app.getPersistedValue(_,0);switch(e.name){case _t:if(a&&o!=Ft)o==$t&&this.showVideoContainer(s,e.data,!1);else{var c=s.displayVideoCallContainer(e.data);this.$app.getStateMgr().setState({state:ft}),this.$app.persistValue(P,Ft),e.data&&e.data.enabledCustomerCamera?this.$app.persistValue(_,D):e.data&&e.data.enableVoice?this.$app.persistValue(_,O):this.$app.persistValue(_,0),c.showPreCallView()}break;case Rt:r?(l==D?(e.data.enabledCustomerCamera=!0,e.data.enableVoice=!1):l==O?(e.data.enableVoice=!0,e.data.enabledCustomerCamera=!1):(e.data.enabledCustomerCamera=!1,e.data.enableVoice=!1),this.callReconnectTimer=setTimeout((function(){n.showVideoContainer(s,e.data,!0),n.showVideoCallView(s,e.data),n.callReconnectTimer=null}),1e3)):a||this.showVideoCallView(s,e.data);break;case Bt:r&&null!=this.callReconnectTimer&&(clearTimeout(this.callReconnectTimer),this.callReconnectTimer=null),a||s.getVideoContainer().getVideoCallView().endCall();break;case Nt:null!==(t=s.getVideoContainer())&&void 0!==t&&t.getVideoCallView()&&s.getVideoContainer().getVideoCallView().showCallTransferState();break;case Vt:null!==(i=s.getVideoContainer())&&void 0!==i&&i.getVideoCallView()&&s.getVideoContainer().getVideoCallView().hideCallTransferState()}}},{key:"showVideoContainer",value:function(e,t,i){e.displayVideoCallContainer(t,i).showVideoCallView()}},{key:"showVideoCallView",value:function(e,t){e.getVideoContainer().getVideoCallView().startCall(t)}}]),e}();function jn(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return new Promise((function(t,n){e.apply(void 0,i.concat([function(e){t(e)},function(e){n(e)}]))}))}var An=function(){function e(){a()(this,e),this.messages=[]}return r()(e,[{key:"add",value:function(e){e instanceof Li&&(this.messages.push(e),this.onItemAdded(this.messages.length-1))}},{key:"getMessages",value:function(){return this.messages}},{key:"size",value:function(){return this.messages.length}},{key:"get",value:function(e){return this.messages.length>e?this.messages[e]:null}},{key:"hasMessages",value:function(){return this.messages.length>0}},{key:"set",value:function(e,t){return t instanceof Li?this.messages.length>e?(this.messages.splice(e,0,t),this.onItemSet(e,t),e):(this.messages.push(t),this.onItemAdded(this.messages.length-1),this.messages.length):null}},{key:"update",value:function(e,t){t instanceof Li&&this.messages.length>e&&(this.messages[e]=t,this.onItemReload(e,t))}},{key:"delete",value:function(e){if(this.messages.length>e){var t=this.messages.splice(e,1);this.onItemDeleted(t)}}}]),e}(),Mn=i(4),Ln=i.n(Mn);function Pn(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function _n(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Pn(Object(i),!0).forEach((function(t){Ln()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Pn(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Dn=function(e){return e.replace(/[-_\s+]([a-z])/g,(function(e){return e[1].toUpperCase()}))},On=function(e){return e?Object.keys(e).map((function(t){return"".concat((i=t,i.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()),": ").concat(e[t],";");var i})).join(" "):" "},Rn=function(e,t,i){for(var n=e,s=t.split(".");s.length;){var a=s.shift();n[a]=s.length?n[a]?n[a]:{}:i,n=n[a]}},Bn=function(e,t){return t.split(".").reduce((function(e,t){return e&&e[t]}),e)},Vn=function(e){return"function"==typeof e},Nn=function(e,t){return e&&Vn(e[t])},Hn=function(e){return window.getComputedStyle(e)},Fn=function(e){return(new DOMParser).parseFromString(e,"text/html").body},$n=[["&lt;","<"],["&gt;",">"],["&amp;","&"],["&nbsp;"," "]],qn=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object.freeze(Array.from(e.attributes).map((function(e){return Ln()({},t?Dn(e.name):e.name,e.value)})).reduce((function(e,t){return _n(_n({},e),t)}),{}))},Un=function(e,t){var i=!1,n=!1,s=new WeakMap,a={get:function(e,t,i){if("#"===t)return e;var n=Reflect.get(e,t,i);if(function(e){return null===e||!["function","object"].includes(bi()(e))}(n)||"constructor"===t)return n;var o=function(e,t){var i=s.get(e);if(i)return i;i=new Map,s.set(e,i);var n=i.get(t);return n||(n=Reflect.getOwnPropertyDescriptor(e,t),i.set(t,n)),n}(e,t);if(o&&!o.configurable){if(o.set&&!o.get)return;if(!1===o.writable)return n}return new Proxy(n,a)},set:function(e,s,a,o){a&&void 0!==a["#"]&&(a=a["#"]);var r=Reflect.get(e,s,o),l=Reflect.set(e,s,a);return r!==a&&(i?n||(n=!0):t()),l},apply:function(e,s,a){if(!i){i=!0;var o=Reflect.apply(e,s,a);return n&&t(),i=n=!1,o}return Reflect.apply(e,s,a)}};return new Proxy(e,a)};function Wn(e){if(null===e||"object"!==bi()(e))return e;var t=e.constructor();for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=Gn(e[i]));return t}var Gn=function(e){return function e(t){return null===t||"object"!==bi()(t)?t:(Object.keys(t).forEach((function(i){var n=t[i];null!==n&&"object"===bi()(n)&&e(n)})),Object.freeze(t))}(Wn(e))},zn=function(){function e(t){a()(this,e),this.$app=t;var i=this.$app.ariaStrings||{};this.opensNewWindow={text:i.opensNewWindow,img:"external_link.png"};var n=this.$app.getUIConfig().transcriptConfig||{};n.opensNewWindowImageConfig&&(this.opensNewWindow.img=n.opensNewWindowImageConfig.imgName),this.richAriaTypeToTextMap={QuickReplyButton:this.$app.ariaStrings.quickReplyReader,CardDeck:this.$app.ariaStrings.cardDeckReader}}return r()(e,[{key:"injectAttributes",value:function(e){return e=this.htmlTargetLinksInjectLabelAndIcon(e)}},{key:"htmlTargetLinksInjectLabelAndIcon",value:function(e){var t=this;if("string"!=typeof e||0===e.trim().length)return e;var i=Fn(Gi(e));i.childElementCount>0&&i.querySelectorAll("a[target='_blank'], a[target='_new']").forEach((function(e,i){var n=e.getAttribute("title");if(!n||-1==n.indexOf(t.opensNewWindow.text)){e.setAttribute("title",(n?"".concat(n," — "):"")+t.opensNewWindow.text);var s=document.createElement("img");s.classList.add("opensNewWindow"),s.src=t.$app.getImagePath()+t.opensNewWindow.img,e.appendChild(s)}}));return i.innerHTML}},{key:"formatRichAriaOutputsToTextList",value:function(e){var t=[];for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];n.text&&(n.type&&n.length>0&&this.richAriaTypeToTextMap[n.type]&&t.push(this.richAriaTypeToTextMap[n.type].replace("{total}",n.length)),t.push(n.text))}return t}},{key:"announceRichDataMessage",value:function(e){for(var t=this.formatRichAriaOutputsToTextList(e),i=0;i<t.length;i++)this.$app.getStateMgr().setState({ariaReaderSay:t[i]},!0)}},{key:"announceBubbleText",value:function(e,t){if(e){var i=e;""!==i&&i!==k&&(t&&(i="".concat(t," — ").concat(i)),this.$app.getStateMgr().setState({ariaReaderSay:i}))}}}]),e}();function Yn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=vi()(e);if(t){var s=vi()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return fi()(this,i)}}var Xn=function(e){pi()(i,e);var t=Yn(i);function i(e){var n;return a()(this,i),(n=t.call(this)).$app=e,n.groupMsg=e.enableMsgGrouping,n.ariaUtil=new zn(e),n}return r()(i,[{key:"addNewItem",value:function(e){if(e.getMessageText()){var t,i;if(e.setMessageText(this.ariaUtil.injectAttributes(e.getMessageText())),this.hasMessages()&&(t=(i=this.messages[this.messages.length-1]).getMessageBubble()),i&&i.getRichData()){var n=e.getRichData();if(n){var s=n.customerAction?n.receipt.widgetAction:n.widgetAction;if(s&&s.endsWith(I)&&(e.getMessageBubble()===Mi.CUSTOMER_MESSAGE||e.getMessageBubble()===Mi.RICH_MESSAGE_RECEIPT))this.delete(this.messages.length-1),e.getMessageBubble()===Mi.CUSTOMER_MESSAGE&&this.groupPreviousMsg(e),i.getRichInstance().clearAll(),i.setRichInstance(null);else if(n.widgetView==Ct)return void this.add(e)}}else if(t===Mi.TYPING_MESSAGE){if(e.getMessageBubble()===Mi.TYPING_MESSAGE)return void this.update(this.messages.length-1,e);this.messages.splice(this.messages.length-1,1),this.transcriptArea.hideTyping(),e.getMessageBubble()!==Mi.SYSTEM_MESSAGE&&this.groupPreviousMsg(e)}else if(t===Mi.SYSTEM_MESSAGE&&!i.getPersistInTranscriptState()){if(e.getMessageBubble()===Mi.SYSTEM_MESSAGE)return void this.update(this.messages.length-1,e);this.delete(this.messages.length-1),this.groupPreviousMsg(e)}if(e.getMessageBubble()===Mi.TYPING_MESSAGE){if(e.getInternalState()==ut)return}else t===Mi.SYSTEM_MESSAGE||e.getMessageBubble()===Mi.RICH_MESSAGE_RECEIPT||this.groupMsg&&t&&t===e.getMessageBubble()&&this.messages[this.messages.length-1].setSamePreviousType(!0);this.add(e)}}},{key:"addNewItemToTop",value:function(e){if(e.getMessageText()){var t,i;if(e.setMessageText(this.ariaUtil.injectAttributes(e.getMessageText())),this.hasMessages()&&(t=(i=this.messages[0]).getMessageBubble()),i&&i.getRichData())if(e.getRichData()&&i.getRichData().customerAction&&e.getMessageBubble()!=Mi.RICH_MESSAGE_RECEIPT){var n=i.getRichData().receipt.widgetAction;if(n&&n.endsWith(I))return}e.getMessageBubble()===Mi.RICH_MESSAGE_RECEIPT||this.groupMsg&&t===e.getMessageBubble()&&e.setSamePreviousType(!0),this.set(0,e)}}},{key:"groupPreviousMsg",value:function(e){this.groupMsg&&this.messages.length>=1&&this.messages[this.messages.length-1].getMessageBubble()===e.getMessageBubble()&&this.messages[this.messages.length-1].setSamePreviousType(!0)}},{key:"deleteLastItem",value:function(){this.delete(this.messages.length-1)}},{key:"onItemAdded",value:function(e){this.transcriptArea||(this.transcriptArea=this.$app.shoutui.getTranscriptEl()),this.transcriptArea.renderMessageBubbles(this.messages[e],!!this.groupMsg&&(e>0&&this.messages[e-1].isSamePreviousType()))}},{key:"onItemSet",value:function(e,t){this.transcriptArea||(this.transcriptArea=this.$app.shoutui.getTranscriptEl()),0===e&&this.transcriptArea.renderMessageBubbleToTop(t,!!this.groupMsg&&t.isSamePreviousType())}},{key:"onItemDeleted",value:function(e){this.transcriptArea.deleteMessageBubbles(e)}},{key:"onItemReload",value:function(e,t){t.setMessageText(this.ariaUtil.injectAttributes(t.getMessageText())),this.transcriptArea.reloadMessageBubbles(e,t)}},{key:"getLastMsgOfType",value:function(e){for(var t=this.messages.length-1;t>=0;t--)if(e==this.messages[t].getMessageBubble())return this.messages[t]}},{key:"toggleLoadingMsg",value:function(e,t){this.transcriptArea||(this.transcriptArea=this.$app.shoutui.getTranscriptEl()),this.transcriptArea.toggleLoadingMessage(e,t)}}]),i}(An),Kn={CALL_STATE:"cls",VIDEO_AUDIO_CALL_INVITATION:"voc",CALL_STATE_VIDEO_INVITE:1,CALL_STATE_VOICE_INVITE:2,ROOM_JOINED:"joined",RTC_ERROR:"error",UNREAD_COUNT:"urc",AGENT_VIDEO_ERROR:"agentVideoError",AGENT_VIDEO_PUBISHED:"agentVideoPublished",LOCAL_AUDIO_ERROR:"localAudioError",LOCAL_VIDEO_ERROR:"localVideoError",CUSTOMER_VIDEO_PUBISHED:"localVideoPublished",ENABLED_CUSTOMER_CAMERA:"customerCameraEnabled",ENABLED_VOICE_ONLY_CALL:"voiceOnlyCall",END_CALL_BUTTON_TEXT:"Switch to Chat",CALL_ERROR_TEXT:"An error occurred during joining audio or video call, please try again later.",UNSUPPORTED_DEVICE_TEXT:"You may have selected an unsupported audio or video source, please select an appropriate media source from device settings.",AGENT_ALIAS_TEXT:"A",CALL_TRANSFER_TEXT:"Transferring to agent ...",VIDEO_CALL_HEADING:"Connect with us over video",VOICE_ONLY_CALL_HEADING:"Connect with us over voice-only",VIDEO_CALL_DEVICE_SETTINGS_FINAL_TEXT:"Great! you should be all ready to share your video and audio with our agent. Click the button below when you're ready to chat.",VOICE_ONLY_CALL_DEVICE_SETTINGS_FINAL_TEXT:"Great! you should be all ready to share your audio with our agent. Click the button below when you're ready to chat.",VIDEO_CALL_CHECK_DEVICES_BUTTON_TEXT:"Check Audio & Video settings",VOICE_ONLY_CALL_CHECK_DEVICES_TEXT:"Check Audio settings",VIDEO_CALL_START_BUTTON_TEXT:"Start Video Call",VOICE_ONLY_CALL_START_BUTTON_TEXT:"Start Voice Call",PRE_VIDEO_CALL_PRIMARY_TEXT:"For the best video call experience, let's check your camera and audio settings before connecting.",PRE_VOICE_CALL_PRIMARY_TEXT:"For the best voice call experience, let's check your audio settings before connecting.",PRE_VIDEO_CALL_SECONDARY_TEXT:"If this your first time joining from this computer, your browser will ask permission to access the camera and microphone.",PRE_VOICE_CALL_SECONDARY_TEXT:"If this your first time joining from this computer, your browser will ask permission to access the microphone.",VIDEO_CALL_DEVICE_SETTINGS_PRIMARY_TEXT:"After allowing your browser to access devices (via the browser pop-up), check your settings below.",VOICE_CALL_DEVICE_SETTINGS_PRIMARY_TEXT:"After allowing your browser to access devices (via the browser pop-up), check your settings below.",VIDEO_CALL_DEVICE_SETTINGS_SECONDARY_TEXT:'If you didn\'t get the browser pop-up and/or can\'t see your camera view in the box below,\n        <a href="https://www.nuance.com/about-us/company-policies/privacy-policies.html" target="_new">try these steps</a>.',VOICE_CALL_DEVICE_SETTINGS_SECONDARY_TEXT:'If you didn\'t get the browser pop-up and/or can\'t see your microphone in the box below,\n        <a href="https://www.nuance.com/about-us/company-policies/privacy-policies.html" target="_new">try these steps</a>.',BROWSER_SETTINGS_POPUP_TEXT:"Allow this site to use your camera and microphone ?",DISCLAIIMER_TEXT:'Your call may be monitored and recorded for quality purposes. By initiating call with us you are agreeing to our <a href="https://www.nuance.com/about-us/company-policies/privacy-policies.html" target="_new">Terms & Conditions</a>.'},Jn="VoiceVideoAgentOnly",Qn="VoiceVideo2way",Zn="Voice",es="chat.dvvOfferAccepted",ts="chat.dvvOfferDeclined",is="chat.dvvCustomerFailed",ns=i(16),ss={el:"#si-app",template:i.n(ns).a,refId:"messaging-ui",created:function(){this.layoutEl=this.el.firstElementChild,this.$app.getCIAPIInstance().isPersistentWindow()&&this.layoutEl.classList.add("persistent-box")},onKeyDown:function(e){this.$app.handleAccessKeyPress(e)},displayVideoCallContainer:function(e,t){this.videoContainer&&this.layoutEl.removeChild(this.videoContainer),this.videoContainer=document.createElement("video-container-view");var i=!(!e||!e.enabledCustomerCamera);return e&&(this.videoContainer.setAttribute("videoEnabled",e.isVideoEnabled),this.videoContainer.setAttribute(q,i),this.videoContainer.setAttribute("reconnect",t),e.enableVoice&&this.videoContainer.setAttribute(U,e.enableVoice)),this.layoutEl.append(this.videoContainer),this.videoContainer},removeVideoCallContainer:function(e){if(this.videoContainer&&(this.layoutEl.removeChild(this.videoContainer),this.videoContainer=null),void 0!==e){var t=parseInt(this.$app.getPersistedValue(_,0),10),i=Jn;t===D?i=Qn:t===O&&(i=Zn),this.$app.logWebRTCEvents(e,i)}this.$app.removePersistedValueByKey(_),this.$app.getStateMgr().setState({state:pt})},getVideoContainer:function(){return this.videoContainer},showCloseModal:function(){this.setModalVisible();var e=document.createElement("close-modal-view");this.layoutEl.appendChild(e),En.setFocusWithinModalWindow(e)},showEmailModal:function(){this.setModalVisible();var e=document.createElement("email-modal-view");this.layoutEl.appendChild(e),En.setFocusWithinModalWindow(e)},showInfoModalView:function(e){this.setModalVisible();var t=document.createElement("info-modal-view");this.layoutEl.appendChild(t),this.setInfoModalBodyContent(e),En.setFocusWithinModalWindow(t)},setInfoModalBodyContent:function(e){var t=document.querySelector("info-modal-view .modal-body"),i=document.createElement("div");i.innerHTML=e,t.appendChild(i)},showFileUploadModal:function(){this.setModalVisible();var e=document.createElement("file-upload-modal-view");this.layoutEl.appendChild(e),En.setFocusWithinModalWindow(e)},hideFileUploadModal:function(){var e=document.querySelector("file-upload-modal-view");e&&this.layoutEl.removeChild(e)},onLayoutClick:function(e){Ti.publish("Layout.onClick",e)},setSurveyVisibility:function(e){this.$app.shoutui.resetTopBar(),this.data.survey=e},renderSurvey:function(){var e=this;return this.$app.getUIConfig().pcsID&&this.$app.isPreChatSurveyNeed()?(this.data.survey=!0,this.surveyEl=this.layoutEl.querySelector("survey-view"),this.surveyEl.render().then((function(e){return e&&e.webrtc,Promise.resolve(e)})).then((function(t){return e.setSurveyVisibility(!1),t}))):Promise.resolve()},renderPostChatSurvey:function(e,t,i){this.data.survey=!0,this.surveyEl=this.layoutEl.querySelector("survey-view"),this.surveyEl.renderPostChatSurvey(e,t,i)},invokeSurveyClose:function(){this.data.survey&&this.surveyEl.closeChat()}},as=i(17),os=i.n(as),rs=i(18),ls=["type"],cs={tagName:"messaging-top-bar",template:i.n(rs).a,created:function(){this.topBarEL=this.el.firstChild,this.leftBar=this.topBarEL.querySelector(".top-bar-left");var e=this.$app.getBridge();e&&e.addDrag(this.topBarEL)},hideMaterial:function(){var e=this,t=this.topBarEL.querySelector(".top-bar-material-container");window.raf((function(){t&&(t.style.opacity=0,e.topBarEL.classList.remove("top-bar-material"),bn.set((function(){t.style.display="none",e.topBarEL.classList.remove("messaging-top-bar-material"),e.config.materialBarItems.forEach((function(t){"Logo"===t.type&&e.updateLogo(t)}))}),e.matHideDelay))}))},updateLogo:function(e){var t=this;window.raf((function(){var i=t.leftBar.querySelector("[type='Logo']");i||((i=document.createElement("topbar-element")).setAttribute("type","Logo"),t.leftBar.insertBefore(i,t.leftBar.firstChild)),i.udpateBackground(e)}))},updateTitle:function(e){var t=this;window.raf((function(){var i=t.leftBar.querySelector("[type='Title']");i||((i=document.createElement("topbar-element")).setAttribute("type","Title"),t.leftBar.appendChild(i)),i.updateTitle(e)}))},updateStatus:function(e,t){var i=this;window.raf((function(){var n=i.leftBar.querySelector("[type='Status']");n&&n.updateStatus(e,t)}))},findItems:function(){var e;this.items||(this.items=Oi()(this.topBarEL.querySelectorAll("overflow-item")),(e=this.items).push.apply(e,Oi()(this.topBarEL.querySelectorAll("topbar-element"))))},toggleFullScreen:function(e){this.findItems(),this.items.forEach((function(t){t.getAttribute("mode")===T&&t.toggleFullScreenMode(e)}))},onIconClick:function(e){void 0!==e.currentTarget.onIconClick&&e.currentTarget.onIconClick(e)}},us=function(e){var t=e.getUIConfig();if(cs.$app=e,t.topBarConfig){var i=t.topBarConfig;cs.constants={contStyle:i.topBarContainerStyles,barStyle:i.topBarStyles,extendStyle:i.extendedTopBarStyles,extendItemStyle:i.extendedTopBarItemStyles,config:i.topBarSettings||{},topBarIconStyle:i.iconStyles,matHideDelay:i.topBarMaterialHideDelay||1e3,dragMode:t.appConfigProps.dragMode};var n=cs.constants.config;t.overFlowMenus&&t.overFlowMenus.forEach((function(e){var t=e.position,i=e.items,s=e.menuStyle;"TopBarLeft"==t?(n.leftOverFlowItems=i,cs.constants.leftOverFlowMenuStyle=s):"TopBarRight"==t&&(n.rightOverFlowItems=i,cs.constants.rightOverFlowMenuStyle=s)})),e.getCIAPIInstance().isPersistentWindow()&&(n.leftOverFlowItems?n.leftOverFlowItems=hs(n.leftOverFlowItems):n.rightOverFlowItems&&(n.rightOverFlowItems=hs(n.rightOverFlowItems)),n.leftTopBarItems&&(n.leftTopBarItems=hs(n.leftTopBarItems)),n.centerTopBarItems&&(n.centerTopBarItems=hs(n.centerTopBarItems)),n.rightTopBarItems&&(n.rightTopBarItems=hs(n.rightTopBarItems)),n.extendedTopBarItems&&(n.extendedTopBarItems=hs(n.extendedTopBarItems))),n.leftTopBarItems&&n.leftTopBarItems.forEach((function(t){var i=t.type,n=os()(t,ls);"Status"==i&&(e.statusItems=n)}))}return cs};function hs(e){return e.filter((function(e){return"Minimize"!==e.type}))}var ds=i(19),ps=i.n(ds),ms=[];for(var fs in Ri()&&(document.addEventListener("touchstart",{}),ms.push("touchstart"),ms.push("touchend")),document){fs.startsWith("on")&&(null===document[fs]||Vn(document[fs]))&&ms.push(fs.substring(2))}var gs=function(e){return"ld-on-".concat(e)};function vs(e,t){function i(e){Array.from(e.querySelectorAll("[".concat("ld--elist","]"))).map((function(e){var i=e.getAttribute("ld--elist")||"";e.setAttribute("ld--elist",""),i.split(",").filter((function(e){return e})).map((function(i){var n=e.getAttribute(gs(i));t[n]&&(e["on".concat(i)]=function(e){t[n].call(t,e)})}))}))}Array.from(e.querySelectorAll("[ld--bind]")).map((function(e){var i=Bn(t.data,e.getAttribute("ld--bind"));try{"INPUT"===e.tagName&&["radio","checkbox"].includes(e.type)?i.includes(e.value)&&(e.checked=!0):e.value=i}catch(e){}}));var n=new MutationObserver((function(e){Oi()(e).filter((function(e){return e.addedNodes.length>0})).map((function(e){return e.target})).map((function(e){return i(e)}))}));return n.observe(e,{attributes:!0,childList:!0,subtree:!0}),i(e),n}function ys(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function bs(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ys(Object(i),!0).forEach((function(t){Ln()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ys(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Ss=function(e,t){return Array.from(e.childNodes).filter((function(e){return t(e)})).map((function(e){return Ln()({},t(e),e)})).reduce((function(e,t){return bs(bs({},e),t)}),{})},ws=function(e){return e instanceof HTMLElement&&e.hasAttribute("ref-key")?e.getAttribute("ref-key"):e.id};var ks=function(e){return":".concat(e)},Cs=function(e,t){return e.hasAttribute(ks(t))},Ts=function(e,t){return e.getAttribute(ks(t))},xs=function(e,t){return Array.from(e.querySelectorAll("[\\".concat(ks(t),"]")))},Es=function(e,t){return e.removeAttribute(ks(t))},Is=function(e,t){return e.insertAdjacentText("beforebegin",t)},js=function(e,t){return e.insertAdjacentText("afterend",t)},As=function(e,t,i){Is(e,t),js(e,i)};var Ms={_if:function(e,t,i){Es(e,i),Is(e,"${".concat(t," ? "));var n=e.nextElementSibling;n&&Cs(n,"else")?(As(e,"`","`"),Es(n,"else"),As(n,":`","`}")):As(e,"`","`:``}")},_for:function(e,t,i){var n=/(.*)\s+(in)\s+(.*)$/.exec(t);if(4===n.length){var s=n[1].replace("(","").replace(")",""),a=n[3];As(e,"${".concat(a,".map(function(").concat(s,") { return `"),"`}.bind(this)).join('')}"),Es(e,i)}},_class:function(e,t,i){var n=t.split(";").map((function(e){return e.split(":",2).map((function(e){return e.trim()}))})).map((function(e){return"${".concat(e[1]," ? '").concat(e[0],"': ''}")})).join(" "),s=e.getAttribute("class")||""+" ".concat(n);e.setAttribute("class",s),Es(e,i)},_key:function(e,t,i){e.setAttribute("ref-key",t),Es(e,i)},_style:function(e,t,i){var n=e.getAttribute("style")||"",s="${function() { return this.__$objToStyleMap(".concat(t,");}.call(this)}");e.setAttribute("style",(n?"".concat(n,"; "):"")+s),Es(e,i)},parseLit:function(e){return function(t){return new Function("return `".concat(e,"`")).call(t)}}},Ls=i(0);function Ps(e,t){return t=null==t?e.length-1:+t,function(){for(var i=Math.max(arguments.length-t,0),n=Array(i),s=0;s<i;s++)n[s]=arguments[s+t];switch(t){case 0:return e.call(this,n);case 1:return e.call(this,arguments[0],n);case 2:return e.call(this,arguments[0],arguments[1],n)}var a=Array(t+1);for(s=0;s<t;s++)a[s]=arguments[s];return a[t]=n,e.apply(this,a)}}function _s(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function Ds(e){return null===e}function Os(e){return void 0===e}function Rs(e){return!0===e||!1===e||"[object Boolean]"===Ls.t.call(e)}function Bs(e){return!(!e||1!==e.nodeType)}function Vs(e){var t="[object "+e+"]";return function(e){return Ls.t.call(e)===t}}var Ns=Vs("String"),Hs=Vs("Number"),Fs=Vs("Date"),$s=Vs("RegExp"),qs=Vs("Error"),Us=Vs("Symbol"),Ws=Vs("ArrayBuffer"),Gs=Vs("Function"),zs=Ls.p.document&&Ls.p.document.childNodes;"object"!=typeof Int8Array&&"function"!=typeof zs&&(Gs=function(e){return"function"==typeof e||!1});var Ys=Gs,Xs=Vs("Object"),Ks=Ls.s&&Xs(new DataView(new ArrayBuffer(8))),Js="undefined"!=typeof Map&&Xs(new Map),Qs=Vs("DataView");var Zs=Ks?function(e){return null!=e&&Ys(e.getInt8)&&Ws(e.buffer)}:Qs,ea=Ls.k||Vs("Array");function ta(e,t){return null!=e&&Ls.i.call(e,t)}var ia=Vs("Arguments");!function(){ia(arguments)||(ia=function(e){return ta(e,"callee")})}();var na=ia;function sa(e){return!Us(e)&&Object(Ls.f)(e)&&!isNaN(parseFloat(e))}function aa(e){return Hs(e)&&Object(Ls.g)(e)}function oa(e){return function(){return e}}function ra(e){return function(t){var i=e(t);return"number"==typeof i&&i>=0&&i<=Ls.b}}function la(e){return function(t){return null==t?void 0:t[e]}}var ca=la("byteLength"),ua=ra(ca),ha=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var da=Ls.r?function(e){return Ls.l?Object(Ls.l)(e)&&!Zs(e):ua(e)&&ha.test(Ls.t.call(e))}:oa(!1),pa=la("length");function ma(e,t){t=function(e){for(var t={},i=e.length,n=0;n<i;++n)t[e[n]]=!0;return{contains:function(e){return t[e]},push:function(i){return t[i]=!0,e.push(i)}}}(t);var i=Ls.n.length,n=e.constructor,s=Ys(n)&&n.prototype||Ls.c,a="constructor";for(ta(e,a)&&!t.contains(a)&&t.push(a);i--;)(a=Ls.n[i])in e&&e[a]!==s[a]&&!t.contains(a)&&t.push(a)}function fa(e){if(!_s(e))return[];if(Ls.m)return Object(Ls.m)(e);var t=[];for(var i in e)ta(e,i)&&t.push(i);return Ls.h&&ma(e,t),t}function ga(e){if(null==e)return!0;var t=pa(e);return"number"==typeof t&&(ea(e)||Ns(e)||na(e))?0===t:0===pa(fa(e))}function va(e,t){var i=fa(t),n=i.length;if(null==e)return!n;for(var s=Object(e),a=0;a<n;a++){var o=i[a];if(t[o]!==s[o]||!(o in s))return!1}return!0}function ya(e){return e instanceof ya?e:this instanceof ya?void(this._wrapped=e):new ya(e)}function ba(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,ca(e))}ya.VERSION=Ls.e,ya.prototype.value=function(){return this._wrapped},ya.prototype.valueOf=ya.prototype.toJSON=ya.prototype.value,ya.prototype.toString=function(){return String(this._wrapped)};function Sa(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var s=typeof e;return("function"===s||"object"===s||"object"==typeof t)&&function e(t,i,n,s){t instanceof ya&&(t=t._wrapped);i instanceof ya&&(i=i._wrapped);var a=Ls.t.call(t);if(a!==Ls.t.call(i))return!1;if(Ks&&"[object Object]"==a&&Zs(t)){if(!Zs(i))return!1;a="[object DataView]"}switch(a){case"[object RegExp]":case"[object String]":return""+t==""+i;case"[object Number]":return+t!=+t?+i!=+i:0==+t?1/+t==1/i:+t==+i;case"[object Date]":case"[object Boolean]":return+t==+i;case"[object Symbol]":return Ls.d.valueOf.call(t)===Ls.d.valueOf.call(i);case"[object ArrayBuffer]":case"[object DataView]":return e(ba(t),ba(i),n,s)}var o="[object Array]"===a;if(!o&&da(t)){if(ca(t)!==ca(i))return!1;if(t.buffer===i.buffer&&t.byteOffset===i.byteOffset)return!0;o=!0}if(!o){if("object"!=typeof t||"object"!=typeof i)return!1;var r=t.constructor,l=i.constructor;if(r!==l&&!(Ys(r)&&r instanceof r&&Ys(l)&&l instanceof l)&&"constructor"in t&&"constructor"in i)return!1}s=s||[];var c=(n=n||[]).length;for(;c--;)if(n[c]===t)return s[c]===i;if(n.push(t),s.push(i),o){if((c=t.length)!==i.length)return!1;for(;c--;)if(!Sa(t[c],i[c],n,s))return!1}else{var u,h=fa(t);if(c=h.length,fa(i).length!==c)return!1;for(;c--;)if(u=h[c],!ta(i,u)||!Sa(t[u],i[u],n,s))return!1}return n.pop(),s.pop(),!0}(e,t,i,n)}function wa(e,t){return Sa(e,t)}function ka(e){if(!_s(e))return[];var t=[];for(var i in e)t.push(i);return Ls.h&&ma(e,t),t}function Ca(e){var t=pa(e);return function(i){if(null==i)return!1;var n=ka(i);if(pa(n))return!1;for(var s=0;s<t;s++)if(!Ys(i[e[s]]))return!1;return e!==ja||!Ys(i[Ta])}}var Ta="forEach",xa=["clear","delete"],Ea=["get","has","set"],Ia=xa.concat(Ta,Ea),ja=xa.concat(Ea),Aa=["add"].concat(xa,Ta,"has"),Ma=Js?Ca(Ia):Vs("Map"),La=Js?Ca(ja):Vs("WeakMap"),Pa=Js?Ca(Aa):Vs("Set"),_a=Vs("WeakSet");function Da(e){for(var t=fa(e),i=t.length,n=Array(i),s=0;s<i;s++)n[s]=e[t[s]];return n}function Oa(e){for(var t=fa(e),i=t.length,n=Array(i),s=0;s<i;s++)n[s]=[t[s],e[t[s]]];return n}function Ra(e){for(var t={},i=fa(e),n=0,s=i.length;n<s;n++)t[e[i[n]]]=i[n];return t}function Ba(e){var t=[];for(var i in e)Ys(e[i])&&t.push(i);return t.sort()}function Va(e,t){return function(i){var n=arguments.length;if(t&&(i=Object(i)),n<2||null==i)return i;for(var s=1;s<n;s++)for(var a=arguments[s],o=e(a),r=o.length,l=0;l<r;l++){var c=o[l];t&&void 0!==i[c]||(i[c]=a[c])}return i}}var Na=Va(ka),Ha=Va(fa),Fa=Va(ka,!0);function $a(e){if(!_s(e))return{};if(Ls.j)return Object(Ls.j)(e);var t=function(){};t.prototype=e;var i=new t;return t.prototype=null,i}function qa(e,t){var i=$a(e);return t&&Ha(i,t),i}function Ua(e){return _s(e)?ea(e)?e.slice():Na({},e):e}function Wa(e,t){return t(e),e}function Ga(e){return ea(e)?e:[e]}function za(e){return ya.toPath(e)}function Ya(e,t){for(var i=t.length,n=0;n<i;n++){if(null==e)return;e=e[t[n]]}return i?e:void 0}function Xa(e,t,i){var n=Ya(e,za(t));return Os(n)?i:n}function Ka(e,t){for(var i=(t=za(t)).length,n=0;n<i;n++){var s=t[n];if(!ta(e,s))return!1;e=e[s]}return!!i}function Ja(e){return e}function Qa(e){return e=Ha({},e),function(t){return va(t,e)}}function Za(e){return e=za(e),function(t){return Ya(t,e)}}function eo(e,t,i){if(void 0===t)return e;switch(null==i?3:i){case 1:return function(i){return e.call(t,i)};case 3:return function(i,n,s){return e.call(t,i,n,s)};case 4:return function(i,n,s,a){return e.call(t,i,n,s,a)}}return function(){return e.apply(t,arguments)}}function to(e,t,i){return null==e?Ja:Ys(e)?eo(e,t,i):_s(e)&&!ea(e)?Qa(e):Za(e)}function io(e,t){return to(e,t,1/0)}function no(e,t,i){return ya.iteratee!==io?ya.iteratee(e,t):to(e,t,i)}function so(e,t,i){t=no(t,i);for(var n=fa(e),s=n.length,a={},o=0;o<s;o++){var r=n[o];a[r]=t(e[r],r,e)}return a}function ao(){}function oo(e){return null==e?ao:function(t){return Xa(e,t)}}function ro(e,t,i){var n=Array(Math.max(0,e));t=eo(t,i,1);for(var s=0;s<e;s++)n[s]=t(s);return n}function lo(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}ya.toPath=Ga,ya.iteratee=io;var co=Date.now||function(){return(new Date).getTime()};function uo(e){var t=function(t){return e[t]},i="(?:"+fa(e).join("|")+")",n=RegExp(i),s=RegExp(i,"g");return function(e){return e=null==e?"":""+e,n.test(e)?e.replace(s,t):e}}var ho={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},po=uo(ho),mo=uo(Ra(ho)),fo=ya.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},go=/(.)^/,vo={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},yo=/\\|'|\r|\n|\u2028|\u2029/g;function bo(e){return"\\"+vo[e]}function So(e,t,i){!t&&i&&(t=i),t=Fa({},t,ya.templateSettings);var n,s=RegExp([(t.escape||go).source,(t.interpolate||go).source,(t.evaluate||go).source].join("|")+"|$","g"),a=0,o="__p+='";e.replace(s,(function(t,i,n,s,r){return o+=e.slice(a,r).replace(yo,bo),a=r+t.length,i?o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?o+="'+\n((__t=("+n+"))==null?'':__t)+\n'":s&&(o+="';\n"+s+"\n__p+='"),t})),o+="';\n",t.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{n=new Function(t.variable||"obj","_",o)}catch(e){throw e.source=o,e}var r=function(e){return n.call(this,e,ya)},l=t.variable||"obj";return r.source="function("+l+"){\n"+o+"}",r}function wo(e,t,i){var n=(t=za(t)).length;if(!n)return Ys(i)?i.call(e):i;for(var s=0;s<n;s++){var a=null==e?void 0:e[t[s]];void 0===a&&(a=i,s=n),e=Ys(a)?a.call(e):a}return e}var ko=0;function Co(e){var t=++ko+"";return e?e+t:t}function To(e){var t=ya(e);return t._chain=!0,t}function xo(e,t,i,n,s){if(!(n instanceof t))return e.apply(i,s);var a=$a(e.prototype),o=e.apply(a,s);return _s(o)?o:a}var Eo=Ps((function(e,t){var i=Eo.placeholder,n=function(){for(var s=0,a=t.length,o=Array(a),r=0;r<a;r++)o[r]=t[r]===i?arguments[s++]:t[r];for(;s<arguments.length;)o.push(arguments[s++]);return xo(e,n,this,this,o)};return n}));Eo.placeholder=ya;var Io=Eo,jo=Ps((function(e,t,i){if(!Ys(e))throw new TypeError("Bind must be called on a function");var n=Ps((function(s){return xo(e,n,t,this,i.concat(s))}));return n})),Ao=ra(pa);function Mo(e,t,i,n){if(n=n||[],t||0===t){if(t<=0)return n.concat(e)}else t=1/0;for(var s=n.length,a=0,o=pa(e);a<o;a++){var r=e[a];if(Ao(r)&&(ea(r)||na(r)))if(t>1)Mo(r,t-1,i,n),s=n.length;else for(var l=0,c=r.length;l<c;)n[s++]=r[l++];else i||(n[s++]=r)}return n}var Lo=Ps((function(e,t){var i=(t=Mo(t,!1,!1)).length;if(i<1)throw new Error("bindAll must be passed function names");for(;i--;){var n=t[i];e[n]=jo(e[n],e)}return e}));function Po(e,t){var i=function(n){var s=i.cache,a=""+(t?t.apply(this,arguments):n);return ta(s,a)||(s[a]=e.apply(this,arguments)),s[a]};return i.cache={},i}var _o=Ps((function(e,t,i){return setTimeout((function(){return e.apply(null,i)}),t)})),Do=Io(_o,ya,1);function Oo(e,t,i){var n,s,a,o,r=0;i||(i={});var l=function(){r=!1===i.leading?0:co(),n=null,o=e.apply(s,a),n||(s=a=null)},c=function(){var c=co();r||!1!==i.leading||(r=c);var u=t-(c-r);return s=this,a=arguments,u<=0||u>t?(n&&(clearTimeout(n),n=null),r=c,o=e.apply(s,a),n||(s=a=null)):n||!1===i.trailing||(n=setTimeout(l,u)),o};return c.cancel=function(){clearTimeout(n),r=0,n=s=a=null},c}function Ro(e,t,i){var n,s,a=function(t,i){n=null,i&&(s=e.apply(t,i))},o=Ps((function(o){if(n&&clearTimeout(n),i){var r=!n;n=setTimeout(a,t),r&&(s=e.apply(this,o))}else n=_o(a,t,this,o);return s}));return o.cancel=function(){clearTimeout(n),n=null},o}function Bo(e,t){return Io(t,e)}function Vo(e){return function(){return!e.apply(this,arguments)}}function No(){var e=arguments,t=e.length-1;return function(){for(var i=t,n=e[t].apply(this,arguments);i--;)n=e[i].call(this,n);return n}}function Ho(e,t){return function(){if(--e<1)return t.apply(this,arguments)}}function Fo(e,t){var i;return function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=null),i}}var $o=Io(Fo,2);function qo(e,t,i){t=no(t,i);for(var n,s=fa(e),a=0,o=s.length;a<o;a++)if(t(e[n=s[a]],n,e))return n}function Uo(e){return function(t,i,n){i=no(i,n);for(var s=pa(t),a=e>0?0:s-1;a>=0&&a<s;a+=e)if(i(t[a],a,t))return a;return-1}}var Wo=Uo(1),Go=Uo(-1);function zo(e,t,i,n){for(var s=(i=no(i,n,1))(t),a=0,o=pa(e);a<o;){var r=Math.floor((a+o)/2);i(e[r])<s?a=r+1:o=r}return a}function Yo(e,t,i){return function(n,s,a){var o=0,r=pa(n);if("number"==typeof a)e>0?o=a>=0?a:Math.max(a+r,o):r=a>=0?Math.min(a+1,r):a+r+1;else if(i&&a&&r)return n[a=i(n,s)]===s?a:-1;if(s!=s)return(a=t(Ls.q.call(n,o,r),aa))>=0?a+o:-1;for(a=e>0?o:r-1;a>=0&&a<r;a+=e)if(n[a]===s)return a;return-1}}var Xo=Yo(1,Wo,zo),Ko=Yo(-1,Go);function Jo(e,t,i){var n=(Ao(e)?Wo:qo)(e,t,i);if(void 0!==n&&-1!==n)return e[n]}function Qo(e,t){return Jo(e,Qa(t))}function Zo(e,t,i){var n,s;if(t=eo(t,i),Ao(e))for(n=0,s=e.length;n<s;n++)t(e[n],n,e);else{var a=fa(e);for(n=0,s=a.length;n<s;n++)t(e[a[n]],a[n],e)}return e}function er(e,t,i){t=no(t,i);for(var n=!Ao(e)&&fa(e),s=(n||e).length,a=Array(s),o=0;o<s;o++){var r=n?n[o]:o;a[o]=t(e[r],r,e)}return a}function tr(e){var t=function(t,i,n,s){var a=!Ao(t)&&fa(t),o=(a||t).length,r=e>0?0:o-1;for(s||(n=t[a?a[r]:r],r+=e);r>=0&&r<o;r+=e){var l=a?a[r]:r;n=i(n,t[l],l,t)}return n};return function(e,i,n,s){var a=arguments.length>=3;return t(e,eo(i,s,4),n,a)}}var ir=tr(1),nr=tr(-1);function sr(e,t,i){var n=[];return t=no(t,i),Zo(e,(function(e,i,s){t(e,i,s)&&n.push(e)})),n}function ar(e,t,i){return sr(e,Vo(no(t)),i)}function or(e,t,i){t=no(t,i);for(var n=!Ao(e)&&fa(e),s=(n||e).length,a=0;a<s;a++){var o=n?n[a]:a;if(!t(e[o],o,e))return!1}return!0}function rr(e,t,i){t=no(t,i);for(var n=!Ao(e)&&fa(e),s=(n||e).length,a=0;a<s;a++){var o=n?n[a]:a;if(t(e[o],o,e))return!0}return!1}function lr(e,t,i,n){return Ao(e)||(e=Da(e)),("number"!=typeof i||n)&&(i=0),Xo(e,t,i)>=0}var cr=Ps((function(e,t,i){var n,s;return Ys(t)?s=t:(t=za(t),n=t.slice(0,-1),t=t[t.length-1]),er(e,(function(e){var a=s;if(!a){if(n&&n.length&&(e=Ya(e,n)),null==e)return;a=e[t]}return null==a?a:a.apply(e,i)}))}));function ur(e,t){return er(e,Za(t))}function hr(e,t){return sr(e,Qa(t))}function dr(e,t,i){var n,s,a=-1/0,o=-1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var r=0,l=(e=Ao(e)?e:Da(e)).length;r<l;r++)null!=(n=e[r])&&n>a&&(a=n);else t=no(t,i),Zo(e,(function(e,i,n){((s=t(e,i,n))>o||s===-1/0&&a===-1/0)&&(a=e,o=s)}));return a}function pr(e,t,i){var n,s,a=1/0,o=1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var r=0,l=(e=Ao(e)?e:Da(e)).length;r<l;r++)null!=(n=e[r])&&n<a&&(a=n);else t=no(t,i),Zo(e,(function(e,i,n){((s=t(e,i,n))<o||s===1/0&&a===1/0)&&(a=e,o=s)}));return a}function mr(e,t,i){if(null==t||i)return Ao(e)||(e=Da(e)),e[lo(e.length-1)];var n=Ao(e)?Ua(e):Da(e),s=pa(n);t=Math.max(Math.min(t,s),0);for(var a=s-1,o=0;o<t;o++){var r=lo(o,a),l=n[o];n[o]=n[r],n[r]=l}return n.slice(0,t)}function fr(e){return mr(e,1/0)}function gr(e,t,i){var n=0;return t=no(t,i),ur(er(e,(function(e,i,s){return{value:e,index:n++,criteria:t(e,i,s)}})).sort((function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return e.index-t.index})),"value")}function vr(e,t){return function(i,n,s){var a=t?[[],[]]:{};return n=no(n,s),Zo(i,(function(t,s){var o=n(t,s,i);e(a,t,o)})),a}}var yr=vr((function(e,t,i){ta(e,i)?e[i].push(t):e[i]=[t]})),br=vr((function(e,t,i){e[i]=t})),Sr=vr((function(e,t,i){ta(e,i)?e[i]++:e[i]=1})),wr=vr((function(e,t,i){e[i?0:1].push(t)}),!0),kr=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function Cr(e){return e?ea(e)?Ls.q.call(e):Ns(e)?e.match(kr):Ao(e)?er(e,Ja):Da(e):[]}function Tr(e){return null==e?0:Ao(e)?e.length:fa(e).length}function xr(e,t,i){return t in i}var Er=Ps((function(e,t){var i={},n=t[0];if(null==e)return i;Ys(n)?(t.length>1&&(n=eo(n,t[1])),t=ka(e)):(n=xr,t=Mo(t,!1,!1),e=Object(e));for(var s=0,a=t.length;s<a;s++){var o=t[s],r=e[o];n(r,o,e)&&(i[o]=r)}return i})),Ir=Ps((function(e,t){var i,n=t[0];return Ys(n)?(n=Vo(n),t.length>1&&(i=t[1])):(t=er(Mo(t,!1,!1),String),n=function(e,i){return!lr(t,i)}),Er(e,n,i)}));function jr(e,t,i){return Ls.q.call(e,0,Math.max(0,e.length-(null==t||i?1:t)))}function Ar(e,t,i){return null==e||e.length<1?null==t||i?void 0:[]:null==t||i?e[0]:jr(e,e.length-t)}function Mr(e,t,i){return Ls.q.call(e,null==t||i?1:t)}function Lr(e,t,i){return null==e||e.length<1?null==t||i?void 0:[]:null==t||i?e[e.length-1]:Mr(e,Math.max(0,e.length-t))}function Pr(e){return sr(e,Boolean)}function _r(e,t){return Mo(e,t,!1)}var Dr=Ps((function(e,t){return t=Mo(t,!0,!0),sr(e,(function(e){return!lr(t,e)}))})),Or=Ps((function(e,t){return Dr(e,t)}));function Rr(e,t,i,n){Rs(t)||(n=i,i=t,t=!1),null!=i&&(i=no(i,n));for(var s=[],a=[],o=0,r=pa(e);o<r;o++){var l=e[o],c=i?i(l,o,e):l;t&&!i?(o&&a===c||s.push(l),a=c):i?lr(a,c)||(a.push(c),s.push(l)):lr(s,l)||s.push(l)}return s}var Br=Ps((function(e){return Rr(Mo(e,!0,!0))}));function Vr(e){for(var t=[],i=arguments.length,n=0,s=pa(e);n<s;n++){var a=e[n];if(!lr(t,a)){var o;for(o=1;o<i&&lr(arguments[o],a);o++);o===i&&t.push(a)}}return t}function Nr(e){for(var t=e&&dr(e,pa).length||0,i=Array(t),n=0;n<t;n++)i[n]=ur(e,n);return i}var Hr=Ps(Nr);function Fr(e,t){for(var i={},n=0,s=pa(e);n<s;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i}function $r(e,t,i){null==t&&(t=e||0,e=0),i||(i=t<e?-1:1);for(var n=Math.max(Math.ceil((t-e)/i),0),s=Array(n),a=0;a<n;a++,e+=i)s[a]=e;return s}function qr(e,t){if(null==t||t<1)return[];for(var i=[],n=0,s=e.length;n<s;)i.push(Ls.q.call(e,n,n+=t));return i}function Ur(e,t){return e._chain?ya(t).chain():t}function Wr(e){return Zo(Ba(e),(function(t){var i=ya[t]=e[t];ya.prototype[t]=function(){var e=[this._wrapped];return Ls.o.apply(e,arguments),Ur(this,i.apply(ya,e))}})),ya}Zo(["pop","push","reverse","shift","sort","splice","unshift"],(function(e){var t=Ls.a[e];ya.prototype[e]=function(){var i=this._wrapped;return null!=i&&(t.apply(i,arguments),"shift"!==e&&"splice"!==e||0!==i.length||delete i[0]),Ur(this,i)}})),Zo(["concat","join","slice"],(function(e){var t=Ls.a[e];ya.prototype[e]=function(){var e=this._wrapped;return null!=e&&(e=t.apply(e,arguments)),Ur(this,e)}}));var Gr=ya,zr=Wr(n);zr._=zr;var Yr=zr;Yr.templateSettings={evaluate:/\{\{(.+?)\}\}/g,interpolate:/\$\{(.+?)\}/g,escape:/\{\{-(.+?)\}\}/g};function Xr(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Kr(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Xr(Object(i),!0).forEach((function(t){Ln()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Xr(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Jr={$key:Ms._key,$class:Ms._class,$style:Ms._style,$for:Ms._for,$if:Ms._if};function Qr(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Zr(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Qr(Object(i),!0).forEach((function(t){Ln()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Qr(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var el=Ms.parseLit,tl=["data","el","shadowDOM","template","created","updated","removed","$store","prop","tagName"],il=function(e){return Object.keys(e).filter((function(e){return!tl.includes(e)})).filter((function(e){return!e.startsWith("$")})).filter((function(t){return Nn(e,t)})).reduce((function(t,i){return Zr(Zr({},t),{},Ln()({},i,e[i]))}),{})},nl=function(e){return Object.keys(e).filter((function(t){return!Nn(e,t)})).reduce((function(t,i){return Zr(Zr({},t),{},Ln()({},i,e[i]))}),{})},sl=function(e,t){return Object.keys(e).filter((function(t){return Nn(e,t)})).map((function(i){return t.hasOwnProperty(i)||(t[i]=null),n=i,s=e[i],function(e){return e[n]=s(_n({},e))};var n,s}))},al=function(e){return Object.keys(e).filter((function(e){return e.startsWith("$")})).filter((function(e){return!tl.includes(e)})).reduce((function(t,i){return Zr(Zr({},t),{},Ln()({},i,e[i]))}),{})},ol=function(e){return function(t){return t.$store=e.getState(),e.subscribe((function(i){return t.$store=Zr({},e.getState())}))}},rl=function(e,t,i){Object.keys(t).filter((function(e){return!e.startsWith("_")})).map((function(n){return e[n]=t[n].bind(i)}))},ll=function(e){var t=Fn(e.replace(/\$?\{([^\;\{]+)\}/g,(function(e,t){return"${".concat(t,"}")})));!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Kr(Kr({},t),Jr);for(var n in i)for(var s=n.replace("$",""),a=xs(e,s),o=0;o<a.length;o++){var r=a[o];if(Cs(r,s)){var l=Ts(r,s);i[n](r,l,s)}}}(t),function(e){for(var t=e.querySelectorAll("[\\@call], [\\@bind]"),i=0;i<t.length;i++){var n=t[i],s=n.getAttribute("@call"),a=n.hasAttribute("@bind");n.removeAttribute("@call"),a&&(n.setAttribute("ld--bind",n.getAttribute("@bind")),n.removeAttribute("@bind"),s="__$bindInput");var o=["click"];n instanceof HTMLInputElement||n instanceof HTMLTextAreaElement?o=["input","paste"]:n instanceof HTMLSelectElement?o=["change"]:n instanceof HTMLFormElement?o=["submit"]:n instanceof HTMLAnchorElement&&n.setAttribute("href","javascript:void(0);");var r=(n.getAttribute("ld--elist")||"").split(",").filter((function(e){return e}));r=r.concat(o),n.setAttribute("ld--elist",r.join(","));for(var l=0;l<o.length;l++){var c=o[l];n.setAttribute(gs(c),s)}}for(var u=0;u<ms.length;u++)for(var h=ms[u],d=e.querySelectorAll("[\\@".concat(h,"]")),p=0;p<d.length;p++){var m=d[p],f=(m.getAttribute("ld--elist")||"").split(",").filter((function(e){return e}));f.push(h),m.setAttribute("ld--elist",f.join(",")),m.setAttribute(gs(h),m.getAttribute("@".concat(h))),m.removeAttribute("@".concat(h)),m instanceof HTMLAnchorElement&&m.setAttribute("href","javascript:void(0);")}}(t);var i=function(e){return $n.reduce((function(e,t){return e.replace(new RegExp(t[0],"g"),t[1])}),e)}(t.innerHTML),n=el(i);return{html:i,render:function(e,t){var i=Fn(n(t));return!e.isEqualNode(i)&&function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(n=bs({key:function(e){return ws(e)}},n),"string"==typeof i){var s=i;(i=document.createElement(t.nodeName)).innerHTML=s}var a,o=Ss(t,n.key);for(a=0;i.firstChild;a++){var r=i.removeChild(i.firstChild);if(a>=t.childNodes.length)t.appendChild(r);else{var l=t.childNodes[a],c=n.key(r);if(n.key(l)||c){var u=c&&c in o?o[c]:r;u!==l&&(l=t.insertBefore(u,l))}if(l.nodeType!==r.nodeType||l.tagName!==r.tagName)t.replaceChild(r,l);else if([Node.TEXT_NODE,Node.COMMENT_NODE].indexOf(l.nodeType)>=0)l.textContent!==r.textContent&&(l.textContent=r.textContent);else if(l!==r){var h=qn(l),d=qn(r);for(var p in h)p in d||l.removeAttribute(p);for(var m in d)m in h&&h[m]===d[m]||l.setAttribute(m,d[m]);0==r.childNodes.length&&l.childNodes.length>0?t.replaceChild(r,l):e(l,r)}}}for(;t.childNodes.length>a;)t.removeChild(t.lastChild);return!0}(e,i)}}};function cl(e){var t=e.target,i=t.getAttribute("ld--bind");if("checkbox"===t.type){var n=Bn(this.data,i)||[];Rn(this.data,i,t.checked?n.concat(t.value):n.filter((function(e){return e!=t.value})))}else t.options&&t.multiple?Rn(this.data,i,[].reduce.call(t,(function(e,t){return t.selected?e.concat(t.value):e}),[])):Rn(this.data,i,t.value)}function ul(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=vi()(e);if(t){var s=vi()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return fi()(this,i)}}function hl(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function dl(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?hl(Object(i),!0).forEach((function(t){Ln()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):hl(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var pl={__$objToStyleMap:On};function ml(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function fl(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ml(Object(i),!0).forEach((function(t){Ln()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ml(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var gl=function(){return"shoutui-".concat(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7;return Math.random().toString(36).substr(2,e).toLowerCase()}())};function vl(e){var t=fl({el:null,refId:null,template:null,tagName:null,shadowDOM:!1},e),i=null,n=!!t.tagName;if(t.tagName=t.tagName||gl(),t.el&&(function(e){return"hidden"===Hn(e).visibility}(i=function(e){return"string"==typeof e?document.querySelector(e):e}(t.el))&&(i.style.visibility="visible"),function(e){return"none"===Hn(e).display}(i)&&(i.style.display=""),t.template||(t.template=i.innerHTML),i.innerHTML="",!n)){var s=document.createElement(t.tagName);t.refId&&s.setAttribute("ref-id",t.refId),i.parentNode.replaceChild(s,i)}if(!t.template)throw new Error("ShoutUI Error: ".concat("missing 'template' option or 'el' are not valid elements"));!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=dl({shadowDOM:!1,tagName:null,data:{},template:null,$store:{getState:function(){},subscribe:function(){return function(){}}},initialize:function(e){},created:function(){},updated:function(){},removed:function(){}},e),i=(ol(t.$store),ll(t.template)),n=il(t),s=nl(t.data),o=al(t);window.customElements.define(t.tagName.toLowerCase(),function(e){pi()(c,e);var l=ul(c);function c(){var e;return a()(this,c),(e=l.call(this)).$root=t.shadowDOM?e.attachShadow({mode:"open"}):Ii()(e),t.initialize.call(Ii()(e),t),e}return r()(c,[{key:"connectedCallback",value:function(){var e=this;this.$eventHooks={updated:[],removed:[]},this._state=dl(dl(dl({},this._state),s),{},{prop:qn(this,!0)});var a=sl(t.data,this._state),r=function(e){return a.forEach((function(t){return t(e)}))},l=Un(this._state,(function(){r(e._state),i.render(e.$root,dl(dl(dl({},e._state),pl),t.constants))&&(t.updated.call(e.context),vs(e.$root,e.context))}));this.context=dl(dl(dl(dl({},n),o),{},{data:l},t.constants),{},{el:this.$root,prop:this._state.prop,__$bindInput:cl}),rl(this,n,this.context),r(this._state),i.render(this.$root,dl(dl(dl({},this._state),pl),t.constants)),t.created.call(this.context),vs(this.$root,this.context)}},{key:"disconnectedCallback",value:function(){t.removed.call(this.context),this.$eventHooks=[]}},{key:"data",get:function(){return Gn(this._state)}}]),c}(ps()(HTMLElement)))}(t)}var yl=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Array.isArray(e)?e.map((function(e){return vl(fl(fl({},t),e))})):vl(e)},bl=function(){function e(t){a()(this,e),this.$app=t}return r()(e,null,[{key:"displayPrintWindow",value:function(t){var i=t.getUIConfig().printWindowConfig||{},n=t.getUIConfig().appConfigProps||{},s=n.dateFormat||Z,a=n.timeStampFormat||ee,o=i.leftPosition||0,r=i.topPosition||0,l=i.width||600,c=i.height||400,u=window.open("","inqPrint","left=".concat(o,",top=").concat(r,",height=").concat(c,",width=").concat(l,",status=0,toolbar=0")),h=document.body.parentNode.getElementsByTagName("LINK"),d=t.getEngagementID(),p=t.isAsyncChat,m=t.getLatestConversationID(),f=(new Date).getTime();if(u){u.onload=function(){return!0},u.document.open(),u.document.write("<!DOCTYPE html><html><head>");for(var g=0;g<h.length;g++){var v=h[g].href;v&&v.includes(".css")&&(u.document.write('<link type="text/css" rel="stylesheet" media="print" href="'.concat(v,'" />')),u.document.write('<link type="text/css" rel="stylesheet" media="screen" href="'.concat(v,'" />')))}u.document.write("</head>");var y=document.createElement("div"),b=e.createPrintViewElement("header","print-view-header"),S=i.logoConfig&&Yi(i.logoConfig,t),w=e.createPrintViewElement("div","print-title",i.transcriptTitleStyles);if(w.innerText=i&&i.transcriptTitle||"Chat Transcript",b.appendChild(w),S){var k=e.createPrintViewElement("img","print-logo",i.transcriptLogoStyles);k.src=S,b.appendChild(k)}y.appendChild(b);var C=e.createPrintViewElement("br","");if(i.transcriptId){var T=e.createTranscriptIDElement(i,p,m,d);y.appendChild(T)}if(i.transcriptHeader){var x=e.createTranscriptHeaderElement(i);y.appendChild(x)}var E=t.renderEngine.getMessages(),I=i.transcriptDateTimeStyles||{};if(i.transcriptDateTime){var j=E.length>0?parseInt(E[0].getTimeStamp(),10):(new Date).getTime();e.createTranscriptDateElement(j,s,y,I.date)}if(E.forEach((function(t){var n,o,r,l;t.getMessageBubble()===Mi.AGENT_MESSAGE||t.getMessageBubble()===Mi.VIRTUAL_AGENT_MESSAGE||t.getMessageBubble()==Mi.OPENER_MESSAGE||e.isMsgTextDisplayedinRichView(t)?(n=e.createPrintViewElement("div","print-agent-message"),(o=e.createPrintViewElement("div","print-agent-alias",i.transcriptAgentAliasStyles)).innerHTML="".concat(t.getName()||"Agent","<span>: </span>"),(r=e.createPrintViewElement("div","print-agent-text",i.transcriptTextStyles)).innerHTML=Gi(t.getMessageText()),l=e.createPrintViewElement("div","agent-time-stamp",I.agentTimeStamp)):t.getMessageBubble()===Mi.CUSTOMER_MESSAGE&&(n=e.createPrintViewElement("div","print-customer-message"),(o=e.createPrintViewElement("div","print-customer-alias",i.transcriptCustomerNameStyles)).innerHTML="".concat(t.getName(),"<span>:</span>"),(r=e.createPrintViewElement("div","print-customer-text",i.transcriptTextStyles)).innerHTML=t.getMessageText(),l=e.createPrintViewElement("div","customer-time-stamp",I.customerTimeStamp));var c,u,h,d,p=parseInt(t.getTimeStamp(),10),m=new Date(f),g=new Date(p),v=(c=m,u=g,h=Date.UTC(c.getFullYear(),c.getMonth(),c.getDate()),d=Date.UTC(u.getFullYear(),u.getMonth(),u.getDate()),Math.floor((d-h)/864e5));v>=1&&i.transcriptDateTime&&e.createTranscriptDateElement(p,s,y,I.date),n&&(n.appendChild(o),n.appendChild(C),n.appendChild(r),n.appendChild(C),i.transcriptDateTime&&(l.innerHTML=Ji(p,a),n.appendChild(l)),y.appendChild(n)),f=p})),i.transcriptFooter){var A=e.createPrintViewElement("div","print-view-footer",i.transcriptFooterStyle);A.innerHTML=i.transcriptFooter,y.appendChild(A)}u.document.write("<body class='print' onload='printTranscript()'>\n                    <script>\n                        function printTranscript(){\n                            window.print();\n                            setTimeout(function() {\n                                window.close();\n                            }, 4000);\n                        }\n                    <\/script>"),t.bridge.isTablet()&&u.document.write("<br/><button onclick='window.close()' style='display: block;margin: 0 auto;padding: 5px'>Close</button></br>"),u.document.write(y.innerHTML),u.document.write("</body></html>"),u.document.close()}}},{key:"createPrintViewElement",value:function(e,t,i){var n=document.createElement(e);return t&&n.classList.add(t),i&&Fi(i,n),n}},{key:"isMsgTextDisplayedinRichView",value:function(e){var t,i=(t=e.getMessageBubble())===Mi.RICH_MESSAGE_RECEIPT||t===Mi.RICH_MESSAGE_FORM||t===Mi.RICH_MESSAGE_QR||t===Mi.RICH_MESSAGE_CARD||t===Mi.RICH_MESSAGE_OTHER,n=e.getRichData()&&e.getRichData().showMessageText,s=!e.isEmptyResponse();return i&&n&&s}},{key:"createTranscriptDateElement",value:function(t,i,n,s){var a=e.createPrintViewElement("h2","transcript-date-time",s);a.innerText=Ji(t,i),n.appendChild(e.createPrintViewElement("br","")),n.appendChild(a)}},{key:"createTranscriptIDElement",value:function(t,i,n,s){var a=e.createPrintViewElement("div","transcript-id",t.transcriptIdStyle),o=t.transcriptIdLabel?"".concat(t.transcriptIdLabel," : "):"",r=(i?n:s)||"";return a.innerText="".concat(o).concat(r),a}},{key:"createTranscriptHeaderElement",value:function(t){var i=e.createPrintViewElement("div","transcript-header",t.transcriptHeaderStyle);return i.innerText=t.transcriptHeader,i}}]),e}(),Sl=i(20),wl={tagName:"topbar-element",template:i.n(Sl).a,onIconClick:function(e){if(!this.data.disabled){var t=this.prop.type,i=new En(this.$app);switch(t){case"Close":this.$app.closeChat();break;case"Minimize":this.$app.minimize();break;case"Email":i.requestEmail();break;case"Chime":this.toggleChime();break;case"Print":bl.displayPrintWindow(this.$app);break;case"Info":i.displayInfoModalWindow(this.prop.content)}}},onItemClick:function(e){"a"===e.target.tagName.toLowerCase()&&(this.$app.bridge.pushToFrameSet(e.target.href,e.target.target),e.preventDefault())},created:function(){this.ariaUtil=new zn(this.$app),this.iconEl=this.el.querySelector(".icon")||this.el.querySelector(".logo"),this.visible=!0,this.prop.extended&&(this.extendedButton=this.el.querySelector(".extended-topbar-button")),this.processProperties(this.prop),this.toggleFullScreenMode(this.$app.getBridge().isFullScreen()),this.iconEl&&(this.iconElMouseTrap=new xn.a(this.extendedButton||this.iconEl),this.setKeyboardBindings()),"chime"==this.prop.type&&this.visible&&Hi(this.$app.isSoundEnabled(),this.el)},destroy:function(){this.unsetKeyboardBindings()},setKeyboardBindings:function(){var e=this;this.iconElMouseTrap.bind(["enter","space"],(function(t){return e.onIconClick(t),!1}))},unsetKeyboardBindings:function(){this.iconElMouseTrap.unbind(["enter","space"])},processProperties:function(e){this.processHiddenDevice(e),this.processHiddenStatesProperty(e),this.processTextProperty(e),this.processTypeProperty(e),this.udpateBackground(e)},processHiddenStatesProperty:function(e){e.hiddenstates&&this.visible&&(this.handleVisibility(this.$app.getStateMgr().state.state),this.subscribeToStateMgr())},processHiddenDevice:function(e){e.hiddendevices&&-1!==e.hiddendevices.indexOf(this.$app.getCIAPIInstance().getDeviceType())&&(this.visible=!1,this.el.style.display="none")},processTextProperty:function(e){if(e.text)this.data.text=e.text;else switch(e.type){case"Chime":this.data.text="Chime";break;case"Close":this.data.text="End Chat";break;case"Email":this.data.text="Email Transcript";break;case"Emoji":this.data.text="Send Emoji";break;case"Minimize":this.data.text="Minimize Chat";break;case"Overflow":this.data.text="Menu";break;case"Print":this.data.text="Print Transcript";break;case"Send":this.data.text="Send Message";break;case"Logo":this.data.text="logo";break;default:ai("'".concat(e.type,"' top-bar-element does not have a \n\t\t\t\t\t'text' property or a default value. ARIA announcement\n\t\t\t\t\t for this button will not work"))}},processTypeProperty:function(e){switch(e.type){case"Description":case"Title":this.processTypePropertyTitle(e);break;case"Chime":this.updateChimeButtonStateForAria();break;case"Email":this.processTypePropertyEmail(e)}},processTypePropertyTitle:function(e){e.subtext&&(this.data.subText=Gi(e.subtext.replace("undefined",""))),this.data.mainTitle=Gi(e.text),this.data.subText=this.ariaUtil.injectAttributes(this.data.subText),this.data.mainTitle=this.ariaUtil.injectAttributes(this.data.mainTitle)},processTypePropertyEmail:function(e){var t=this;e.hiddenstates||this.subscribeToStateMgr();var i=this.$app.getStateMgr();this.emailStateListenerIndex=i.subscribe((function(e){t.disableData(e)}),"emailState")},subscribeToStateMgr:function(){if(void 0===this.stateListenerIndex){var e=this.$app.getStateMgr();this.stateListenerIndex=e.subscribe(this.chatStateListener.bind(this),"state")}},updateChimeButtonStateForAria:function(){var e=Ni(this.data.text,this.$app);(this.extendedButton?this.extendedButton:this.iconEl).setAttribute("title",e)},udpateBackground:function(e){var t=e;if("Chime"===e.type&&(t=Vi(e,this.$app),(e.text||appInstance.audioTextOn&&appInstance.audioTextOff)&&e.extended)){var i=Ni(e.text,this.$app);this.el.querySelector(".extended-text").innerText=i}var n=qi(t,this.$app);n?(this.iconEl.style.backgroundImage=n,this.iconEl.style.display=""):this.iconEl&&(this.iconEl.style.display="none"),e.extended&&this.data.disabled&&this.el.classList.add("disabled")},updateTitle:function(e){this.iconEl.querySelector(".main-title span").innerHTML=e},updateStatus:function(e,t){this.data.status=e||"",this.data.subStatus=t||""},enable:function(){this.data.disabled=!1,this.prop.extended&&this.el.classList.remove("disabled"),this.udpateBackground(this.prop)},setDisable:function(){this.data.disabled=!0,this.udpateBackground(this.prop)},toggleChime:function(){this.$app.setSoundState(!this.$app.isSoundEnabled()),this.updateChimeButtonStateForAria(),this.udpateBackground(this.prop),Hi(this.$app.isSoundEnabled(),this.el)},toggleFullScreenMode:function(e){this.data.isFullScreenOnly&&(this.iconEl.style.display=e?"":"none")},chatStateListener:function(e){"Email"===this.prop.type&&this.enableData(e),this.handleVisibility(e)},enableData:function(e){var t=e===pt,i=!this.$app.isEmailRequested(),n=this.data.disabled;t&&i&&n&&this.enable()},disableData:function(e){var t=e===yt,i=this.data.disabled;t&&!i&&this.setDisable()},handleVisibility:function(e){var t=!0,i=this.prop.hiddenstates;if(i){switch(e){case ht:case dt:-1!=i.indexOf("PreEngagement")&&(t=!1);break;case pt:-1!=i.indexOf("InEngagement")&&(t=!1);break;case mt:-1!=i.indexOf("PostEngagement")&&(t=!1);break;case gt:-1!=i.indexOf("InCall")&&(t=!1);break;case ft:-1!=i.indexOf("PreCall")&&(t=!1)}t&&!this.visible?this.el.style.display="":!t&&this.visible&&(this.el.style.display="none"),this.visible=t}},removed:function(){var e=this.$app.getStateMgr();void 0!==this.emailStateListenerIndex&&e.unsubscribe(this.emailStateListenerIndex),void 0!==this.stateListenerIndex&&e.unsubscribe(this.stateListenerIndex)}},kl=function(e){var t=e.getUIConfig();if(wl.$app=e,t.topBarConfig){var i=t.topBarConfig;wl.constants={topBarIconStyle:i.iconStyles,topBarTitleStyle:i.titleStyles,topBarLogoStyle:i.logoStyles,topBarDescriptionStyle:i.descriptionStyles,topBarStatusStyle:i.statusStyles,extendedIconStyle:i.extendedTopBarItemIconStyles}}return wl.data={mainTitle:"",status:"",subStatus:"",subText:"",text:"",disabled:function(t){if("Email"===t.prop.type){if(!e.getCIAPIInstance().isChatInProgress())return!0;if(e.isEmailRequested())return!0}return!1},isFullScreenOnly:function(e){return e.prop.mode===T}},wl},Cl=function(){function e(){a()(this,e)}return r()(e,[{key:"init",value:function(e){for(this.target=e,this.direction=window.getComputedStyle(this.target).direction,this.bar='<div class="ss-scroll">',this.wrapper=document.createElement("div"),this.wrapper.setAttribute("class","ss-wrapper"),this.el=document.createElement("div"),this.el.setAttribute("class","ss-content"),this.el.setAttribute("role","region"),this.el.setAttribute("tabindex","0"),"rtl"===this.direction&&this.el.classList.add("rtl"),this.wrapper.appendChild(this.el);this.target.firstChild;)this.el.appendChild(this.target.firstChild);this.target.appendChild(this.wrapper),this.target.insertAdjacentHTML("beforeend",this.bar),this.bar=this.target.lastChild,this.dragDealer(this.bar,this),this.moveBar(),this.moveBarHandler=zi(this.moveBar.bind(this),10),this.el.addEventListener("scroll",this.moveBarHandler),this.el.addEventListener("mouseenter",this.moveBarHandler),this.target.classList.add("ss-container");var t=window.getComputedStyle(e);return"0px"===t.height&&"0px"!==t["max-height"]&&(e.style.height=t["max-height"]),this.el.clientWidth,this.el.offsetWidth,this.el}},{key:"reinit",value:function(){this.moveBar()}},{key:"moveBar",value:function(e){var t=this.el.scrollHeight,i=this.el.clientHeight,n=this;this.scrollRatio=i/t;var s="rtl"===n.direction?n.target.clientWidth-n.bar.clientWidth+18:-1*(n.target.clientWidth-n.bar.clientWidth-10);window.raf((function(){if(n.scrollRatio>=1)n.bar.classList.add("ss-hidden");else{n.bar.classList.remove("ss-hidden");var e=Math.max(100*n.scrollRatio,10);n.bar.style.cssText="height:".concat(e,"%; top:").concat(Math.min(n.el.scrollTop/t*100,90),"%;right:").concat(s,"px;")}}))}},{key:"dragDealer",value:function(e,t){var i;function n(e){var n=e.pageY-i;i=e.pageY,window.raf((function(){t.el.scrollTop+=n/t.scrollRatio}))}function s(){e.classList.remove("ss-grabbed"),document.body.classList.remove("ss-grabbed"),document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",s)}this.mouseDownHandler=function(t){return i=t.pageY,e.classList.add("ss-grabbed"),document.body.classList.add("ss-grabbed"),document.addEventListener("mousemove",n),document.addEventListener("mouseup",s),!1},e.addEventListener("mousedown",this.mouseDownHandler)}},{key:"clear",value:function(){this.el.removeEventListener("scroll",this.moveBarHandler),this.el.removeEventListener("mouseenter",this.moveBarHandler),this.el.removeEventListener("mousedown",this.mouseDownHandler)}}]),e}();function Tl(e){this.speechCon=this.el.firstChild.querySelector(".speechCont");var t,i,n=this.speechCon.firstElementChild;switch(this.speechPos){case"bottom":n.classList.add("bottom");break;case"center":n.classList.add("center")}if(e.getMessageBubble()===Mi.OPENER_MESSAGE&&this.openerSpeechConfig&&(i=this.openerSpeechConfig),e.getMessageBubble()===Mi.VIRTUAL_AGENT_MESSAGE&&this.vaSpeechConfig&&(i=this.vaSpeechConfig),i&&(t=qi(i,this.$app)),e.getMessageBubble()!==Mi.AGENT_MESSAGE&&t||!this.agentSpeechConfig||(t=qi(this.agentSpeechConfig,this.$app),i=this.agentSpeechConfig),i.agentInitial){var s=e.getName();if(n.innerHTML=["<span>",s[0],"</span>"].join(""),i.agentColors&&i.agentColors.length>0){var a=e.getAgentIndex(),o=i.agentColors.length,r=i.agentColors[a%o];(function(e){return/^#([0-9a-f]{3}){1,2}$/i.test(e)})(r)&&(n.style.backgroundColor=r)}n.classList.add("agent_".concat(s.replace(/\W/g,"")))}else t&&(n.style.backgroundImage=t,n.setAttribute("role","img"));i.text&&n.setAttribute("aria-label",i.text)}function xl(e,t,i,n,s,a,o){var r={spec:i,container:n,initalView:"",isReload:s,viewRenderedCb:function(e){o&&o(e)}};a&&!s&&(r.viewStartedCb=function(e,n,s){t.getRichMediaReporter().sendStartedEvent(i,e,n,s)},r.viewChangeCb=function(e,n,s,a,o,r,l){t.getRichMediaReporter().sendRespondedEvent(i,e,n,s,a,o,r,l)},r.viewEndedCb=function(e,n,s,a,o,r){t.getRichMediaReporter().sendEndedEvent(i,e,n,s,a,o,r)}),e.renderRichContentinCI(r)}function El(e,t,i){var n={};"verbose"===t?(n.type=i.startsWith("http")?"hyperlink":"deepLink",n.url=i,n.selectedLink=JSON.stringify(n)):n.selectedLink=i,e.getCIAPIInstance().sendDataPass(n)}function Il(e,t,i){t.registerCBListener((function(t){t.sendMessage?e.sendRichMediaData(t.sendMessage.displayText,t.sendMessage):t.deepLink?(i&&El(e,i,t.deepLink.href),e.bridge.pushToFrameSet(t.deepLink.href,t.deepLink.target)):t.closeChat&&e.closeChat();var n=e.shoutui.getFooter();n&&n.enable(!1)}))}function jl(e){return e===Mi.RICH_MESSAGE_RECEIPT||e===Mi.RICH_MESSAGE_FORM||e===Mi.RICH_MESSAGE_QR||e===Mi.RICH_MESSAGE_CARD||e===Mi.RICH_MESSAGE_OTHER}var Al=i(21),Ml={tagName:"transcript-area",template:i.n(Al).a,created:function(){var e=this;this.tranCont=this.el.firstChild,this.footer=this.tranCont.lastElementChild,this.scollIn=new Cl,this.tArea=this.scollIn.init(this.tranCont),this.footer=this.tranCont.lastElementChild,this.typingView=this.tArea.querySelector("typing-view"),this.scrollHandler=this.scrollUp.bind(this),Ri()&&!this.iosSmoothScroll||(this.smoothScroll=new an(this.tArea,Ri()?this.iosScrollSpeed:this.mouseScrollSpeed,12)),this.newMsgBtn=null,this.bubbleFromBottom&&this.tArea.classList.add("bubble-bottom"),this.tArea.setAttribute("aria-label",this.$app.ariaStrings.transcriptLabel),this.lastScroll=0,this.oldScrollHeight=0,this.onKeyboardOpenSubscriptionId=Ti.subscribe((function(){e.scrollBottom()}),G),this.onWindowResizedSubscriptionId=Ti.subscribe((function(){e.scrollBottom()}),z)},expandArea:function(){var e=this;window.raf((function(){e.tranCont.classList.remove("transcript-area-material")}))},clearScrollTimer:function(){bn.exists("scrollTimer")&&!bn.executed("scrollTimer")&&bn.clear("scrollTimer")},renderMessageBubbles:function(e,t){var i,n=this;if(this.lastMessage=e,t)i=this.lastView,this.lastView.addBubble(e);else{if(e.getMessageBubble()===Mi.TYPING_MESSAGE)return this.typingView.setVisible(!0,e),void(this.shouldDisplayNewMessage(e)||(this.clearScrollTimer(),this.smoothScrollToBottomEnhanced()));i=this.createView(e),this.tArea.insertBefore(i,this.typingView),i.render(e)}this.lastView=i,e.getIsRestore()?this.restoreScrollHandler((function(){n.restoreTimer.clear(!0),n.$app.getIsMinimized()?n.scrollBottom():n.smoothScrollToBottomEnhanced(),n.scrollListenerEnabled||n.scrollListener()})):this.shouldDisplayNewMessage(e)?(this.createNewMsgButton(),this.newMsgBtn.classList.add("enter")):(this.clearScrollTimer(),bn.set("scrollTimer",(function(){n.smoothScrollToBottomEnhanced()}),100),this.scrollListenerEnabled||this.scrollListener())},smoothScrollToBottomEnhanced:function(){var e=this;if(this.bottomScrollBtn&&this.scrollBtnDisplayed){var t=this.lastMessage.getMessageBubble();if(t===Mi.TYPING_MESSAGE||t===Mi.CUSTOMER_MESSAGE)return}this.smScrollInst&&this.smScrollInst.interrupt();var i=this.getLastViewEnhancedScrollingTarget();this.smScrollInst=i?sn(this.tArea,i,this.s2bDuration):nn(this.tArea,this.s2bDuration),this.smScrollInst.p.then((function(){e.smScrollInst=null})).catch((function(e){ai(e)}))},getLastViewEnhancedScrollingTarget:function(){var e,t=this.lastMessage.getMessageBubble(),i=jl(t),n=t===Mi.AGENT_MESSAGE||t===Mi.VIRTUAL_AGENT_MESSAGE||t===Mi.OPENER_MESSAGE||i;if(this.enhancedScrollingEnabled&&n){var s,a=this.lastView.getContainer();(s=i?a:a.lastElementChild).clientHeight>this.tArea.clientHeight&&(e=s.offsetTop+this.tArea.clientHeight)}return e},renderMessageBubbleToTop:function(e,t){var i,n=this;t?(i=this.prevView||this.tArea.firstElementChild).insertBubble(e):(i=this.createView(e),this.tArea.insertBefore(i,this.tArea.firstElementChild),i.render(e));var s=this.tArea.scrollHeight-this.tArea.clientHeight;this.tArea.scrollTop=this.lastScroll+(s-this.oldScrollHeight),this.smoothScroll&&this.smoothScroll.pause(),this.restoreScrollHandler((function(){n.checkIfMoreBubblesNeeded(),n.scollIn.reinit(),n.restoreTimer.clear(!0),n.smoothScroll&&n.smoothScroll.resume(),n.scrollListenerEnabled||n.scrollListener()})),this.prevView=i},restoreScrollHandler:function(e){this.restoreTimer&&this.restoreTimer.pending()?this.restoreTimer.restart():(this.restoreTimer&&this.restoreTimer.clear(!0),this.restoreTimer=bn.instantiate(e,250))},checkIfMoreBubblesNeeded:function(){this.$app.lazyloading=!1;var e=this.tArea.clientHeight;this.topBarConfig&&"material"===this.topBarConfig.topBarType?e+=this.$app.shoutui.getTopBarHeight():e+=100,this.tArea.scrollHeight<e&&this.$app.lazyloadConversation()},deleteMessageBubbles:function(e){var t=this;e.forEach((function(e){if(e.getMessageBubble()===Mi.TYPING_MESSAGE)t.typingView.setVisible(!1);else if(e.getMessageBubble()===Mi.SYSTEM_MESSAGE){var i=t.lastView;t.lastView=t.tempLastView,t.tempLastView=null,Cn(e.getIsRestore(),i)}else if(null!=e.getRichData()){var n=t.lastView;t.lastView=t.tempLastView,t.tempLastView=null,Cn(e.getIsRestore(),n)}}))},reloadMessageBubbles:function(e,t){t.getMessageBubble()===Mi.TYPING_MESSAGE?this.typingView.reload(t.getMessageText()):t.getMessageBubble()===Mi.SYSTEM_MESSAGE&&this.lastView.render(t),null!=t.getRichData()&&this.lastView.reload(t)},createView:function(e){var t,i=e.getMessageBubble();if(jl(i))t=document.createElement("rich-view"),this.tempLastView=this.lastView;else switch(i){case Mi.AGENT_MESSAGE:case Mi.VIRTUAL_AGENT_MESSAGE:case Mi.OPENER_MESSAGE:t=document.createElement("agent-simple-view");break;case Mi.CUSTOMER_MESSAGE:t=document.createElement("customer-simple-view");break;case Mi.CONVERSATION_HEADER:t=document.createElement("header-view");break;case Mi.DISCLAIMER_TEXT:t=document.createElement("disclaimer-view");break;case Mi.SYSTEM_MESSAGE:t=document.createElement("system-view"),this.tempLastView=this.lastView;break;default:throw new Error('Unknown bubble type: "'.concat(i,'" given to createView'))}return t},removed:function(){this.scollIn.clear(),this.tArea.removeEventListener("scroll",this.scrollHandler),this.smoothScroll&&this.smoothScroll.pause(),Ti.unsubscribe(this.onKeyboardOpenSubscriptionId),Ti.unsubscribe(this.onWindowResizedSubscriptionId)},scrollBottom:function(){var e=this;window.raf((function(){tn(e.tArea)}))},scrollUp:function(e){var t=e.target;if(this.oldScrollHeight=t.scrollHeight-t.clientHeight,this.$app.hasMoreConversations()&&!this.$app.getRestoring()&&t.scrollTop<15&&t.scrollTop<this.lastScroll)return e.target.removeEventListener("scroll",this.scrollHandler),this.scrollListenerEnabled=!1,this.lastScroll=t.scrollTop,this.smoothScroll&&this.smoothScroll.pause(),void this.$app.lazyloadConversation();this.bottomScrollBtn&&!this.$app.getRestoring()&&this.processDisplayGoToButton(),this.lastScroll=t.scrollTop},processDisplayGoToButton:function(){var e=this.tArea.clientHeight,t=this.tArea.scrollTop;this.scrollBtnDisplayed||t+e<this.tArea.scrollHeight-(this.bottomScrollVal||e)&&this.displayGoToBottomButton();this.scrollBtnDisplayed&&(this.tArea.scrollHeight-e-t<50&&this.hideScrollButton())},shouldDisplayNewMessage:function(e){var t=this.tArea.clientHeight,i=e.getMessageBubble();return!(!(this.$app.isHeaderNeeded()&&this.newMsgButton&&this.lastScroll+t<this.tArea.scrollHeight-t)||i!==Mi.AGENT_MESSAGE&&i!==Mi.OPENER_MESSAGE&&i!==Mi.TYPING_MESSAGE&&i!=Mi.VIRTUAL_AGENT_MESSAGE&&i!=Mi.RICH_MESSAGE_FORM&&i!=Mi.RICH_MESSAGE_FORM&&i!=Mi.RICH_MESSAGE_QR&&i!=Mi.RICH_MESSAGE_CARD&&i!=Mi.RICH_MESSAGE_OTHER)},createNewMsgButton:function(){var e=this;this.hideScrollButton(),this.newMsgBtn||(this.newMsgBtn=wn("new-msg-button",this.newMsgBtnText,this.newImgStyle,(function(){e.smoothScrollToBottomEnhanced(),e.newMsgBtn.classList.remove("enter")})),this.tranCont.appendChild(this.newMsgBtn))},createScrollButton:function(){var e=this;this.scrollBtn||(this.scrollBtn=wn("scroll-button",this.scrollBtnText,null,(function(){nn(e.tArea,e.s2bDuration),e.hideScrollButton()})),this.tranCont.appendChild(this.scrollBtn))},hideTyping:function(){this.typingView.setVisible(!1)},getTranscriptArea:function(){return this.tArea},adjustBottom:function(e){var t=parseInt(this.tranCont.style.bottom||0,10);t||(t=parseInt(window.getComputedStyle(this.tranCont).bottom,10),this.tranCont.style.bottom="".concat(t,"px")),t>e?this.tranCont.style.bottom="".concat(e,"px"):e>t&&(this.tranCont.style.bottom="".concat(e,"px"),tn(this.tArea))},hideScrollButton:function(){bn.clear(A),this.scrollBtn&&this.scrollBtn.classList.remove("enter"),this.scrollBtnDisplayed=!1},scrollListener:function(){this.tArea.addEventListener("scroll",this.scrollHandler),this.scrollListenerEnabled=!0},displayGoToBottomButton:function(){var e=this;this.scrollBtnDisplayed=!0,bn.set(A,(function(){e.createScrollButton(),e.scrollBtn.classList.add("enter")}),this.bottomScrollDelay)},toggleLoadingMessage:function(e,t){this.loadingView||(this.loadingView=this.createView(e),this.tranCont.appendChild(this.loadingView),this.loadingView.render(e)),t?this.loadingView.show():this.loadingView.hide()}},Ll=function(e){Ml.$app=e;var t=e.getUIConfig(),i={};t.transcriptConfig&&(i.style=t.transcriptConfig.transcriptAreaStyles,i.newImgStyle=t.transcriptConfig.newMessageButtonStyles,i.newMsgBtnText=t.transcriptConfig.newMsgButtonText||"New Message",i.scrollBtnText=t.transcriptConfig.scrollToBottomButtonText||"Scroll To Bottom"),t.topBarConfig&&(i.topBarConfig=t.topBarConfig.topBarSettings||{}),t.footerConfig&&(i.footerSettings=t.footerConfig.footerSettings||{});var n=t.appConfigProps;return n&&(i.s2bDuration=n.scrollDuration||100,i.bubbleFromBottom=n.setBubbleFromBottom||!1,i.newMsgButton=n.showNewMessageButton||!1,i.footerDis=n.showFooterDisclaimer,i.iosSmoothScroll=n.IOSSmoothScroll||!1,i.iosScrollSpeed=n.IOSSmoothScrollSpeed||15,i.mouseScrollSpeed=n.MouseScrollSpeed||50,i.bottomScrollBtn=n.goToBottomButton||!1,i.bottomScrollDelay=n.goToBottomButtonDelay||1e3,i.bottomScrollVal=n.goToBottomThreshold,i.enhancedScrollingEnabled=t.appConfigProps.enhancedScrollingEnabled||!1),Ml.constants=i,Ml},Pl=i(22),_l={tagName:"footer-area",template:i.n(Pl).a,created:function(){this.buttons=this.el.querySelectorAll(".footer-button-cont"),this.input=this.el.querySelector("input-item"),this.overFlowItems=this.el.querySelector(".overflow-menu-items"),this.overFlowItems&&(this.overFlowEL=this.overFlowItems.parentElement,this.ovState=this.overFlowEL.getAttribute("data-state")||""),this.stateSubIds=[],this.subscribeToStateChanges(),this.$app.focusMgr.setInputElement(this.input)},removed:function(){this.unsubscribeFromStateChanges(),Ti.unsubscribe(this.onVADialogClickedSubscriptionId)},subscribeToStateChanges:function(){var e=this;this.stateSubIds.push(this.$app.getStateMgr().subscribe((function(t){!t.visible&&"ended"===t.evt&&e.input&&e.input.focus()}),"survey")),this.stateSubIds.push(this.$app.getStateMgr().subscribe((function(t){t||e.input.focus()}),"isMinimized")),this.stateSubIds.push(this.$app.getStateMgr().subscribe((function(t){"footerArea.input"==t.readyFocus&&e.input.focus()}),"FrameBridge")),this.stateSubIds.push(this.$app.getStateMgr().subscribe((function(t){!t&&e.input&&e.input.focus()}),"isCloseConfirmVisible")),this.onVADialogClickedSubscriptionId=Ti.subscribe((function(){e.$app.focusInputOnVADialogClick&&!e.input.hasFocus()&&e.input.focus()}),"vaDialog.clicked")},unsubscribeFromStateChanges:function(){var e=this;this.stateSubIds.forEach((function(t){e.$app.getStateMgr().unsubscribe(t)})),this.stateSubIds.length=0},sendCustomerMessage:function(){this.input.sendCustomerMessage()},disable:function(){if(this.input.disable(),this.buttons.forEach((function(e){e.parentElement.disableButton()})),this.overFlowEL&&-1!=this.ovState.indexOf(Mt)&&(this.overFlowEL.classList.add("disabled"),Fi(this.config.disableStateStyle,this.overFlowEL)),this.hideFooter&&this.$app.getStateMgr().state.state==mt){var e=this.el.firstElementChild;e.firstElementChild.classList.add("ended"),e.classList.add("ended"),this.$app.shoutui.adjustTranscriptBottom(e.offsetHeight),e.setAttribute("aria-hidden",!0)}},enable:function(e){var t="boolean"!=typeof e||e;this.input.enable(),t&&this.input.focus(),this.buttons.forEach((function(e){e.parentElement.enableButton()})),this.overFlowEL&&(this.overFlowEL.classList.remove("disabled"),Fi(this.config.enableStateStyle,this.overFlowEL))},clear:function(){this.input&&this.input.clear()},toggleSendButtonState:function(e){this.buttons.forEach((function(t){t.parentElement.toggleSendButtonState(e)}))},getInputElement:function(){return this.input},onIconClick:function(e){void 0!==e.currentTarget.onIconClick&&e.currentTarget.onIconClick(e)},setChatStarted:function(){this.findItems(),this.items.forEach((function(e){e.enable()}))},findItems:function(){this.items||(this.items=Oi()(this.el.querySelectorAll("topbar-element")))},emailRequested:function(){this.items&&this.items.forEach((function(e){"Email"===e.getAttribute("type")&&e.setDisable()}))}},Dl=function(e){_l.$app=e;var t=e.getUIConfig(),i=t.footerConfig||{};return i&&(_l.constants={style:i.footerStyles,contStyle:i.footerContainerStyles,extendStyle:i.extendedFooterStyles,extendItemStyle:i.extendedFooterItemStyles,config:i.footerSettings||{},overflowIconStyle:i.overFlowItemStyles},_l.constants.config.disableStateStyle=i.disableStateStyle,_l.constants.config.enableStateStyle=i.enableStateStyle),t.appConfigProps&&(_l.constants.hideFooter=t.appConfigProps.hideFooterAtEnd),t.overFlowMenus&&t.overFlowMenus.forEach((function(e){var t=e.position,i=e.items,n=e.menuStyle;"FooterLeft"==t&&(_l.constants.config.leftOverFlowItems=i,_l.constants.leftOverFlowMenuStyle=n)})),_l.data={extendedFooter:function(e){return _l.constants.config.extendedFooterItems&&"false"==e.prop.issurvey},extendedFooterInSurvey:function(t){return e.extendedSurveyFooterVisible&&"true"==t.prop.issurvey}},_l},Ol=i(23),Rl={tagName:"overflow-item",template:i.n(Ol).a,onMenuClick:function(e){var t=this.prop.type,i=new En(this.$app);if(!this.data.disabled){switch(t){case"Close":this.$app.closeChat();break;case"Minimize":this.$app.minimize();break;case"Email":i.requestEmail();break;case"Chime":this.toggleChime();break;case"Print":bl.displayPrintWindow(this.$app);break;case"Info":i.displayInfoModalWindow(this.prop.content)}this.$app.shoutui.getLayoutEl().onLayoutClick(),e.preventDefault(),e.stopPropagation()}},created:function(){var e=this;this.parentEl=this.el.parentElement;var t=this.$app.getStateMgr();this.visible=!0,this.processHiddenDevice(this.prop),this.prop.hiddenstates&&this.visible&&(this.handleVisibility(t.state.state),this.subscribeToStateMgr()),"Email"==this.prop.type&&this.visible&&(this.subscribeToStateMgr(),this.emailStateListenerId=this.$app.getStateMgr().subscribe((function(t){e.disableData(t)}),"emailState")),"Chime"==this.prop.type&&this.visible&&Hi(this.$app.isSoundEnabled(),this.el)},subscribeToStateMgr:function(){void 0===this.stateListenerId&&(this.stateListenerId=this.$app.getStateMgr().subscribe(this.chatStateListener.bind(this),"state"))},enable:function(){this.data.disabled=!1},setDisable:function(){this.data.disabled=!0},toggleChime:function(){this.$app.setSoundState(!this.$app.isSoundEnabled()),this.el.firstElementChild.querySelector("img").src=Yi(Vi(this.prop,this.$app),this.$app),this.el.firstElementChild.querySelector("span").innerText=Ni(this.prop.text,this.$app),Hi(this.$app.isSoundEnabled(),this.el)},chatStateListener:function(e){"Email"==this.prop.type&&this.enableData(e),this.handleVisibility(e)},enableData:function(e){e==pt&&!this.$app.isEmailRequested()&&this.data.disabled&&this.enable()},disableData:function(e){e!=yt||this.data.disabled||this.setDisable()},processHiddenDevice:function(e){e.hiddendevices&&-1!==e.hiddendevices.indexOf(this.$app.getCIAPIInstance().getDeviceType())&&(this.visible=!1,this.el.style.display="none")},handleVisibility:function(e){var t=!0,i=this.prop.hiddenstates;if(i){switch(e){case ht:case dt:-1!=i.indexOf("PreEngagement")&&(t=!1);break;case pt:-1!=i.indexOf("InEngagement")&&(t=!1);break;case mt:-1!=i.indexOf("PostEngagement")&&(t=!1)}t&&!this.visible?this.el.style.display=null:!t&&this.visible&&(this.el.style.display="none"),this.visible=t}},removed:function(){var e=this.$app.getStateMgr();void 0!==this.emailStateListenerId&&e.unsubscribe(this.emailStateListenerId),void 0!==this.stateListenerId&&e.unsubscribe(this.stateListenerId)}},Bl=function(e){var t=e.getUIConfig();if(Rl.$app=e,Rl.data={imgUrl:function(t){var i=t.prop;return"Chime"==i.type&&(i=Vi(t.prop,e)),Yi(i,e)},disabled:function(t){if("Email"==t.prop.type){if(!e.getCIAPIInstance().isChatInProgress())return!0;if(e.isEmailRequested())return!0}return!1},text:function(t){if("Chime"==t.prop.type){var i=t.prop.text;return Ni(i,e)}return t.prop.text}},t.topBarConfig){var i=t.topBarConfig;Rl.constants={overFlowItemStyle:i.overFlowMenuItemStyle}}return Rl},Vl=function(){function e(t){a()(this,e),this.menuButton=t.elements.menuButton,this.menuContainer=t.elements.menuContainer,this.menuItems=t.elements.menuItems,this.lastFocusedElementIndex=null,this.menuItemsMouseTrap=new xn.a(this.menuContainer),this.openMenuButtonMouseTrap=new xn.a(this.menuButton),this.onMenuButtonPress=t.callbacks.onMenuButtonPress,this.onEscape=t.callbacks.onEscape,this.onMenuFocusOut=t.callbacks.onMenuFocusOut,this.boundedMenuContainerFocusOutListener=this.menuContainerFocusOutListener.bind(this),this.setFocusLostAction(this.menuContainer),this.setKeyboardBindings()}return r()(e,[{key:"destroy",value:function(){this.unsetFocusLostAction(this.menuContainer),this.unsetKeyboardBindings()}},{key:"focusElementByIndex",value:function(e){this.lastFocusedElementIndex=e,this.menuItems[this.lastFocusedElementIndex].focus()}},{key:"focusNext",value:function(){var e=null===this.lastFocusedElementIndex,t=this.menuItems.length-1,i=this.lastFocusedElementIndex===t;if(e||i){this.focusElementByIndex(0)}else{var n=this.lastFocusedElementIndex+1;this.focusElementByIndex(n)}}},{key:"focusPrevious",value:function(){var e=null===this.lastFocusedElementIndex,t=0===this.lastFocusedElementIndex;if(e||t){var i=this.menuItems.length-1;this.focusElementByIndex(i)}else{var n=this.lastFocusedElementIndex-1;this.focusElementByIndex(n)}}},{key:"menuContainerFocusOutListener",value:function(e){var t=e.relatedTarget;lr([].concat(Oi()(this.menuItems),[this.menuButton]),t)||this.onMenuFocusOut()}},{key:"setFocusLostAction",value:function(e){e.addEventListener("focusout",this.boundedMenuContainerFocusOutListener)}},{key:"setKeyboardBindings",value:function(){var e=this;this.menuItemsMouseTrap.bind(["down","right"],(function(t){return e.focusNext(),!1})),this.menuItemsMouseTrap.bind(["up","left"],(function(t){return e.focusPrevious(),!1})),this.menuItemsMouseTrap.bind("enter",(function(t){return e.menuItems[e.lastFocusedElementIndex].click(),!1})),this.menuItemsMouseTrap.bind("escape",(function(t){return e.onEscape(t),e.menuButton.focus(),!1})),this.openMenuButtonMouseTrap.bind(["enter","space"],(function(t){return e.onMenuButtonPress(t),!1}))}},{key:"unsetFocusLostAction",value:function(e){e.removeEventListener("focusout",this.boundedMenuContainerFocusOutListener)}},{key:"unsetKeyboardBindings",value:function(){this.menuItemsMouseTrap.reset(),this.openMenuButtonMouseTrap.reset()}}]),e}(),Nl=i(24),Hl={created:function(){this.overflowVisible=!1,this.overFlowMenu=this.el.querySelector(".overflow-menu-items"),this.hideOverflowWhenClickingOutsideMenu(),this.ariaMenu=new Vl(this.getAriaMenuOptions())},focusFirstMenuItem:function(){this.ariaMenu.focusElementByIndex(0)},getAriaMenuOptions:function(){return{callbacks:{onEscape:this.hideOverflow.bind(this),onMenuButtonPress:this.onClick.bind(this),onMenuFocusOut:this.hideOverflow.bind(this)},elements:{menuButton:this.el.querySelector('[role="button"]'),menuContainer:this.overFlowMenu,menuItems:this.overFlowMenu.querySelectorAll("overflow-item > div")}}},hideOverflow:function(){(this.overFlowMenu.classList.remove("enter"),this.overflowVisible=!1,this.$app.getStateMgr().state.isModalVisible)||this.overFlowMenu.parentNode.querySelector("#mainMenuOptions").focus()},hideOverflowWhenClickingOutsideMenu:function(){var e=this;this.onLayoutClickSubscription=Ti.subscribe((function(){e.overflowVisible&&e.hideOverflow()}),"Layout.onClick")},onClick:function(e){var t=this;this.overflowVisible?this.hideOverflow():(this.showOverflow(),setTimeout((function(){t.focusFirstMenuItem()}),500),Ti.publish("overflow.clicked",e)),e.stopPropagation()},removed:function(){this.ariaMenu.destroy(),this.unregisterEventHandlers()},showOverflow:function(){this.overFlowMenu.classList.add("enter"),this.overflowVisible=!0},tagName:"overflow-menu",template:i.n(Nl).a,unregisterEventHandlers:function(){Ti.unsubscribe(this.onLayoutClickSubscription)}},Fl=function(e){return Hl.$app=e,Hl},$l=i(25),ql={tagName:"customer-simple-view",template:i.n($l).a,created:function(){this.container=this.el.querySelector(".bubble-container"),this.childCount=0,this.custNameEl=this.el.querySelector(".msg-info-name span"),this.timeEl=this.el.querySelector(".msg-info-time span"),this.msgInfo=this.el.querySelector(".msg-info.below"),this.lastChid=null},getContainer:function(){return this.container},updateStyleProps:function(){Fi(this.bubbleStyleProps,this.el.firstChild)},render:function(e){this.updateStyleProps(e),this.addBubble(e),this.custNameEl&&(this.custNameEl.innerText=e.getName()),this.timeEl&&(this.timeEl.innerText=Ji(parseInt(e.getTimeStamp(),10),this.format))},setSpeechImage:function(e){if(this.speechView){this.speechCon=this.el.firstChild.querySelector(".speechCont");var t,i=this.speechCon.firstElementChild;switch(this.speechPos){case"bottom":i.classList.add("bottom");break;case"center":i.classList.add("center")}this.customerSpeechConfig&&(t=qi(this.customerSpeechConfig,this.$app)),t?i.style.backgroundImage=t:this.customerSpeechConfig.customerColors&&this.customerSpeechConfig.customerColors.length>0&&(i.style.backgroundColor=this.customerSpeechConfig.customerColors[0],this.customerSpeechConfig.customerInitial&&(i.innerHTML=["<span>",e.getName()[0],"</span>"].join("")))}},insertBubble:function(e){this.addBubble(e,!0)},addBubble:function(e,t){var i=this;e.getIsRestore()?this.paintBubble(e,t):window.raf((function(){i.paintBubble(e,t)}))},paintBubble:function(e,t){var i,n=this;if(i=document.createElement("customer-bubble"),0===this.childCount&&this.setSpeechImage(e),e.getIsRestore()||(this.msgInfo&&this.msgInfo.classList.remove("enter"),this.speechCon&&this.speechCon.classList.remove("enter")),i&&(null==e.getRichData()&&i.setAttribute("messagetext",e.getMessageText()),i.setAttribute("name",e.getName()),i.setAttribute("timestamp",e.getTimeStamp()),i.setAttribute("restore",e.getIsRestore()),t&&this.childCount>0?(this.container.insertBefore(i,this.container.firstElementChild),i.hideBottomInfo(),this.lastChid&&this.lastChid.hideTopInfo()):(this.container.appendChild(i),this.childCount>0&&(this.lastChid&&this.lastChid.hideBottomInfo(),i.hideTopInfo())),null!=e.getRichData())){var s=i.setRichObject(e,e.getRichData());e.setRichInstance(s)}t&&this.childCount>0?i.firstChild.style.marginBottom="".concat(this.bubbleStyleProps.groupedMargin,"px"):this.childCount>0&&(i.firstChild.style.marginTop="".concat(this.bubbleStyleProps.groupedMargin,"px")),e.getIsRestore()||bn.set("infotimer",(function(){n.speechCon&&n.speechCon.classList.add("enter"),n.msgInfo&&n.msgInfo.classList.add("enter")}),25),this.childCount++,this.lastChid=i}},Ul=function(e){ql.$app=e;var t,i=e.getUIConfig(),n={},s={};if(i.transcriptConfig){var a=i.transcriptConfig;t=a.bubbleStyleProperties||{},n.nameStyle=a.customerNameStyles,n.timeStyle=a.dateTimeStyles,n.textAlignment=a.customerTextAlignment||"right",n.customerSpeechConfig=a.customerSpeechAvatarConfig,n.avatarStyle=a.speechAvatarStyles}else t={};s.marginLeft="".concat(t.customerBubbleLeftMargin||100,"px"),s.marginRight="".concat(t.customerBubbleRightMargin||3,"px"),s.marginBottom="".concat(t.customerBubbleBottomMargin||15,"px"),s.groupedMargin=t.groupedBubbleMargin||5,n.bubbleStyleProps=s;var o=i.appConfigProps;return o&&(n.showName=o.displayCustomerName,n.namePos=o.customerNamePosition,n.showTime=o.displayDateAndTime,n.timePos=o.dateTimePosition,n.format=o.timeStampFormat||ee,n.speechView=o.setCustomerSpeechView,n.speechPos=o.speechImgPosition),ql.constants=n,ql},Wl=i(26),Gl={tagName:"agent-simple-view",template:i.n(Wl).a,created:function(){this.container=this.el.querySelector(".bubble-container"),this.childCount=0,this.agentAliasEl=this.el.querySelector(".msg-info-name span"),this.timeEl=this.el.querySelector(".msg-info-time span"),this.msgInfo=this.el.querySelector(".msg-info.below"),this.lastChid=null},getContainer:function(){return this.container},updateStyleProps:function(){Fi(this.bubbleStyleProps,this.el.firstChild)},render:function(e){this.updateStyleProps(e),this.addBubble(e),this.agentAliasEl&&(this.agentAliasEl.innerText=e.getName()),this.timeEl&&(this.timeEl.innerText=Ji(parseInt(e.getTimeStamp(),10),this.format))},setSpeechImage:function(e){this.speechView&&Tl.bind(this)(e)},insertBubble:function(e){this.addBubble(e,!0)},addBubble:function(e,t){var i,n=this;if(i=document.createElement("agent-bubble"),0===this.childCount&&this.setSpeechImage(e),e.getIsRestore()||(this.msgInfo&&this.msgInfo.classList.remove("enter"),this.speechCon&&this.speechCon.classList.remove("enter")),i){var s=e.getRichData();if(null==s||"bubble"!==s.widgetView?(null!=s&&s.showMessageText&&i.setAttribute(j,!0),i.setAttribute("messagetext",e.getMessageText())):i.setAttribute(j,!0),i.setAttribute("name",e.getName()),i.setAttribute("timestamp",e.getTimeStamp()),i.setAttribute("restore",e.getIsRestore()),i.setAttribute("auto",e.isVA()),i.setAttribute("type",e.getMessageBubble()),t&&this.childCount>0?(this.container.insertBefore(i,this.container.firstElementChild),i.hideBottomInfo(),this.lastChid&&this.lastChid.hideTopInfo()):(this.container.appendChild(i),this.childCount>0&&(this.lastChid&&this.lastChid.hideBottomInfo(),i.hideTopInfo())),null!=s&&"bubble"===s.widgetView){var a=i.setRichObject(e.getRichData(),e);e.setRichInstance(a)}else e.isLast()&&(s||i.announceAria(),this.$app.focusMgr.forceInputFocus())}t&&this.childCount>0?i.firstChild.style.marginBottom="".concat(this.bubbleStyleProps.groupedMargin,"px"):this.childCount>0&&(i.firstChild.style.marginTop="".concat(this.bubbleStyleProps.groupedMargin,"px")),e.getIsRestore()||(bn.exists("infotimer")&&!bn.executed("infotimer")&&bn.clear("infotimer")(),bn.set("infotimer",(function(){n.speechCon&&n.speechCon.classList.add("enter"),n.msgInfo&&n.msgInfo.classList.add("enter")}),25)),this.childCount++,this.lastChid=i}},zl=function(e){Gl.$app=e;var t,i=e.getUIConfig(),n={},s={};if(i.transcriptConfig){var a=i.transcriptConfig;t=a.bubbleStyleProperties||{},n.nameStyle=a.agentAliasStyles,n.timeStyle=a.dateTimeStyles,n.agentSpeechConfig=a.agentSpeechAvatarConfig,n.vaSpeechConfig=a.vaSpeechAvatarConfig,n.openerSpeechConfig=a.openerSpeechAvatarConfig,n.avatarStyle=a.speechAvatarStyles}else t={};s.marginLeft="".concat(t.agentBubbleLeftMargin||0,"px"),s.marginRight="".concat(t.agentBubbleRightMargin||100,"px"),s.marginBottom="".concat(t.agentBubbleBottomMargin||15,"px"),s.groupedMargin=t.groupedBubbleMargin||5,n.bubbleStyleProps=s;var o=i.appConfigProps;return o&&(n.showName=o.displayAgentAlias,n.namePos=o.agentAliasPosition,n.showTime=o.displayDateAndTime,n.timePos=o.dateTimePosition,n.format=o.timeStampFormat||ee,n.speechView=o.setAgentSpeechView,n.speechPos=o.speechImgPosition),Gl.constants=n,Gl},Yl=i(27),Xl={tagName:"agent-bubble",template:i.n(Yl).a,created:function(){var e=this;this.ariaUtil=new zn(this.$app),this.bubble=this.el.querySelector(".agent-bubble"),"true"===this.prop.restore||this.$app.getRestoring()?this.bubble.classList.add("enter"):(bn.exists("agentTimer")&&!bn.executed("agentTimer")&&bn.clear("agentTimer")(),bn.set("agentTimer",(function(){e.bubble.classList.add("enter")}),25),this.setAccessibiltyFocus()),this.backgroundImg&&this.udpateBackground(this.backgroundImg)},udpateBackground:function(e){var t=qi(e,this.$app);t&&(this.bubble.style.backgroundImage=t)},onBubbleTouch:function(e){var t,i,n,s=e.target,a=s||{},o=a.tagName,r=void 0===o?"":o,l=a.href,c=void 0===l?"":l,u=a.parentElement,h=void 0===u?{tagName:""}:u,d="a"===r.toLowerCase()&&c,p=null==s?void 0:s.hasAttribute(w),m="a"===h.tagName.toLowerCase(),f=null===(t=this.data.messageText)||void 0===t||null===(i=t.contains)||void 0===i?void 0:i.call(t,"CoBrowseMgr"),g=c.startsWith("javascript:")||(null===(n=h.href)||void 0===n?void 0:n.startsWith("javascript:"));f||g||!(d||p||m)||e.preventDefault()},onBubbleClick:function(e){var t=e.target,i=e.changedTouches;if(i&&document.elementFromPoint(i[0].clientX,i[0].clientY)!=t)return!1;if(t.hasAttribute(w)){var n=function(e){var t={};if("string"==typeof e){var i=e.indexOf("?");if(i>=0)for(var n,s=e.slice(i+1).split("&"),a=0;a<s.length;a++)t[(n=s[a].split("="))[0]]=n[1]}return t}(t.getAttribute(w));this.$app.displayPostChatSurvey(n.surveyID,null,n),e.preventDefault(),Ri()&&this.$app.getBridge().onVirtualKeyboardHidden()}else"true"===this.prop.auto?this.$app.onVALinkClick(e):"a"===t.tagName.toLowerCase()?this.handleLinkClick(t,e):"a"==t.parentElement.tagName.toLowerCase()&&this.handleLinkClick(t.parentElement,e);t.focus()},handleLinkClick:function(e,t){var i;!this.data.messageText.contains("CoBrowseMgr")&&e.href&&(this.logLinks&&El(this.$app,this.logLinks,e.href),i=e,[te,ne,ie].some((function(e){return i.getAttribute(e)}))?this.handleResponsiveHyperLinks(e,t):this.openLink(e,t))},openLink:function(e,t){e.href.startsWith("javascript:")||(this.$app.bridge.pushToFrameSet(e.href,e.target),t.preventDefault())},handleResponsiveHyperLinks:function(e,t){var i,n,s,a=e.getAttribute(te),o=e.getAttribute(ie),r=e.getAttribute(ne),l=e.getAttribute("href");o&&a?(i=this.$app,n=a,s=Sn(s=o),i.sendRichMediaData(n,s)):a?function(e,t){t&&e.onNewCustomerBubble(t)}(this.$app,a):r&&"#"!==l&&""!==l&&function(e,t){t=Sn(t),e.getCIAPIInstance().sendDataPass(t)}(this.$app,r),e.getAttribute("href").startsWith("http")&&this.openLink(e,t),t.preventDefault()},setRichObject:function(e,t){var i=this;if(window.RichMain){this.richInstance=window.RichMain.instance;var n=document.createElement("div"),s=!1,a=this.richMediaReporting;return"true"===this.prop.restore&&!t.isLast()&&(s=void 0===e.lockView||e.lockView,a=!1),xl(this.richInstance,this.$app,e,n,s,a,(function(n){i.setRichMediaAccessibilityFocus(n,e,t)})),Il(this.$app,this.richInstance,this.logLinks),this.namePos==x||this.timePos==x?this.bubble.insertBefore(n,this.bubble.lastElementChild):this.bubble.appendChild(n),this.richInstance}return null},hideBottomInfo:function(){this.gTime&&this.timePos==x&&this.hideTime(),this.gAlias&&this.namePos==x&&this.hideAlias()},hideTopInfo:function(){this.gTime&&this.timePos==E&&this.hideTime(),this.gAlias&&this.namePos==E&&this.hideAlias()},hideTime:function(){var e=this.bubble.querySelector(".msg-info-time span");e&&(e.style.display="none")},hideAlias:function(){var e=this.bubble.querySelector(".msg-info-name span");e&&(e.style.display="none")},messageHasAsyncSurveyLink:function(e){var t=this.$app.isAsyncChat,i=e.includes(w);return t&&i},setRichMediaAccessibilityFocus:function(e,t,i){var n=!1;i.getIsRestore()||(n=this.$app.focusMgr.handleFocusSetting(this.bubble,t.focusSettingMode)),(n||i.isLast())&&this.ariaUtil.announceRichDataMessage(e)},setAccessibiltyFocus:function(){if(this.messageHasAsyncSurveyLink(this.data.messageText))this.$app.focusMgr.focusLinkTag(this.bubble);else{if(this.data.richMedia)return;(parseInt(this.prop.type)===Mi.OPENER_MESSAGE?this.$app.focusMgr.handleFocusWhenChatLaunched(this.bubble,this.$app.focusOnOpen):this.$app.focusMgr.handleFocusSetting(this.bubble,this.focusSettingMode))&&this.announceAria()}},announceAria:function(){this.ariaUtil.announceBubbleText(this.prop.messagetext,this.prop.name)}},Kl=function(e){var t=e.getUIConfig(),i={},n=e.getCIAPIInstance().getDeviceType();if(Xl.$app=e,t.transcriptConfig){var s=t.transcriptConfig;if(i.style=s.agentBubbleStyles,i.nameStyle=s.agentAliasStyles,i.timeStyle=s.dateTimeStyles,i.backgroundImg=s.agentBackgroundImageConfig,s.agentBubbleAfterStyles){var a=On(s.agentBubbleAfterStyles);Ui(document.styleSheets[0],".agent-bubble:after",a)}if(s.agentBubbleBeforeStyles){var o=On(s.agentBubbleBeforeStyles);Ui(document.styleSheets[0],".agent-bubble:before",o)}}var r=t.appConfigProps;return r&&(i.hugging=r.enableHugging,i.showName=r.displayAgentAlias,i.namePos=r.agentAliasPosition,i.showTime=r.displayDateAndTime,i.timePos=r.dateTimePosition,i.gTime=r.enableMsgGroupingDateTime&&r.enableMsgGrouping,i.gAlias=r.enableMsgGroupingAgentAlias&&r.enableMsgGrouping,i.richMediaReporting=r.enableRichMediaReporting,i.logLinks=r.logSelectedLinks,i.focusSettingMode=e.focusOnAgentMessage),i.isMobile="Phone"==n||"Tablet"==n,Xl.data={messageText:function(e){return Gi(e.prop.messagetext||"")},timeText:function(e){return Ji(parseInt(e.prop.timestamp,10),r.timeStampFormat||"HH:mm")},richMedia:function(e){return"true"===e.prop.richmedia}},Xl.constants=i,Xl},Jl=i(28),Ql={tagName:"customer-bubble",template:i.n(Jl).a,created:function(){var e=this;this.ariaUtil=new zn(this.$app),this.bubble=this.el.querySelector(".customer-bubble"),"true"===this.prop.restore||this.$app.getRestoring()?this.bubble.classList.add("enter"):(bn.set("animatetimer",(function(){e.bubble.classList.add("enter")}),25),this.announceAria()),this.backgroundImg&&this.udpateBackground(this.backgroundImg)},udpateBackground:function(e){var t=qi(e,this.$app);t&&(this.bubble.style.backgroundImage=t)},setRichObject:function(e,t){var i=this;if(window.RichMain){this.richInstance=window.RichMain.instance;var n=document.createElement("div"),s="true"===this.prop.restore,a=!!t.customerAction||s,o=t.customerAction?t.receipt:t;return xl(this.richInstance,this.$app,o,n,a,!1,(function(e){s||i.ariaUtil.announceRichDataMessage(e)})),t.customerAction&&!e.getIsRestore()&&bn.set("richRTimer",(function(){i.$app.CIAPIInstance.sendRichContentMessage(e.getMessageText(),t)}),this.richWidgetReceiptTimer),this.namePos==x||this.timePos==x?this.bubble.insertBefore(n,this.bubble.lastElementChild):this.bubble.appendChild(n),this.richInstance}return null},hideBottomInfo:function(){this.gTime&&this.timePos==x&&this.hideTime(),this.gAlias&&this.namePos==x&&this.hideAlias()},hideTopInfo:function(){this.gTime&&this.timePos==E&&this.hideTime(),this.gAlias&&this.namePos==E&&this.hideAlias()},hideTime:function(){var e=this.bubble.querySelector(".msg-info-time span");e&&(e.style.display="none")},hideAlias:function(){var e=this.bubble.querySelector(".msg-info-name span");e&&(e.style.display="none")},announceAria:function(){this.ariaUtil.announceBubbleText(this.prop.messagetext,this.prop.name)}},Zl=function(e){var t=e.getUIConfig(),i={};if(Ql.$app=e,t.transcriptConfig){var n=t.transcriptConfig;if(i.style=n.customerBubbleStyles,i.nameStyle=n.customerNameStyles,i.timeStyle=n.dateTimeStyles,i.backgroundImg=n.customerBackgroundImageConfig,i.textAlignment=n.customerTextAlignment||"right",n.customerBubbleAfterStyles){var s=On(n.customerBubbleAfterStyles);Ui(document.styleSheets[0],".customer-bubble:after",s)}if(n.customerBubbleBeforeStyles){var a=On(n.customerBubbleBeforeStyles);Ui(document.styleSheets[0],".customer-bubble:before",a)}}var o=e.getUIConfig().appConfigProps;return o&&(i.hugging=o.enableHugging,i.showName=o.displayCustomerName,i.namePos=o.customerNamePosition,i.showTime=o.displayDateAndTime,i.timePos=o.dateTimePosition,i.gTime=o.enableMsgGroupingDateTime&&o.enableMsgGrouping,i.gAlias=o.enableMsgGroupingCustomerAlias&&o.enableMsgGrouping),Ql.data={timeText:function(e){return Ji(parseInt(e.prop.timestamp,10),o&&o.timeStampFormat||"HH:mm")}},i.richWidgetReceiptTimer=t.appConfigProps&&t.appConfigProps.richWidgetReceiptTimer||50,Ql.constants=i,Ql},ec=i(29),tc={tagName:"typing-view",template:i.n(ec).a,created:function(){this.ariaUtil=new zn(this.$app),this.typing=this.el.firstChild,this.textEl=this.el.querySelector(".typing-text"),this.updateStyleProps()},updateStyleProps:function(){Fi(this.typingStyleProps,this.el.firstChild)},reload:function(e){this.textEl&&(this.textEl.innerText=e),this.ariaUtil.announceBubbleText(e)},setVisible:function(e,t){!0===e?(this.typing.classList.add("enter"),this.reload(t.getMessageText())):this.typing.classList.remove("enter")}},ic=function(e){tc.$app=e;var t,i={},n=[{animationDelay:".6s"},{animationDelay:".5s"},{animationDelay:".8s"}],s={},a=e.getUIConfig();if(a.transcriptConfig){var o=a.transcriptConfig;i.style=o.typingViewStyles,i.typingElipsisStyles=[];for(var r=o.typingElipsisDotCount||3,l=0;l<r;l++)i.typingElipsisStyles.push(o.typingElipsisStyles&&o.typingElipsisStyles[l]||n[l]);t=a.transcriptConfig.typingStyleProperties||{}}else t={};s.marginLeft="".concat(t.typingLeftMargin||0,"px"),s.marginBottom="".concat(t.typingBottomMargin||15,"px"),s.marginTop="".concat(t.typingTopMargin||5,"px"),i.typingStyleProps=s;var c=a.appConfigProps;return c&&(i.showTypingAnimation=void 0===c.showTypingAnimation||c.showTypingAnimation),tc.constants=i,tc},nc=i(30),sc={tagName:"system-view",template:i.n(nc).a,created:function(){this.ariaUtil=new zn(this.$app),this.cont=this.el.firstChild,this.system=this.cont.querySelector(".system"),Fi(this.systemStyleProps,this.cont)},reload:function(e){},render:function(e){var t,i=this,n=e.getMessageText(),s=this.system.classList,a=this.system.firstElementChild,o=e.getInternalState();switch(this.data.messageText=Gi(n),o){case Je:t=this.styleQ,s.add("system-queue");break;case Ze:t=this.styleE,this.sepHeaderE&&s.add("seperator"),s.add("system-exit");break;case Qe:t=this.styleD,s.add("system-denied");break;case it:t=this.styleL,s.add("system-lost");break;case et:t=this.styleTI,s.add("system-transfer-init");break;case tt:t=this.styleTJ,this.sepHeaderTJ&&s.add("seperator"),s.add("system-transfer-joined");break;case nt:t=this.styleC,this.sepHeaderC&&s.add("seperator"),s.add("system-conference");break;case at:case ot:case st:t=this.styleN,s.add("system-network");break;case lt:t=this.styleL,s.add("system-loading"),this.el.classList.add("loading-view");break;default:t=this.style,s.add("system")}this.setSystemImage(o,a),t&&Fi(t,this.system);var r=!1;this.$app.getRestoring()?(this.show(),r=e.isLast()):(r=!0,bn.exists("animatetimer")&&!bn.executed("animatetimer")&&bn.clear("animatetimer")(),bn.set("animatetimer",(function(){i.show()}),25)),r&&this.ariaUtil.announceBubbleText(n,e.getName())},setSystemImage:function(e,t){if(this.imgConfigs&&this.imgConfigs[e]){var i=qi(this.imgConfigs[e],this.$app);t.style.display=null,i?(t.style.backgroundImage=i,t.classList.add("enter")):t.style.display="none"}else t.style.display="none"},hide:function(){this.system.classList.remove("enter")},show:function(){this.system.classList.add("enter")}},ac=function(e){sc.$app=e;var t,i={},n={},s=e.getUIConfig();if(s.transcriptConfig){var a=s.transcriptConfig;i.style=a.systemViewStyles,i.styleQ=a.systemViewQueueStyles,i.styleE=a.systemViewExitStyles,i.styleD=a.systemViewDeniedStyles,i.styleL=a.systemViewLostStyles,i.styleTI=a.systemViewTransferStartedStyles,i.styleTJ=a.systemViewTransferJoinedStyles,i.styleC=a.systemViewConferenceStyles,i.styleN=a.systemViewNetworkStyles,i.styleL=a.systemViewLoadingStyles,i.iconstyle=a.systemIconStyles,i.sepHeaderTJ=s.appConfigProps&&s.appConfigProps.showSeperatorTransfer,i.sepHeaderE=s.appConfigProps&&s.appConfigProps.showSeperatorExit,i.sepHeaderC=s.appConfigProps&&s.appConfigProps.showSeperatorConference,i.imgConfigs=a.systemImageConfig,t=s.transcriptConfig.systemStyleProperties||{}}else t={};return n.marginLeft="".concat(t.systemLeftMargin||0,"px"),n.marginBottom="".concat(t.systemBottomMargin||15,"px"),n.marginRight="".concat(t.systemRightMargin||5,"px"),n.marginTop="".concat(t.systemTopMargin||0,"px"),i.systemStyleProps=n,sc.constants=i,sc.data={messageText:""},sc},oc=i(31),rc={tagName:"header-view",template:i.n(oc).a,created:function(){this.cont=this.el.firstChild,this.header=this.cont.querySelector(".header"),this.text=this.header.firstElementChild,Fi(this.headerStyleProps,this.cont)},render:function(e){var t=this;window.raf((function(){var i,n=parseInt(e.getTimeStamp(),10),s=new Date(n);i=t.isToday(s)?"Today":t.isYestarday(s)?"Yesterday":Ji(n,t.headerFormat),t.text.innerText=i,t.sepHeader&&t.header.classList.add("seperator")}))},isToday:function(e){var t=new Date;return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()},isYestarday:function(e){var t=new Date;return e.getDate()===t.getDate()-1&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}},lc=function(e){rc.$app=e;var t,i={},n={},s=e.getUIConfig();if(s.transcriptConfig){var a=s.transcriptConfig;i.style=a.headerViewStyles,t=s.transcriptConfig.headerStyleProperties||{},i.sepHeader=s.appConfigProps&&s.appConfigProps.showSeperatorHeader,i.headerFormat=s.appConfigProps&&s.appConfigProps.headerTimeFormat||"month, dd yyyy"}else t={};return n.marginLeft="".concat(t.headerLeftMargin||0,"px"),n.marginBottom="".concat(t.headerBottomMargin||15,"px"),n.marginRight="".concat(t.headerRightMargin||5,"px"),n.marginTop="".concat(t.headerTopMargin||0,"px"),i.headerStyleProps=n,rc.constants=i,rc},cc=i(32);function uc(e,t){var i=document.createElement("option");return i.value=e,i.text=t,i}function hc(e,t){var i=document.createElement("video");return i.setAttribute("playsinline",!0),t&&(i.setAttribute("muted",!0),i.muted=!0),i.setAttribute("autoplay",!0),i.classList.add(e),i}function dc(e,t){e&&t&&e.parentNode.insertBefore(t,e)}var pc={tagName:"close-modal-view",template:i.n(cc).a,initialize:function(e){var t=e.$app,i=e.constants;i.closeText=t.closeConfirmationText,i.closeB1Text=t.closeButton1Text||t.closeModalNegativeButtonText,i.closeB2Text=t.closeButton2Text||t.closeModalPositiveButtonText},created:function(){this.mouseTrap=new xn.a(this.el),this.cancelMouseTrap=new xn.a(this.el.querySelector(".cancel-button")),this.okMouseTrap=new xn.a(this.el.querySelector(".ok-button")),this.modalFooter=this.el.querySelector(".modal-footer"),this.$app.reverseCloseModalButtons&&dc(this.modalFooter.firstElementChild,this.modalFooter.lastElementChild),this.modalFooter.childElementCount>2&&this.modalFooter.classList.add("modal-column-buttons"),this.setAriaReaderText(this.closeText),this.bindKeyboardShortcuts(),this.setModalVisibility(!0),this.el.querySelector(".ok-button").focus()},setAriaReaderText:function(e){this.$app.getStateMgr().setState({ariaReaderSay:e})},setModalVisibility:function(e){this.$app.getStateMgr().setState({isCloseConfirmVisible:e})},bindKeyboardShortcuts:function(){var e=this;this.mouseTrap.bind("escape",(function(){return e.onCancelClick()})),this.cancelMouseTrap.bind(["enter","space"],(function(e){return e.target.click()})),this.okMouseTrap.bind(["enter","space"],(function(e){e.target.click(),e.preventDefault()}))},onCancelClick:function(){this.el.parentElement.removeChild(this.el),En.removeNegativeTabIndexOnClosingModal()},onEndCallClick:function(){var e=document.querySelector("video-stream-view");e?e.endCall():this.$app.shoutui.getLayoutEl().removeVideoCallContainer(ts),this.onCancelClick()},onOkClick:function(){this.$app.isChatDone=!0,this.$app.getCIAPIInstance().closeChat(),this.$app.getStateMgr().setState({state:mt}),En.removeNegativeTabIndexOnClosingModal()},removed:function(){this.mouseTrap.unbind("escape"),this.cancelMouseTrap.unbind(["enter","space"]),this.okMouseTrap.unbind(["enter","space"]),this.setModalVisibility(!1),this.$app.getStateMgr().setState({isModalVisible:!1})}},mc=function(e){pc.$app=e;var t=e.getUIConfig().appStringProps,i={};return i.butstyle=e.getUIConfig().modalButtonStyles,i.modalText=e.getUIConfig().modalTextStyles,i.endCallBtnText=t.endCallText||"End call",i.closeChatAndCallBtnText=t.endCallAndChatText||"End call & chat",pc.constants=i,pc.data={isCallInProgress:function(){return e.isCallInProgress()}},pc},fc=i(33),gc={tagName:"email-modal-view",template:i.n(fc).a,initialize:function(e){var t=e.$app,i=e.constants;i.emailText=t.emailModalInputLabel,i.cancelBtnText=t.emailModalCancelButtonText,i.sendBtnText=t.emailModalSendButtonText,i.okBtnText=t.emailModalOkButtonText,i.mailSentText=t.emailModalMailSentText,i.mailFailText=t.emailModalMailFailText},created:function(){this.mouseTrap=new xn.a(this.el),this.emailInput=this.el.querySelector("input[type='email']"),this.emailInput.focus(),Ri()&&this.emailInput.classList.add("ios"),this.swapFooterButtons(),this.bindKeyboardShortcuts()},removed:function(){this.unBindKeyboardShortcuts(),this.$app.getStateMgr().setState({isModalVisible:!1})},bindKeyboardShortcuts:function(){var e=this;this.mouseTrap.bind("escape",(function(){return e.onCancelClick()})),this.mouseTrap.bind("enter",(function(t){return e.onSendClick(t)}))},unBindKeyboardShortcuts:function(){this.mouseTrap.unbind("escape"),this.mouseTrap.unbind("enter")},onCancelClick:function(){this.el.parentElement.removeChild(this.el),En.removeNegativeTabIndexOnClosingModal()},onSendClick:function(e){e.preventDefault();var t=this.emailInput.value;(this.sendMessageToAriaReader(""),this.validateEmail(t))?(this.$app.CIAPIInstance.requestEmailTranscript(t),this.$app.persistValue(v,1),this.$app.shoutui.disableEmail(),this.data.emailSent=!0,this.sendMessageToAriaReader(this.mailSentText),this.el.querySelector(".js-close-button").focus()):this.setEmailInvalid()},onCloseClick:function(){this.el.parentElement.removeChild(this.el),En.removeNegativeTabIndexOnClosingModal()},onKeyUp:function(e){var t=this,i=e.target.value;this.validateEmail(i)?this.setEmailValid():!this.valTimeout||this.valTimeout.executed()?this.valTimeout=bn.instantiate((function(){t.setEmailInvalid()}),3e3):this.valTimeout.restart()},validateEmail:function(e){return/^[A-Za-z0-9]+([\.-]?\w+)+@\w+([\.-]?\w+)+(\.\w{2,3})+$/.test(e)},setEmailInvalid:function(){this.data.isEmailValid=!1,this.data.errorMsgText=this.mailFailText,this.sendMessageToAriaReader(this.data.errorMsgText)},setEmailValid:function(){this.data.isEmailValid=!0,this.data.errorMsgText="",this.valTimeout&&(this.valTimeout.clear(),this.valTimeout=null)},sendMessageToAriaReader:function(e){this.$app.getStateMgr().setState({ariaReaderSay:e})},updated:function(){this.swapFooterButtons()},swapFooterButtons:function(){if(this.$app.reverseEmailModalButtons){var e=this.el.querySelector(".modal-footer");dc(e.firstElementChild,e.lastElementChild)}}},vc=function(e){gc.$app=e;var t={};return t.btnStyle=e.getUIConfig().modalButtonStyles,t.textStyle=e.getUIConfig().emailModelTextStyles,t.inputStyle=e.getUIConfig().emailModelInputStyles,t.moveEmailCancelBtnToBottom=e.moveEmailCancelBtnToBottom,gc.constants=t,gc.data={emailSent:!1,errorMsgText:"",isEmailValid:!0},gc},yc=i(34),bc={tagName:"info-modal-view",template:i.n(yc).a,initialize:function(e){var t=e.$app;e.constants.closeButtonText=t.getUIConfig().appStringProps.infoModalOkButtonText||M},created:function(){this.mouseTrap=new xn.a(this.el),this.bindKeyboardShortcuts(),this.focusOkButton()},bindKeyboardShortcuts:function(){var e=this;this.mouseTrap.bind("escape",(function(){return e.onOkClick()}))},focusOkButton:function(){this.el.querySelector('.modal-button[ld-on-click="onOkClick"]').focus()},onOkClick:function(){this.el.parentElement.removeChild(this.el),En.removeNegativeTabIndexOnClosingModal()},removed:function(){this.mouseTrap.unbind("escape"),this.$app.getStateMgr().setState({isModalVisible:!1})}},Sc=function(e){bc.$app=e;var t={},i=e.getUIConfig();return t.btnStyles=i.modalButtonStyles,bc.constants=t,bc},wc=i(35),kc={tagName:"disclaimer-view",template:i.n(wc).a,created:function(){this.ariaUtil=new zn(this.$app),this.cont=this.el.firstChild,this.disclaimer=this.cont.querySelector(".disclaimer"),Fi(this.disclaimerStyleProps,this.cont),this.disText=this.disclaimer.lastElementChild,this.icon=this.disclaimer.firstElementChild},render:function(e){var t=e.getMessageText();if(t&&(t=this.ariaUtil.injectAttributes(t),this.disText.innerHTML=Gi(t),this.$app.getRestoring()||this.ariaUtil.announceBubbleText(t)),this.disImgConfig){var i=qi(this.disImgConfig,this.$app);i&&(this.icon.style.backgroundImage=i),this.disImgConfig.text&&this.icon.setAttribute("aria-label",this.disImgConfig.text),i&&this.disImgConfig.text&&this.icon.setAttribute("role","img")}},onItemClick:function(e){"a"===e.target.tagName.toLowerCase()&&(this.$app.bridge.pushToFrameSet(e.target.href,e.target.target),e.preventDefault())}},Cc=function(e){kc.$app=e;var t,i={},n={},s=e.getUIConfig();if(s.transcriptConfig){var a=s.transcriptConfig;i.style=a.disclaimerHeaderViewStyles,i.imgstyle=a.disclaimerHeaderImageStyles,t=a.disclaimerHeaderStyleProperties||{},i.disImgConfig=a.disclaimerHeaderImageConfig}else t={};return n.marginLeft="".concat(t.disclaimerLeftMargin||40,"px"),n.marginBottom="".concat(t.disclaimerBottomMargin||15,"px"),n.marginRight="".concat(t.disclaimerRightMargin||40,"px"),n.marginTop="".concat(t.disclaimerTopMargin||15,"px"),i.disclaimerStyleProps=n,kc.constants=i,kc},Tc=i(36),xc={tagName:"survey-top-bar",template:i.n(Tc).a,created:function(){this.topBarEL=this.el.firstChild,this.overFlowEL=this.topBarEL.querySelector(".overflow-menu-items"),this.overflowVisible=!1;var e=this.$app.getBridge();e&&e.addDrag(this.topBarEL)},onHoverClick:function(e){this.overFlowEL&&(this.overflowVisible=!this.overflowVisible,this.overFlowEL.classList.toggle("enter")),e.stopPropagation()},hideOverflow:function(){this.overflowVisible&&this.overFlowEL&&this.overFlowEL.classList.contains("enter")&&(this.overFlowEL.classList.remove("enter"),this.overflowVisible=!1)}},Ec=function(e){var t=e.getUIConfig();if(xc.$app=e,t.topBarConfig){var i=t.topBarConfig;xc.constants={barStyle:i.topBarStyles,config:i.topBarSettings||{},topBarIconStyle:i.iconStyles,overFlowMenuStyle:i.overFlowMenuStyles}}return xc},Ic=i(37),jc=i.n(Ic),Ac=function(){var e,t;window.document;t=void 0===window.log?function(e,t){console[t||"info"](e)}:window.log;var i=function(){var e=function(e,t){var i=new Error(e+" at character "+t);throw i.index=t,i.description=e,i},t={"-":!0,"!":!0,"~":!0,"+":!0},i={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},n=function(e){var t,i=0;for(var n in e)(t=n.length)>i&&e.hasOwnProperty(n)&&(i=t);return i},s=n(t),a=n(i),o={true:!0,false:!1,null:null},r=function(e){return i[e]||0},l=function(e,t,i){return{type:"||"===e||"&&"===e?"LogicalExpression":"BinaryExpression",operator:e,left:t,right:i}},c=function(e){return e>=48&&e<=57},u=function(e){return 36===e||35===e||95===e||e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||e>=128&&!i[String.fromCharCode(e)]},h=function(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e>=128&&!i[String.fromCharCode(e)]},d=function(n){for(var d,p,m=0,f=n.charAt,g=n.charCodeAt,v=function(e){return f.call(n,e)},y=function(e){return g.call(n,e)},b=n.length,S=function(){for(var e=y(m);32===e||9===e||10===e||13===e;)e=y(++m)},w=function t(){var i,n,s=C();if(S(),63===y(m)){if(m+=1,(i=t())||e("Expected expression",m),S(),58===y(m))return m+=1,(n=t())||e("Expected expression",m),{type:"ConditionalExpression",test:s,consequent:i,alternate:n};e("Expected :",m)}return s},k=function(){S();for(var e=n.substr(m,a),t=e.length;t>0;){if(i.hasOwnProperty(e)&&(!u(y(m))||m+e.length<n.length&&!h(y(m+e.length))))return m+=t,e;e=e.substr(0,--t)}return!1},C=function(){var t,i,n,s,a,o,c,u,h;if(o=T(),!(i=k()))return o;for(a={value:i,prec:r(i)},(c=T())||e("Expected expression after "+i,m),s=[o,a,c];(i=k())&&0!==(n=r(i));){for(a={value:i,prec:n},h=i;s.length>2&&n<=s[s.length-2].prec;)c=s.pop(),i=s.pop().value,o=s.pop(),t=l(i,o,c),s.push(t);(t=T())||e("Expected expression after "+h,m),s.push(a,t)}for(t=s[u=s.length-1];u>1;)t=l(s[u-1].value,s[u-2],t),u-=2;return t},T=function e(){var i,a,o;if(S(),i=y(m),c(i)||46===i)return x();if(39===i||34===i)return E();if(91===i)return L();for(o=(a=n.substr(m,s)).length;o>0;){if(t.hasOwnProperty(a)&&(!u(y(m))||m+a.length<n.length&&!h(y(m+a.length))))return m+=o,{type:"UnaryExpression",operator:a,argument:e(),prefix:!0};a=a.substr(0,--o)}return!(!u(i)&&40!==i)&&A()},x=function(){for(var t,i,n="";c(y(m));)n+=v(m++);if(46===y(m))for(n+=v(m++);c(y(m));)n+=v(m++);if("e"===(t=v(m))||"E"===t){for(n+=v(m++),"+"!==(t=v(m))&&"-"!==t||(n+=v(m++));c(y(m));)n+=v(m++);c(y(m-1))||e("Expected exponent ("+n+v(m)+")",m)}return i=y(m),u(i)?e("Variable names cannot start with a number ("+n+v(m)+")",m):46===i&&e("Unexpected period",m),{type:"Literal",value:parseFloat(n),raw:n}},E=function(){for(var t,i="",n=v(m++),s=!1;m<b;){if((t=v(m++))===n){s=!0;break}if("\\"===t)switch(t=v(m++)){case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:i+=t}else i+=t}return s||e('Unclosed quote after "'+i+'"',m),{type:"Literal",value:i,raw:n+i+n}},I=function(){var t,i=y(m),s=m;for(u(i)?m+=1:e("Unexpected "+v(m),m);m<b&&(i=y(m),h(i));)m+=1;return t=n.slice(s,m),o.hasOwnProperty(t)?{type:"Literal",value:o[t],raw:t}:"this"===t?{type:"ThisExpression"}:{type:"Identifier",name:t}},j=function(t){for(var i,n,s=[],a=!1,o=0;m<b;){if(S(),(i=y(m))===t){a=!0,m+=1,41===t&&o&&o>=s.length&&e("Unexpected token "+String.fromCharCode(t),m);break}if(44===i){if(m+=1,++o!==s.length)if(41===t)e("Unexpected token ,",m);else if(93===t)for(var r=s.length;r<o;r+=1)s.push(null)}else(n=w())&&"Compound"!==n.type||e("Expected comma",m),s.push(n)}return a||e("Expected "+String.fromCharCode(t),m),s},A=function(){var t,i;for(i=40===(t=y(m))?M():I(),S(),t=y(m);46===t||91===t||40===t;)m++,46===t?(S(),i={type:"MemberExpression",computed:!1,object:i,property:I()}):91===t?(i={type:"MemberExpression",computed:!0,object:i,property:w()},S(),93!==(t=y(m))&&e("Unclosed [",m),m++):40===t&&(i={type:"CallExpression",arguments:j(41),callee:i}),S(),t=y(m);return i},M=function(){m+=1;var t=w();if(S(),41===y(m))return m+=1,t;e("Unclosed (",m)},L=function(){return m++,{type:"ArrayExpression",elements:j(93)}},P=[];m<b;)59===(d=y(m))||44===d?m+=1:(p=w())?P.push(p):m<b&&e('Unexpected "'+v(m)+'"',m);return 1===P.length?P[0]:{type:"Compound",body:P}};return d.version="<%= version %>",d.toString=function(){return"JavaScript Expression Parser (JSEP) v"+d.version},d.addUnaryOp=function(e){return s=Math.max(e.length,s),t[e]=!0,this},d.addBinaryOp=function(e,t){return a=Math.max(e.length,a),i[e]=t,this},d.addLiteral=function(e,t){return o[e]=t,this},d.removeUnaryOp=function(e){return delete t[e],e.length===s&&(s=n(t)),this},d.removeAllUnaryOps=function(){return t={},s=0,this},d.removeBinaryOp=function(e){return delete i[e],e.length===a&&(a=n(i)),this},d.removeAllBinaryOps=function(){return i={},a=0,this},d.removeLiteral=function(e){return delete o[e],this},d.removeAllLiterals=function(){return o={},this},d}();function n(){return"ontouchstart"in document.documentElement}function s(e,t){var i=function e(){return e.method.apply(e.scope,arguments)};return i.scope=e,i.method=t,i}function a(e,t,i){this.touchstartX=0,this.touchstartY=0,this.gestureZone=e,this.cb=t,i=i||{};var n=window.innerWidth||document.body.clientWidth;this.threshold=i.threshold||Math.max(1,Math.floor(.01*n)),this.diagonalLimit=i.diagonalLimit||Math.tan(.375*Math.PI),this.touchStartHandler=this.handleTouchStart.bind(this),this.touchEndHandler=this.handleTouchEnd.bind(this),e.addEventListener("touchstart",this.touchStartHandler),e.addEventListener("touchend",this.touchEndHandler)}function o(e,t){function i(i){var n,s,a=e.scrollLeft,r=t.diffx-a,l=performance.now();window.requestAnimationFrame((function t(){n=performance.now(),s=(n-l)/1e3/.7,e.scrollLeft=a+r*function(e){return e<.5?2*e*e:(4-2*e)*e-1}(s),s<1?window.requestAnimationFrame(t):o()})),i.preventDefault(),i.stopPropagation()}function o(){e.scrollLeft+e.clientWidth>=e.scrollWidth-1?(t.next.classList.add("disabled"),t.nextDisabled=!0,0):t.nextDisabled&&(t.next.classList.remove("disabled"),t.nextDisabled=!1),e.scrollLeft>=0&&t.prevDisabled&&(t.prevDisabled=!1,t.prev.classList.remove("disabled")),e.scrollLeft<=1&&(t.prevDisabled=!0,t.prev.classList.add("disabled"),0)}n()&&t.useSwipe&&(t.swipe=new a(e,(function(e,n){"right"==e?(t.diffx=t.getScrollRightSize(),i(n)):(t.diffx=t.getScrollLeftSize(),i(n))}))),t.mouseDownHandler=s(t,(function(e){t.diffx=0,t.diffy=0,e.preventDefault(),e.stopPropagation()})),t.mouseUpPrevHandler=s(t,(function(e){t.diffx=t.getScrollLeftSize(),i(e)})),t.mouseUpNextHandler=s(t,(function(e){t.diffx=t.getScrollRightSize(),i(e)})),t.prev=e.parentElement.querySelector("#prev"),t.next=e.parentElement.querySelector("#next"),t.refresh=function(){o()},o(),t.prev.addEventListener("mousedown",t.mouseDownHandler),t.prev.addEventListener("mouseup",t.mouseUpPrevHandler),t.next.addEventListener("mousedown",t.mouseDownHandler),t.next.addEventListener("mouseup",t.mouseUpNextHandler)}function r(e,t){if("function"==typeof e.closest)return e.closest(t)||null;for(;e;){var i=t.substr(1);if(e.classList.contains(i))return e;e=e.parentElement}return null}function l(e,t){for(var i=e.scrollLeft,n=e.offsetWidth,s=parseInt(window.getComputedStyle(t[0]).width,10),a=t.length-1;a>=0;a--){if(t[a].offsetLeft-i+s<=n){if(a<t.length-1)return t[a+1].offsetLeft;break}}return i}function c(e,t){for(var i=e.scrollLeft,n=e.offsetWidth,s=parseInt(window.getComputedStyle(t[0]).width),a=0;a<t.length;a++){if(t[a].offsetLeft>=i&&a>0)return i-(n-(s-(i-t[a-1].offsetLeft)))}return i}function u(){}function h(){this.clickHandlers={},this.focusHandlers={},this.textHandlers={},this.selectHandlers={}}function d(e,t){var i;u.isObject(e)?(u.copy(e,this),this.isEnabled=!0,this.valid=!0):(this.ctrls=[],e.forEach((function(e){(i=d.createControlInstance(e)).main=t,this.ctrls.push(i)}),this));this.isVisible=!0}function p(e){p.super.call(this,e)}function m(e){this.active=!1,m.super.call(this,e)}function f(e){this.selectedIndex=-1,this.selectedText="",this.selectedValue="",f.super.call(this,e),this.values=void 0!==this.values&&this.values instanceof Array?this.values:[],this.defaultSelected=this.selectedIndex}function g(e){g.super.call(this,e)}function v(e){this.text="",v.super.call(this,e)}a.prototype={handleTouchStart:function(e){this.touchstartX=e.changedTouches[0].screenX,this.touchstartY=e.changedTouches[0].screenY},handleTouchEnd:function(e){var t=e.changedTouches[0].screenX,i=e.changedTouches[0].screenY,n=t-this.touchstartX,s=i-this.touchstartY,a=Math.abs(s/n);(Math.abs(n)>this.threshold||Math.abs(s)>this.threshold)&&a<=this.diagonalLimit&&(n<0?this.cb("right",e):this.cb("left",e))},destroy:function(){this.gestureZone.removeEventListener("touchstart",this.touchStartHandler),this.gestureZone.removeEventListener("touchend",this.touchEndHandler)}},String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,t){var i=t>0?0|t:0;return this.substring(i,i+e.length)===e}}),u.isObject=function(e){return Object(e)===e&&!(e instanceof Array)},u.copy=function(e,t){return Object.getOwnPropertyNames(e).forEach((function(i){var n=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,n)})),t},u.extend=function(e,t){e.superProto=t.prototype,e.prototype=Object.create(e.superProto),e.prototype.constructor=e,e.super=t},u.executeParser=function(e,t){switch(e.type){case"BinaryExpression":case"LogicalExpression":return u.valueComparator(e.operator,u.executeParser(e.left,t),u.executeParser(e.right,t));case"Literal":return e.value;case"MemberExpression":return u.valueMapper(e,t);case"CallExpression":return u.functionParser(e,t);case"UnaryExpression":return!u.executeParser(e.argument,t)}return null},u.valueComparator=function(e,t,i){switch(e){case"==":return t===i;case">":return t>i;case">=":return t>=i;case"<":return t<i;case"<=":return t<=i;case"&&":return t&&i;case"||":return t||i}return null},u.functionParser=function(e,t){return"isEmpty"===e.callee.name?!u.executeParser(e.arguments[0],t):null},u.valueMapper=function(e,t){var i=e.object,n="";if(i&&(n=i.type),"MemberExpression"==n){var s=u.valueMapper(i,t);if(s instanceof v||s instanceof L)return s.text;if(s instanceof m)return s.active;if(s instanceof f){var a=e.property.name;return"selectedText"==a?s.selectedText:"selectedValue"==a?s.selectedValue:"snapShot"==a?s.getSnapShot():s.selectedIndex}if(s instanceof T)return"selectedImage"==e.property.name?s.selectedImage:s.selectedIndex;if(s instanceof P)return"ratingText"==e.property.name?s.ratingText:"selectedText"==e.property.name?s.selectedText:s.selectedRating;if(s instanceof R)return s.active;if(s instanceof G)return s[e.property.name];if(s instanceof U)return"selectedTextValue"==e.property.name?s.selectedTickValue:s.selectedTick;if(s instanceof w||s instanceof b||s instanceof j)return"selectedText"==e.property.name?s.selectedText:s.selectedIndex;if(s instanceof S){if("checkedItemsText"==e.property.name)return s.selectedText;if("item"==e.property.name)return s;var o=parseInt(e.property.name,10);return s.checked[o]}if(s instanceof x){if("selectedDate"==e.property.name)return s.selectedDate;if("rangeStart"==e.property.name)return s.rangeStartDate;if("rangeEnd"==e.property.name)return s.rangeEndDate}else{if(s instanceof D)return s.getColumnForMapper(e.property.name);if(s instanceof O)return s.getRowForMapper(e.property.name);if(s instanceof A)return s.columnSet;if(!(s instanceof Object)||"Column"!=s.type&&"Row"!=s.type)return s instanceof H?s.files.length>0?s.files:null:s;for(var r=0;r<s.items.length;r++)if(e.property.name==s.items[r].id)return s.items[r]}}else if("Identifier"==n){for(var l,c=i.name.slice(1),h=z.getNodefromStore.call(t.sf,c).getControls(),d=0;d<h.length;d++)if(l=h[d].getControl(e.property.name))return l}else if("Identifier"==e.type)return z.getFromStore.call(t.sf,"CS").getConstant(e.name);return null},u.parseValueMapperTemplate=function(e,t){return e&&-1!=e.indexOf("{#")?e.replace(/{#(.*?)}/g,(function(e,n){return"nodeIndex"==n?z.getNodeIndex.call(t.sf,t.dv.currentVisibleNode.id):u.valueMapper(i("#"+n),t)})):e},u.parseValueFromConstant=function(e,t){return e&&"string"==typeof e&&e.startsWith("#")?z.getFromStore.call(t.sf,"CS").getConstant(e):e},h.prototype.registerEventHandler=function(e,t){"onClick"===t?this.clickHandlers[e.id]=e:"onInput"===t?this.textHandlers[e.id]=e:"onChange"===t&&(this.selectHandlers[e.id]=e)},h.prototype.clearListeners=function(){this.clickHandlers={},this.focusHandlers={}},h.prototype.onClick=function(e){var t=e.target.id||e.target.getAttribute("data-id");t&&(-1!==t.indexOf("-")&&(t=t.substr(0,t.indexOf("-"))),this.clickHandlers[t]&&this.clickHandlers[t].onClickEvent(e)),e.stopPropagation()},h.prototype.onInput=function(e){var t=e.target.id;t&&this.textHandlers[t]&&this.textHandlers[t].onInputEvent(e),e.stopPropagation()},h.prototype.onChange=function(e){var t=e.target.id;t&&this.selectHandlers[t]&&this.selectHandlers[t].onSelectEvent(e),e.stopPropagation()},h.prototype.onTouch=function(e){e.target.id;e.stopPropagation()},h.prototype.addDispatcherToContainer=function(e){e.addEventListener("click",this.onClick.bind(this)),e.addEventListener("input",this.onInput.bind(this)),e.addEventListener("change",this.onChange.bind(this))},d.parseControl=function(e,t){if(u.isObject(e)){var i=new d(e.items,t);return e.items=void 0,u.copy(e,i),i}return null},d.prototype.executeValidation=function(){if(this.ctrls){for(var e=0;e<this.ctrls.length;e++)if(!this.ctrls[e].validateControl())return!1;return!0}return this.validateControl()},d.prototype.getOutputText=function(){return""},d.prototype.validateControl=function(){if(this.validation&&this.isVisible)for(var e=Object.keys(this.validation),t=0;t<e.length;t++)if(!this.validate(e[t],this.validation[e[t]]))return this.markElementInvalid(e[t]),!1;var i=this.getLabel();return i&&this.main.th.addToAnswers({id:this.id,val:encodeURIComponent(this.getOutputText()||""),lbl:encodeURIComponent(i),type:this.getType(),ansID:this.getAnswerID()}),!0},d.prototype.getLabel=function(){return this.label||this.hiddenLabel},d.prototype.getType=function(){return 0},d.prototype.getAnswerID=function(){return""},d.prototype.markElementInvalid=function(e){var t=this.main.dv.container.querySelector("#"+this.id);this.addInvalid(t);var i=this.getErrorTag(t,e);i&&(i.classList.add("message-visible"),i.setAttribute("role","alert")),this.actualEl=t,this.valid=!1},d.prototype.getErrorTag=function(e,t){return e.parentNode.querySelector("[data-validation-message="+t+"]")},d.prototype.resetErrors=function(){var e=this.actualEl||this.main.dv.container.querySelector("#"+this.id);this.removeInvalid(e);var t=r(e.parentElement,".nuan-row").querySelector(".message-visible");return t&&(t.classList.remove("message-visible"),t.removeAttribute("role")),this.valid=!0,e},d.prototype.resetData=function(){},d.prototype.resetRendering=function(){},d.prototype.toggleInvalid=function(){},d.prototype.addInvalid=function(){},d.prototype.removeInvalid=function(){},d.prototype.validate=function(){return!0},d.prototype.onVisibilityChange=function(){var e=this.isVisible;(this.isVisible=this.checkVisibleCondition(),e!==this.isVisible)&&(r(this.main.dv.container.querySelector("#"+this.id).parentElement,".nuan-row").classList.toggle("displayoff"),this.isVisible||(this.resetData(),this.event&&(this.main.vh.invokeVisibilityEvent(this.event.name),this.main.edh.invokeEvent(this.event.name)),this.resetRendering()))},d.prototype.onEnableDisableChange=function(){var e=this.isEnabled;if(this.isEnabled=this.checkEnableCondition(),e!==this.isEnabled){var t=this.main.dv.container.querySelector("#"+this.id);t&&(t.disabled=!this.isEnabled)}},d.prototype.registerHandlers=function(){this.visible&&this.main.vh.addToHandler(this),this.enabled&&this.main.edh.addToHandler(this)},d.prototype.invokeHandlers=function(){var e=this.event.name;this.main.vh.invokeVisibilityEvent(e),this.main.edh.invokeEvent(e),this.main.th.handleTransition(e,!0)},d.prototype.invokeCancelHandlers=function(){var e=this.event.name;this.main.vh.invokeVisibilityEvent(e),this.main.edh.invokeEvent(e),this.main.th.handleTransition(e,!1)},d.prototype.invokeResetHandlers=function(){this.main.th.resetCurrrentNode()},d.prototype.checkVisibleCondition=function(){return this.visible&&this.visible.guard&&(this.visible.parsed||(this.visible.parsed=i(this.visible.guard)),this.isVisible=u.executeParser(this.visible.parsed,this.main)),this.isVisible},d.prototype.checkEnableCondition=function(){return this.enabled&&this.enabled.guard&&(this.enabled.parsed||(this.enabled.parsed=i(this.enabled.guard)),this.isEnabled=u.executeParser(this.enabled.parsed,this.main)),this.isEnabled},d.prototype.disable=function(){if(this.ctrls)for(var e=0;e<this.ctrls.length;e++)this.ctrls[e].disable();else{var t=this.main.dv.container.querySelector("#"+this.id);t&&(t.disabled=!0),this.isEnabled=!1}},d.prototype.enable=function(){if(this.ctrls)for(var e=0;e<this.ctrls.length;e++)this.ctrls[e].enable();else if(this.isEnabled){var t=this.main.dv.container.querySelector("#"+this.id);t&&(t.disabled=!1),this.isEnabled=!0}},d.prototype.getHTML=function(e){if(this.ctrls){for(var t,i=[],n=this.ctrls.length,s=0;s<n;s++)(t=this.ctrls[s]).first=0==s,t.last=s==n-1,i.push(t.getHTML(e));return i.join("")}return""},d.prototype.getControl=function(e){if(this.id===e)return this;if(this.ctrls)for(var t=0;t<this.ctrls.length;t++)if(this.ctrls[t].id===e)return this.ctrls[t];return null},d.prototype.addValidationTags=function(){var e=[],t=this.validation;return t&&Object.keys(t).forEach((function(i){e.push("<small data-validation-message="),e.push(i),e.push(">"),e.push(t[i].error),e.push("</small>")}),this),e.join("")},d.prototype.isPlugin=function(){if(this.ctrls)for(var e=0;e<this.ctrls.length;e++)if(this.ctrls[e].isPlugin())return!0;return!1},d.prototype.renderPlugin=function(){if(this.ctrls)for(var e=0;e<this.ctrls.length;e++)this.ctrls[e].renderPlugin()},d.prototype.clear=function(){},d.createControlInstance=function(e,t){if(!u.isObject(e))return new d(e,t);switch(e.type){case"Button":case"ImageButton":return new p(e);case"ToggleButton":return new m(e);case"QuickReplyButton":return new f(e);case"ColorPicker":return new g(e);case"Input":case"ShortInput":return new v(e);case"Heading":return new k(e);case"Paragraph":return new C(e);case"CheckBox":return new S(e);case"RadioButton":return new w(e);case"Select":return new b(e);case"Image":return new T(e);case"ListGroup":return new I(e);case"ListSelectableGroup":return new j(e);case"Calendar":return new x(e);case"Card":return new A(e);case"CardDeck":return new M(e);case"TextArea":return new L(e);case"Rating":return new P(e);case"InputGroup":return new _(e);case"ColumnSet":return new D(e);case"RowSet":return new O(e);case"Switch":return new R(e);case"Box":return new B(e);case"TimePicker":return new V(e);case"LinkPreview":return new N(e);case"FileUpload":return new H(e);case"CoverImage":return new F(e);case"ButtonGroup":return new $(e);case"VideoViewer":return new q(e);case"Slider":return new U(e);case"GMap":return new W(e);case"FormattedLinkText":return new G(e);default:return d.parseControl(e,t)}},d.getContStyleProps=function(e){var t=e.context,i='style="';return"object"===bi()(t)&&(t.itemBackground&&(i+="background:",i+=d.setStyleVal(t.itemBackground),i+="padding:.5em .5em .5em .5em;"),t.itemBorder&&(i+="",i+="border-color:",i+=d.setStyleVal(t.itemBorder),i+="border-radius:",i+=null!=t.itemBorderRadius?t.itemBorderRadius+"px;":".3rem;",i+="border-width:1px;",i+="padding:.5em .5em .5em .5em;",i+=d.getBoxShadow(t)),void 0!==t.itemPadding&&(i+="padding:",i+=t.itemPadding,i+="px;"),void 0!==t.itemPaddingLeft&&(i+="padding-left:",i+=t.itemPaddingLeft,i+="px;"),void 0!==t.itemPaddingRight&&(i+="padding-rght:",i+=t.itemPaddingRight,i+="px;"),t.itemMarginLeft>=0&&(i+="margin-left:",i+=t.itemMarginLeft,i+="px;"),t.itemMarginRight>=0&&(i+="margin-right:",i+=t.itemMarginRight,i+="px;"),e.textAlign=t.textAlign,e.textColor=t.text,e.textSize=t.textSize,e.textStyle=t.textStyle),e.containerSize&&(i+="width:",i+=e.containerSize,i+="px;"),e.containerSpace&&(i+="margin-top:",i+=e.containerSpace,i+="px;"),(e.containerSeperator||e.containerSeparator)&&(i+="border-color:",i+=d.setStyleVal(e.containerSeperator||e.containerSeparator),(e.containerSeperatorSpace||e.containerSeparatorSpace)&&(i+="padding-top:",i+=e.containerSeperatorSpace||e.containerSeparatorSpace,i+="px;")),i+='"'},d.getBoxShadow=function(e){if(e.boxShadow){var t="box-shadow:",i=[e.boxShadow.h+"px",e.boxShadow.v+"px",e.boxShadow.blur?e.boxShadow.blur+"px":"",e.boxShadow.spread?e.boxShadow.spread+"px":"",e.boxShadow.color];return t+=d.setStyleVal(i.join(" "))}return""},d.setStyleVal=function(e){var t=e;return t+=";"},d.prototype.getStyle=function(){var e='style="';return this.textAlign&&(e+="text-align:",e+=d.setStyleVal(this.textAlign)),this.textColor&&(e+="color:",e+=d.setStyleVal(this.textColor)),this.width&&(e+="width:",e+=d.setStyleVal(this.width+"px")),this.height&&(e+="height:",e+=d.setStyleVal(this.height+"px")),(this.background||this.backgroundColor)&&(e+="background:",e+=d.setStyleVal(this.background||this.backgroundColor)),(this.border||this.borderColor)&&(e+="border-color:",e+=d.setStyleVal(this.border||this.borderColor),this.borderWidth?(e+="border-width:",e+=this.borderWidth+"px;"):e+="border-width:1px;",e+="border-style:solid;",e+=d.getBoxShadow(this)),this.borderRadius&&(e+="border-radius:",e+=this.borderRadius+"px;"),this.cardBottom&&(e+="background-color:",e+=d.setStyleVal(this.cardBottom)),this.headerBackground&&(e+="background-color:",e+=d.setStyleVal(this.headerBackground)),this.textSize&&(e+="font-size:",e+=d.setStyleVal(this.textSize+"px")),this.textStyle&&("bold"==this.textStyle?e+="font-weight:":e+="font-style:",e+=d.setStyleVal(this.textStyle)),e+='"'},d.prototype.addPadding=function(){var e="";return this&&(this.marginLeft&&(e="padding-left:"+this.marginLeft+"px;"),this.marginRight&&(e+="padding-right:"+this.marginRight+"px;")),e},d.prototype.encodeLabel=function(e){this.main.dv.getPresentedQuestion().push({id:this.id,lbl:encodeURIComponent(e)})},d.prototype.forceFocus=function(){},d.prototype.getAriaOutput=function(){},d.getImageUrl=function(t){var i=t&&!t.startsWith("http");return e&&e.skinPath&&i?e.skinPath+t:t},d.prototype.setDataFocus=function(e){var t=document.querySelector("[data-focus-id='vaLink']");t&&t.removeAttribute("data-focus-id"),e.setAttribute("data-focus-id","vaLink")},d.prototype.setAriaHiddenText=function(e){return e?" aria-hidden='"+e+"'":""},u.extend(p,d),p.prototype.onClickEvent=function(e){this.isEnabled&&(this.clicked=!0,"cancel"==this.actionType?p.superProto.invokeCancelHandlers.call(this):"reset"==this.actionType?p.superProto.invokeResetHandlers.call(this):this.event&&(p.superProto.invokeHandlers.call(this),this.setDataFocus(e.target)))},p.prototype.registerHandlers=function(){p.superProto.registerHandlers.call(this);var e=this.event;(e&&e.name||"reset"==this.actionType||"ToggleButton"===this.type||"QuickReplyButton"===this.type||"ColorPicker"==this.type||"TimePicker"==this.type)&&this.main.ev.registerEventHandler(this,"onClick")},p.prototype.getHTML=function(){this.registerHandlers(),this.checkEnableCondition();var e=u.parseValueFromConstant(this.text,this.main)||this.text;return this.getContent(this.id,e)},p.prototype.getContent=function(e,t,i,n){var s,a,o,r,l="<Button ",c=this.context||"primary";l+="id=",l+=e,l+=" role='button' class='nuanbtn ";var u="data-id ="+e;switch(this.style){case"outline":l+="nuanbtn-outline-";break;case"block":l+="nuanbtn-block nuanbtn-";break;case"outline-block":l+="nuanbtn-block nuanbtn-outline-";break;default:l+="nuanbtn-"}if(c instanceof Object)switch(c.color&&c.color.startsWith("#")?c.background=c.color:l+=c.color||"primary",s=c.textColor,a=c.titleColor,i&&(c.selectedColor&&(o=c.background,c.background=c.selectedColor),s=c.selectedTextColor||s,a=c.selectedTitleColor||a,c.selectedBorderColor&&(r=c.border,c.border=c.selectedBorderColor)),c.textAlign){case"left":l+=" nuan-text-left"}else l+=c;switch(this.size){case"large":l+=" nuanbtn-lg ";break;default:l+=" nuanbtn-sm "}l+=this.id,this.first&&(l+=" nuanbtn-first","left"==this.align&&(l+=" nuanbtn-first-left")),this.last&&(l+=" nuanbtn-last","right"==this.align&&(l+=" nuanbtn-last-right")),l+="'",c instanceof Object&&(l+=this.getStyle.call(this.context),i&&(c.selectedBorderColor&&(c.border=r),c.selectedColor&&(c.background=o),l+=" aria-pressed='true'")),this.ariaValues&&n>=0&&(l+=" aria-label='",l+=this.ariaValues[n]||"",l+="'"),l+=this.setAriaHiddenText(this.ariaHidden),this.isEnabled&&!this.main.isReloading||(l+=" disabled");var h=[""];function d(e,t,i){var n=[];return n.push("<span ",u," class='"),n.push(i),t&&(n.push("' style='"),n.push("color:"),n.push(t),n.push(";")),n.push("'>"),n.push(e),n.push("</span>"),n.join("")}return this.icon&&Object.keys(this.icon).length>0?(this.icon.position&&"left"!=this.icon.position||h.push(this.getImage(u)),h.push("<span class='nuan-inline-block button-item-center'>")):h.push("<span class='nuan-inline-block'>"),this.title&&(h.push(d(this.title,a,"nuanbtn-label")),h.push("</br>")),h.push(d(t,s,"nuanbtn-text")),h.push("</span>"),this.icon&&this.icon.position&&"right"==this.icon.position&&h.push(this.getImage(u)),l+=[">",h.join(""),"</Button>"].join("")},p.prototype.getImage=function(e){var t=[""];return t.push("<span ",e," class='button-icon ",this.icon.position&&"right"==this.icon.position?"mr-0 ml-2 ":""),t.push(this.icon.name),"center"==this.icon.align&&t.push(" button-item-center "),this.title||this.text||t.push(" mr-0"),t.push("'></span>"),t.join("")},p.prototype.isPlugin=function(){return!!this.setFocus},p.prototype.renderPlugin=function(){if(this.setFocus){var e=this.main.dv.container.querySelector("#"+this.id);if(!e)return!1;e.focus()}return!0},p.prototype.resetData=function(){this.clicked=!1},u.extend(m,p),m.prototype.onClickEvent=function(e){e.target&&(e.target.classList.toggle("active"),this.active=!this.active),this.event&&p.superProto.invokeHandlers.call(this)},u.extend(f,p),f.prototype.onClickEvent=function(e){if(this.isEnabled){var t=e.target.id?e.target.id:e.target.getAttribute("data-id");this.selectedIndex=parseInt(t.match(/\d+$/)[0],10),this.getSelectedText(),p.prototype.onClickEvent.call(this,e),this.event&&0!=Object.keys(this.event).length?(this.selectedIndex=-1,this.selectedText=""):this.setSelectStyle(e)}},f.prototype.setSelectStyle=function(e){var t=this.context;this.selEl&&(this.selEl.style.background=t.color.startsWith("#")?t.color:null,this.selElText.style.color=t.textColor||null,this.selEl.style.borderColor=t.border||null,this.selEl.removeAttribute("aria-pressed")),this.selEl=e.currentTarget.querySelector(["#",this.id,"-",this.selectedIndex].join("")),this.selElText=this.selEl.querySelector(".nuanbtn-text"),t instanceof Object&&this.selEl&&t.selectedColor&&(this.selEl.setAttribute("aria-pressed",!0),this.selEl.style.background=t.selectedColor,t.selectedBorderColor&&(this.selEl.style.borderColor=t.selectedBorderColor),t.selectedTextColor&&this.selElText&&(this.selElText.style.color=t.selectedTextColor))},f.prototype.getOutputText=function(){return this.selectedText},f.prototype.getAnswerID=function(){return this.text[this.selectedIndex]||""},f.prototype.getSelectedText=function(){this.selectedText=this.text[this.selectedIndex],this.selectedValue=this.values[this.selectedIndex]||this.text[this.selectedIndex]},f.prototype.getHTML=function(){var e=this.text instanceof Array?this.text:this.colors instanceof Array?this.colors:this.getFromConstant(this.text||this.colors),t="<div role='group' class='quick-reply-container ";switch(this.align){case"left":t+="quick-reply-left'";break;case"right":t+="quick-reply-right'";break;case"justifyLeft":t+="justify-left'";break;case"justifyRight":t+="justify-right'";break;case"justifyCenter":t+="justify-center'";break;default:t+="'"}this.ariaLabel&&(t+=" aria-label='"+this.ariaLabel+"' "),t+=this.ariaHidden?" aria-hidden='"+this.ariaHidden+"'>":">",this.align=void 0;var i=this.selectedIndex;return this.selectedIndex>=0&&this.getSelectedText(),this.hiddenLabel&&this.encodeLabel(this.hiddenLabel),e.forEach((function(e,n){this.icon=null,this.icons&&n<this.icons.length&&(this.icon=this.icons[n]),this.titles&&n<this.titles.length&&(this.title=this.titles[n]),t+=this.getQuickContent(this.id+"-"+n,n,e,i==n)}),this),t+="</div> ",this.registerHandlers(),this.text=e,t},f.prototype.getQuickContent=function(e,t,i,n){var s="<div class='quick-reply-item'> ";return s+=this.getContent(e,i,n,t),s+="</div> "},f.prototype.isPlugin=function(){return!(-1==this.selectedIndex&&!this.setFocus)},f.prototype.renderPlugin=function(){return this.selEl=this.main.dv.container.querySelector(["#",this.id,"-",-1!=this.selectedIndex?this.selectedIndex:0].join("")),!!this.selEl&&(this.selElText=this.selEl.querySelector(".nuanbtn-text"),this.setFocus&&this.selEl.focus(),!0)},f.prototype.resetData=function(){this.selectedIndex=this.defaultSelected,this.selectedIndex>=0&&this.getSelectedText()},f.prototype.disable=function(){var e=this.main.dv.container.querySelectorAll("."+this.id),t=e.length;this.isEnabled=!1;for(var i=0;i<t;i+=1)e[i].disabled=!0},f.prototype.enable=function(){var e=this.main.dv.container.querySelectorAll("."+this.id),t=e.length;this.isEnabled=!0;for(var i=0;i<t;i+=1)e[i].disabled=!1},f.prototype.getSnapShot=function(){var e=this.text||this.colors,t=this.selectedIndex;return{text:e[t],title:this.titles&&this.titles[t],icon:this.icons&&this.icons[t]}},f.prototype.getFromConstant=function(e){var t=u.parseValueFromConstant(e,this.main);return Array.isArray(t)?(this.text=t,t):(this.icons=[t.icon],this.titles=[t.title],this.text=[t.text],this.text)},f.prototype.getAriaOutput=function(){return{text:this.text.join(". "),length:this.text.length,type:this.type}},u.extend(g,f),g.prototype.getQuickContent=function(e,t,i,n){var s=["<div class='quick-reply-item item' style='border-radius:",this.context.borderRadius,"px;'>"];return this.context.color=i,s.push(this.getContent(e,"",n)),s.push("</div> "),s.join("")},g.prototype.renderPlugin=function(){return this.selEl=this.getSelectedElement(),!!this.selEl&&(this.context.selectedOutlineColor&&(this.selEl.style.borderColor=this.context.selectedOutlineColor),!0)},g.prototype.getSelectedElement=function(){return this.main.dv.container.querySelector(["#",this.id,"-",this.selectedIndex].join("")).parentElement},g.prototype.setSelectStyle=function(){this.selEl&&(this.selEl.style.borderColor=null),this.selEl=this.getSelectedElement(),this.selEl&&this.context.selectedOutlineColor&&(this.selEl.style.borderColor=this.context.selectedOutlineColor)},g.prototype.getSelectedText=function(e){this.selectedText=this.colors[e],this.selectedValue=this.values[e]?this.values[e]:this.colors[e]},u.extend(v,d),v.prototype.onInputEvent=function(e){this.text=e.target.value,this.event&&v.superProto.invokeHandlers.call(this),this.valid||this.resetErrors()},v.prototype.getOutputText=function(){return this.text},v.prototype.registerHandlers=function(){v.superProto.registerHandlers.call(this),this.checkEnableCondition(),this.main.ev.registerEventHandler(this,"onInput")},v.prototype.getType=function(){return 1},v.prototype.getHTML=function(){this.registerHandlers();var e="<fieldset class='nuan-fieldset ";e+="ShortInput"==this.type?"nuan-short-input":"w-100",e+="' style='padding-left:2px;padding-right:2px;padding-top:",e+=this.material?".4em":"2px",e+=";padding-bottom:2px;'",e+=this.ariaHidden?" aria-hidden='"+this.ariaHidden+"'>":">","date"==this.actionType&&(this.placeholder=this.dateFormat||"mm/dd/yyyy",this.monthIndex=0==this.placeholder.toLowerCase().indexOf("mm")?0:1,this.dayIndex=0==this.placeholder.toLowerCase().indexOf("dd")?0:1),this.label&&!this.material?(e+="<label class='nuan-label' for='",e+=this.id,e+="' ",e+=this.getStyle(),e+=">",e+=this.label,e+="</label>",this.encodeLabel(this.label)):this.hiddenLabel&&this.encodeLabel(this.hiddenLabel),e+="<div style='position:relative;"+this.addPadding.call(this.controlContext)+"'><input type='text' class='nuan-input nuan-form-control",e+=this.material?" nuan-form-control-material":"",e+="'",e+=" id=",e+=this.id;var t=this.id+Date.now()+"hlp";return this.helpText?(e+="  aria-describedby='",e+=t,e+="' "):this.ariaLabel&&(e+="  aria-label='",e+=this.ariaLabel,e+="' "),this.placeholder&&!this.material&&(e+=" placeholder='",e+=this.placeholder,e+="'"),this.isEnabled&&!this.main.isReloading||(e+=" disabled"),this.text&&(e+=" value='",e+=this.text,e+="'"),this.material&&(e+=" required"),this.controlContext&&(e+=this.getStyle.call(this.controlContext)),e+="></input><span class='validation-error-icon'></span>",this.material&&(e+="<label class='nuan-label-material' for='",e+=this.id,e+="' ",e+=this.getStyle(),e+=">",e+=this.label,e+="</label>"),e+="</div>",e+=this.addValidationTags(),this.helpText&&(e+="<small class='form-text text-muted' id='",e+=t,e+="'>",e+=this.helpText,e+="</small>"),e+="</fieldset>"},v.prototype.validate=function(e,t){switch(e){case"required":return!!this.text;case"minlength":return this.text.length>=t.length;case"maxlength":return this.text.length<=t.length;case"pattern":return new RegExp(t.value).test(this.text)}return null},v.prototype.toggleInvalid=function(e){e.classList.toggle("invalid")},v.prototype.addInvalid=function(e){e.classList.add("invalid")},v.prototype.forceFocus=function(){this.actualEl.focus(),this.actualEl.scrollIntoView({block:"nearest"})},v.prototype.removeInvalid=function(e){e.classList.remove("invalid")},v.prototype.getErrorTag=function(e,t){return e.parentNode.parentNode.querySelector("[data-validation-message="+t+"]")},v.prototype.resetData=function(){this.text=""},v.prototype.isPlugin=function(){return!("date"!=this.actionType&&!this.material&&!this.setFocus)},v.prototype.renderPlugin=function(){var e=this.main.dv.container.querySelector("#"+this.id);return!!e&&("date"==this.actionType&&(this.dateKeyUp=this.onDateTextKeyDown.bind(this),e.addEventListener("keyup",this.dateKeyUp),this.onDateTextKeyDown(e),this.dateChange=this.onDateChange.bind(this),e.addEventListener("change",this.dateChange)),this.material&&(this.focusLnr=this.onTextFocus.bind(this),e.addEventListener("focus",this.focusLnr),this.blurLnr=this.onTextBlur.bind(this),e.addEventListener("blur",this.blurLnr)),this.setFocus&&e.focus(),!0)},v.prototype.onTextFocus=function(e){var t=this.placeholder;setTimeout((function(){e.target.placeholder=t}),250)},v.prototype.onTextBlur=function(e){e.target.placeholder=""},v.prototype.checkValue=function(e,t){if("0"!==e.charAt(0)||"00"==e){var i=parseInt(e,10);(isNaN(i)||i<=0||i>t)&&(i=1),e=i>parseInt(t.toString().charAt(0),10)&&1==i.toString().length?"0"+i:i.toString()}return e},v.prototype.onDateChange=function(e){this.onDateTextKeyDown(e)},v.prototype.onDateTextKeyDown=function(e){var t;(t=e.target?e.target:e).type="text";var i=t.value,n=e.keyCode||e.charCode;if(8==n||46==n)return!1;/\D\/$/.test(i)&&(i=i.substr(0,i.length-3));var s=i.split("/"),a=i.split("/").map((function(e){return e.replace(/\D/g,"")}));a[this.monthIndex]&&(a[this.monthIndex]=this.checkValue(a[this.monthIndex],12)),a[this.dayIndex]&&(a[this.dayIndex]=this.checkValue(a[this.dayIndex],31));var o=a.map((function(e,t){return 2==e.length&&t<2||-1!=s[t].indexOf("/")?e+" / ":e}));return t.value=o.join("").substr(0,14),!1},v.prototype.clear=function(){var e=this.main.dv.container.querySelector("#"+this.id);this.dateKeyUp&&(e.removeEventListener("input",this.dateKeyUp),e.removeEventListener("change",this.dateChange)),this.material&&(e.removeEventListener("focus",this.focusLnr),e.removeEventListener("blur",this.blurLnr))},v.prototype.resetRendering=function(){var e=this.resetErrors();e&&(e.value="")};var y='a, button, [href], input, select, textarea, span, h4, h3, h2, h1, label,table, tbody, tr, td, [tabindex]:not([tabindex="-1"])';function b(e){this.selectedIndex=-1,b.super.call(this,e),this.header||-1!=this.selectedIndex||(this.selectedIndex=0),this.header&&this.selectedIndex>=0?this.defaultSelected=this.selectedIndex+1:this.defaultSelected=this.selectedIndex}function S(e){this.checked=[],S.super.call(this,e),this.defaultChecked=[].concat(this.checked||[])}function w(e){this.selectedIndex=void 0,w.super.call(this,e),this.defaultSelected=this.selectedIndex}function k(e){k.super.call(this,e)}function C(e){C.super.call(this,e)}function T(e){T.super.call(this,e)}function x(e){this.selectedDate=(new Date).toDateString(),this.rangeStartDate=null,this.rangeEndDate=null,x.super.call(this,e),this.defaultDate=this.selectedDate,this.defaultStart=this.rangeStartDate,this.defaultEnd=this.rangeEndDate}function E(e,t,i,n,s,a,o,r,l){if(this.target=e,this.cb=t,this.version="v1.0-alpha",this.months={0:"January",1:"February",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December"},this.today=new Date,this.currentMonth=this.today.getMonth(),this.currentYear=this.today.getFullYear(),this.selectYear=this.currentYear,this.selectMonth=this.currentMonth,this.selectedDate=i&&new Date(i)||this.today,this.startDate=n&&new Date(n),this.endDate=s&&new Date(s),this.endDate&&(this.endDate.getFullYear()==this.currentYear&&this.endDate.getMonth()<this.currentMonth||this.endDate.getFullYear()<this.currentYear)&&(this.currentMonth=this.endDate.getMonth(),this.currentYear=this.endDate.getFullYear()),this.hasEndReached=!(!s||this.currentMonth!=this.endDate.getMonth()||this.currentYear!=this.endDate.getFullYear()),this.hasBeginReached=!(!n||this.currentMonth!=this.startDate.getMonth()||this.currentYear!=this.startDate.getFullYear()),this.events=[],this.apiUrl=null,this.eventsJSON=[],this.weekend=a,this.isRangeSelector=o,this.isRangeSelector&&(this.selectedDate=null,this.rangeStartDate=r&&new Date(r),this.rangeEndDate=l&&new Date(l),this.ranges=[this.rangeStartDate,this.rangeEndDate]),this.inputs=e.parentElement.querySelectorAll("input[type='text'"),this.inputs.length>0)if(this.selectedDate)x.updateInput(this.inputs[0],this.selectedDate);else for(var c=0;c<this.inputs.length;c++)this.ranges[c]&&x.updateInput(this.inputs[c],this.ranges[c])}function I(e){this.selectedIndex=-1,I.super.call(this,e),this.defaultSelected=this.selectedIndex}function j(e){this.selectable=!0,j.super.call(this,e)}function A(e){A.super.call(this,e)}function M(e){M.super.call(this,e)}function L(e){L.super.call(this,e)}function P(e){this.selectedRating=-1,P.super.call(this,e)}function _(e){_.super.call(this,e)}function D(e){D.super.call(this,e)}function O(e){O.super.call(this,e)}function R(e){R.super.call(this,e),this.defaultStatus=this.active}function B(e){B.super.call(this,e)}function V(e){V.super.call(this,e)}function N(e){N.super.call(this,e)}function H(e){H.super.call(this,e),this.files=[]}function F(e){F.super.call(this,e)}function $(e){$.super.call(this,e)}function q(e){q.super.call(this,e)}function U(e){this.selectedTick=0,U.super.call(this,e),this.defaultTick=this.selectedTick}function W(e){W.super.call(this,e)}function G(e){G.super.call(this,e)}function z(){this.nodeStore=[],this.transitionStore=[],this.constantStore=null}function Y(e,t){this.id=e.id;var i,n=this;this.controls=[],this.context=e.context,Object.keys(e.controls||{}).forEach((function(s){(i=d.createControlInstance(e.controls[s],t))&&(n.controls.push(i),i.main=t)}))}function X(){this.controls={}}function K(){this.controls={}}u.extend(b,d),b.prototype.onSelectEvent=function(e){e.target&&(this.selectedIndex=e.target.selectedIndex,this.header&&(this.selectedIndex-=1),this.selectedText=e.target.value||this.items[this.selectedIndex],this.event&&b.superProto.invokeHandlers.call(this),this.valid||this.resetErrors())},b.prototype.onClick=function(e){var t=this,i="<div class='select-modal' role='dialog' aria-modal='true'";this.label&&(i+="aria-labelledby='"+this.labelId),i+=">",i+="<div class='modal-child'>";var n=new j({header:this.header,items:this.items,selectedIndex:this.selectedIndex,closeList:!0,id:this.id+"modal",resultCallback:function(){var e=r(n.el,".select-modal");t.removeNegativeTabIndexOnClosingModal(),e.parentElement.removeChild(e),-1!=n.selectedIndex&&(t.selectedIndex=n.selectedIndex,t.selectedText=t.values&&t.values.length>t.selectedIndex?t.values[t.selectedIndex]:t.items[t.selectedIndex],t.el.innerText=t.items[t.selectedIndex],t.event&&b.superProto.invokeHandlers.call(t)),t.el.setAttribute("aria-expanded","false"),t.el.focus(),n.clear(),t.valid||t.resetErrors()}});n.main=this.main,i+=n.getHTML(),i+="</div>",this.main.dv.container.firstElementChild.insertAdjacentHTML("beforeend",i);setTimeout((function e(){n.renderPlugin()||setTimeout(e,25)}),25),this.setFocusWithinModalWindow(),this.el.setAttribute("aria-expanded","true"),e.preventDefault()},b.prototype.getOutputText=function(){return this.selectedText},b.prototype.getAnswerID=function(){return this.items[this.selectedIndex]||""},b.prototype.registerHandlers=function(){b.superProto.registerHandlers.call(this),this.main.ev.registerEventHandler(this,"onChange")},b.prototype.getHTML=function(){this.checkEnableCondition();var e="<fieldset class='nuan-fieldset w-100'";e+=this.ariaHidden?" aria-hidden='"+this.ariaHidden+"'>":">";var t=this.items||[],i=this.values||t,s=this.selectedIndex>t.length-1?t.length-1:this.selectedIndex;return this.selectedIndex=s,this.labelId=this.id?this.id+"_label'":"",this.label?(e+="<label class='nuan-label' for='",e+=this.id+"' ",e+=this.getStyle(),this.id&&(e+="id='"+this.labelId),e+=">",e+=this.label,e+="</label>",this.encodeLabel(this.label)):this.hiddenLabel&&this.encodeLabel(this.hiddenLabel),this.modalView&&n()?(e+="<div role='button' tabindex='0' aria-haspopup='listbox' class='nuan-custom-select' "+this.getControlStyles()+" id="+this.id,(this.ariaLabel||this.helpText)&&(e+=" aria-label='"+(this.ariaLabel||this.helpText)+"'"),e+="> ",e+=this.header||this.items[0]):(e+="<div class='nuan-custom-select' "+this.getControlStyles()+">",e+="<select class='nuan-select' id=",e+=this.id,this.isEnabled&&!this.main.isReloading||(e+=" disabled"),(this.ariaLabel||this.helpText)&&(e+=" aria-label='"+(this.ariaLabel||this.helpText)+"'"),e+="> ",this.header&&(e+="<option value=''>",e+=this.header,e+="</option>"),-1!=s&&(this.selectedText=i.length>s?i[s]:t[s]),t.forEach((function(t,n){e+="<option ",i.length>n&&(e+="value='",e+=i[n],e+="'"),n===s&&(e+=" selected "),e+=">",e+=t,e+="</option>"})),e+="</select>"),e+="<span class='validation-error-icon'></span></div>",e+=this.addValidationTags(),this.helpText&&(e+="<small class='form-text text-muted'>",e+=this.helpText,e+="</small>"),e+="</fieldset>",this.registerHandlers(),e},b.prototype.isPlugin=function(){return!(!this.setFocus&&!this.modalView)},b.prototype.renderPlugin=function(){var e=this.main.dv.container.querySelector("#"+this.id);return!!e&&(this.setFocus&&e.focus(),this.modalView&&(this.onClickHandler=s(this,this.onClick),this.el=e,n()&&e.addEventListener("click",this.onClickHandler)),!0)},b.prototype.getControlStyles=function(){var e="";return this.controlContext&&(e=this.getStyle.call(this.controlContext),e+=this.addPadding.call(this.controlContext)),e},b.prototype.validate=function(){return!this.header||-1!=this.selectedIndex},b.prototype.addInvalid=function(e){e.parentNode.classList.add("invalid")},b.prototype.forceFocus=function(){this.actualEl.focus(),this.actualEl.scrollIntoView({block:"nearest"})},b.prototype.removeInvalid=function(e){e.parentNode.classList.remove("invalid")},b.prototype.resetData=function(){this.selectedIndex=this.defaultSelected,this.selectedText=""},b.prototype.resetRendering=function(){var e=this.resetErrors();e&&(e.selectedIndex=-1==this.defaultSelected?0:this.defaultSelected)},b.prototype.clear=function(){this.el&&this.el.addEventListener("click",this.onClickHandler)},b.prototype.getErrorTag=function(e,t){return e.parentNode.parentNode.querySelector("[data-validation-message="+t+"]")},b.prototype.setFocusWithinModalWindow=function(e){for(var t,i=(e||document.querySelector(".select-modal")).querySelectorAll(y),n=document.querySelectorAll(y),s=0;s<n.length;s++)"-1"!=(t=n[s].getAttribute("tabindex")||0)&&(n[s].setAttribute("tabindex","-1"),n[s].setAttribute("aria-hidden","true"),n[s].setAttribute("data-original-index",t));for(var a=0;a<i.length;a++)i[a].hasAttribute("tabindex")&&(i[a].setAttribute("tabindex",a),i[a].removeAttribute("aria-hidden"))},b.prototype.removeNegativeTabIndexOnClosingModal=function(){for(var e,t=document.querySelectorAll("[data-original-index]"),i=0;i<t.length;i++)e=t[i].getAttribute("data-original-index"),t[i].setAttribute("tabindex",e),t[i].removeAttribute("data-original-index"),t[i].removeAttribute("aria-hidden")},u.extend((function e(t){e.super.call(this,t)}),b),u.extend(S,d),S.prototype.onClickEvent=function(e){if(e.target){var t=parseInt(e.target.id.substr(-1,1),10);this.checked[t]=e.target.checked,this.event&&S.superProto.invokeHandlers.call(this),this.getSelectedText(),this.valid||this.resetErrors()}},S.prototype.getOutputText=function(){return this.selectedText},S.prototype.getSelectedText=function(){for(var e="",t=0;t<this.values.length;t++)this.checked[t]&&(e&&(e+=","),e+=this.values[t]);this.selectedText=e},S.prototype.getLabel=function(){for(var e="",t=0;t<this.checked.length-1;t++)this.checked[t]&&(e&&(e+=","),e+=this.label||this.hiddenLabel);return e},I.prototype.getAnswerID=function(){for(var e,t=0;t<this.checked.length-1;t++)this.checked[t]&&(e&&(e+=","),e+=this.items[t]);return e},S.prototype.registerHandlers=function(){S.superProto.registerHandlers.call(this),this.main.ev.registerEventHandler(this,"onClick")},S.prototype.getHTML=function(){this.checkEnableCondition();var e="<fieldset class='nuan-fieldset w-100' role='group' id=";e+=this.id,this.isEnabled&&!this.main.isReloading||(e+=" disabled"),(this.ariaLabel||this.helpText)&&(e+=" aria-label='"+(this.ariaLabel||this.helpText)+"'"),e+=this.setAriaHiddenText(this.ariaHidden),e+="> ";var t=this.values||[];this.label?(e+="<label class='nuan-label' ",e+=this.getStyle(),e+=">",e+=this.label,e+="</label>",this.encodeLabel(this.label)):this.hiddenLabel&&this.encodeLabel(this.hiddenLabel),this.selectedText="";var i="";return this.items.forEach((function(n,s){i=this.id+"-"+Date.now()+s,e+="<label class='nuan-check-label' for='"+i+"' style='"+this.addMargin()+"'><input type='checkbox' id='",e+=i,e+="' ",t.length>s&&(e+="value='",e+=t[s],e+="'"),this.checked.length>s&&this.checked[s]&&(e+=" checked",this.selectedText&&(this.selectedText+=","),this.selectedText+=t.length>s?t[s]:""),e+="> ",e+=n,e+="<span class='nuan-checkbox'></span></label>"}),this),e+=this.addValidationTags(),this.helpText&&(e+="<small class='form-text text-muted'>",e+=this.helpText,e+="</small>"),e+="</fieldset>",this.registerHandlers(),e},S.prototype.isPlugin=function(){return!!this.setFocus},S.prototype.renderPlugin=function(){var e=this.main.dv.container.querySelector("#"+this.id);return!!e&&(this.els||(this.els=e.querySelectorAll("input[type='checkbox']")),this.els[0].focus(),!0)},S.prototype.validate=function(){return this.checked.some((function(e){return!!e}))},S.prototype.resetData=function(){this.checked=[].concat(this.defaultChecked||[]),this.getSelectedText()},S.prototype.addInvalid=function(e){for(var t=this.boxEls||e.querySelectorAll(".nuan-checkbox"),i=0;i<t.length;i++)t[i].classList.add("invalid");this.boxEls=t},S.prototype.forceFocus=function(){var e=this.actualEl.parentElement;e.firstElementChild.focus(),e.scrollIntoView({block:"nearest"})},S.prototype.removeInvalid=function(e){for(var t=this.boxEls||e.querySelectorAll(".nuan-checkbox"),i=0;i<t.length;i++)t[i].classList.remove("invalid");this.boxEls=t},S.prototype.addMargin=function(){var e="";return this.controlContext&&this.controlContext.marginLeft&&(e="margin-left:"+this.controlContext.marginLeft+"px;"),e},S.prototype.resetRendering=function(){var e=this.resetErrors();this.els||(this.els=e.querySelectorAll("input[type='checkbox']"));for(var t=0;t<this.els.length;t++)this.defaultChecked[t]?this.els[t].checked=!0:this.els[t].checked=!1},u.extend(w,d),w.prototype.onClickEvent=function(e){e.target&&(this.selectedIndex=parseInt(e.target.id.substr(-1,1),10),this.selectedText=e.target.value||this.options[this.selectedIndex],this.event&&w.superProto.invokeHandlers.call(this),this.valid||this.resetErrors())},w.prototype.getOutputText=function(){return this.selectedText},w.prototype.registerHandlers=function(){w.superProto.registerHandlers.call(this),this.main.ev.registerEventHandler(this,"onClick")},w.prototype.getAnswerID=function(){return this.options&&this.options[this.selectedIndex]||""},w.prototype.getHTML=function(){this.checkEnableCondition();var e="<fieldset class='nuan-fieldset w-100' role='group' id=";e+=this.id,this.isEnabled&&!this.main.isReloading||(e+=" disabled"),(this.ariaLabel||this.helpText)&&(e+=" aria-label='"+(this.ariaLabel||this.helpText)+"'"),e+=this.setAriaHiddenText(this.ariaHidden),e+="> ";var t=this.options||[],i=t.length-1,n=this.values||[],s=!!this.validation,a=this.selectedIndex;if(a>=0&&(a=a>i?i:a,this.selectedIndex=a,this.selectedText=n.length>a?n[a]:t[a]),this.name){this.label?(e+="<label class='nuan-label' ",e+=this.getStyle(),e+=">",e+=this.label,e+="</label>",this.encodeLabel(this.label)):this.hiddenLabel&&this.encodeLabel(this.hiddenLabel);var o=Date.now(),r="";if(this.layout&&this.layout.startsWith("inline")){var l=!(!this.buttonLayout||"vertical"!=this.buttonLayout);e+="<div class="+(-1!=this.layout.indexOf("Grow")?"nuan-flex":"non-flex")+" style='"+this.addPadding.call(this.controlContext)+"'>",n.forEach((function(i,a){r=this.id+"-"+o+a,e+="<label for="+r+" class='nuan-radio-hori-cont'>",e+=this.getInputEl(a,n,s,r),l&&(e+="<span class='text-above'>"+(t[a]||"")+"</span>"),e+="<span class='nuan-radio'></span>",!l&&t[a]&&(e+="<span>"+t[a]+"</span>"),e+="</label>"}),this),e+="</div>"}else t.forEach((function(i,a){r=this.id+"-"+o+a,e+="<label class='nuan-radio-label' for="+r+" style='"+this.addPadding.call(this.controlContext)+"'>",e+=this.getInputEl(a,n,s,r),e+="<span class='nuan-radio'></span>",e+="<span>"+(t[a]||"")+"</span>",e+="</label>"}),this);return e+=this.addValidationTags(),this.helpText&&(e+="<small class='form-text text-muted'>",e+=this.helpText,e+="</small>"),e+="</fieldset>",this.registerHandlers(),e}},w.prototype.getInputEl=function(e,t,i,n){var s="<input type='radio' class='nuan-radio' id='";return s+=n,s+="' name='",s+=this.name,s+="' ",t.length>e&&(s+="value='",s+=t[e],s+="'"),e===this.selectedIndex&&(s+=" checked "),i&&(s+=" required"),this.ariaValues&&(s+=" aria-label='",s+=this.ariaValues[e]||"",s+="'"),s+=">"},w.prototype.isPlugin=function(){return!!this.setFocus},w.prototype.renderPlugin=function(){return this.queryAllButtons(),!(!this.els||0==this.els.length)&&(this.els[0].focus(),!0)},w.prototype.validate=function(){return-1!=this.selectedIndex&&void 0!==this.selectedIndex},w.prototype.addInvalid=function(e){this.radios=this.radios||e.querySelectorAll("span.nuan-radio");for(var t=0;t<this.radios.length;t++)this.radios[t].classList.add("invalid");e.parentElement.firstElementChild.focus()},w.prototype.forceFocus=function(){var e=this.actualEl.parentElement;e.firstElementChild.focus(),e.scrollIntoView({block:"nearest"})},w.prototype.removeInvalid=function(e){if(this.radios)for(var t=0;t<this.radios.length;t++)this.radios[t].classList.remove("invalid")},w.prototype.resetData=function(){this.selectedIndex=this.defaultSelected,this.selectedIndex>=0&&(this.selectedText=this.values[this.selectedIndex]||this.options[this.selectedIndex])},w.prototype.resetRendering=function(){this.queryAllButtons(),this.resetCheckedState(),this.resetErrors()},w.prototype.resetCheckedState=function(){for(var e=0;e<this.els.length;e++)this.els[e].checked=this.defaultSelected===e},w.prototype.queryAllButtons=function(){this.els||(this.els=this.main.dv.container.querySelectorAll("input[type='radio'][name='"+this.name+"']"))},u.extend(k,d),k.prototype.getHTML=function(){var e=this.level||"6",t="<h";return t+=e,t+="  class='nuan-heading",t+="'",t+=this.getStyle(),t+=this.setAriaHiddenText(this.ariaHidden),t+=">",this.text=u.parseValueMapperTemplate(this.text,this.main),t+=this.text,t+="</h",t+=e,t+=">"},k.prototype.getAriaOutput=function(){return{text:this.text}},u.extend(C,d),C.prototype.registerHandlers=function(){C.superProto.registerHandlers.call(this)},C.prototype.getHTML=function(){var e="<p ";return this.id&&(e+="id="+this.id),e+=" class='nuan-para' ",e+=this.getStyle(),e+=this.setAriaHiddenText(this.ariaHidden),e+=">",this.text=u.parseValueMapperTemplate(this.text,this.main),e+=this.text,e+="</p>",this.hiddenLabel&&this.encodeLabel(this.hiddenLabel),this.registerHandlers(),e},C.prototype.getAriaOutput=function(){var e={text:this.text};return this.accessibilityReader&&(e.accessibilityReader=this.accessibilityReader),e},u.extend(T,d),T.prototype.onClickEvent=function(e){e.target&&this.isEnabled&&(this.selectedIndex=parseInt(e.target.getAttribute("data-index").substr(-1,1),10),this.selectedImage=this.src[this.selectedIndex],this.event&&T.superProto.invokeHandlers.call(this))},T.prototype.registerHandlers=function(){this.event&&this.main.ev.registerEventHandler(this,"onClick")},T.prototype.getOutputText=function(){return this.selectedImage||""},T.prototype.getHTML=function(){if(this.registerHandlers(),"string"==typeof this.src)return this.getImage(this.src);var e="horizontal"===this.layout?"<div class='nuan-img-cont-scroll'":"<div class='nuan-img-cont-wrap'";e+=this.setAriaHiddenText(this.ariaHidden),e+=" id=",e+=this.id,e+=">";var t=0;return this.src.forEach((function(i){e+=this.getImage(u.parseValueFromConstant(i,this.main),t),t+=1}),this),e+="</div>","horizontal"==this.layout&&(e+="<nav class='carousel-nav'",e+=this.setAriaHiddenText(this.ariaHidden),e+="><button class='disabled prev' id='prev' role='button'><i class='arrow-left icon'></i><span class='sr-only'>Previous</span></button><button class='next' id='next' role='button'><i class='arrow-right icon'></i><span class='sr-only'>Next</span></button></nav>"),this.hiddenLabel&&this.id&&this.encodeLabel(this.hiddenLabel),e},T.prototype.getImage=function(e,t){var i="<div class='img-thumbnail-cont mt-2'><img class='img-thumbnail nuan-image' src=";return i+=d.getImageUrl(e),i+=" data-id=",i+=this.id,this.event&&(i+=" role='button'"),i+=" data-index=",i+=t,this.size?(this.size.width&&(i+=" width=",i+=this.size.width),i+=" height=",this.size.height?i+=this.size.height:i+=this.size.width/1.33,i+="></img></div>"):""},T.prototype.removeEventHandlers=function(){},T.prototype.isPlugin=function(){return"horizontal"===this.layout},T.prototype.renderPlugin=function(){if(!this.main.isReloading&&this.id){if(this.el=this.main.dv.container.querySelector("#"+this.id),!this.el)return!1;o(this.el,this),this.imgsEls=this.el.children}return!0},T.prototype.getScrollRightSize=function(){return l(this.el,this.imgsEls)},T.prototype.getScrollLeftSize=function(){return c(this.el,this.imgsEls)},T.prototype.getItemSize=function(){return this.stepSize||14},T.prototype.disable=function(){this.isEnabled=!1,this.clear()},T.prototype.enable=function(){this.isEnabled=!0,o(this.el,this)},T.prototype.clear=function(){this.prev&&(this.prev.removeEventListener("mousedown",this.mouseDownHandler),this.prev.removeEventListener("mouseup",this.mouseUpPrevHandler)),this.next&&(this.next.removeEventListener("mousedown",this.mouseDownHandler),this.next.removeEventListener("mouseup",this.mouseUpNextHandler)),this.next=null,this.prev=null,this.mouseDownHandler=null,this.mouseUpPrevHandler=null,this.mouseUpNextHandler=null,this.nextDisabled=this.prevDisabled=!1},u.extend(x,d),x.prototype.onClickEvent=function(){},x.prototype.isPlugin=function(){return!0},x.prototype.getOutputText=function(){return this.selectedDate},x.prototype.getHTML=function(){var e=["<div class='nuan-cal-cont mt-2'"];if(this.ariaHidden&&e.push(this.setAriaHiddenText(this.ariaHidden)),e.push(">"),this.label?(e.push("<label class='nuan-label' "),e.push(this.getStyle()),e.push(">"),e.push(this.label),e.push("</label>"),this.encodeLabel(this.label)):this.hiddenLabel&&this.encodeLabel(this.hiddenLabel),this.dateInputs){e.push("<div class='nuan-row container-positioning-center mb-2'");var t=d.createControlInstance(this.dateInputs,this.main);e.push(d.getContStyleProps(t)),e.push(">"),t.main=this.main,e.push(t.getHTML()),e.push("</div>"),this.dateInputs=t}return e.push("<div class='nuan-calendar",this.main.isReloading?" disabled' ":"' ","id=",this.id,"></div></div>"),e.join("")},x.prototype.renderPlugin=function(){var e=this,t=this.main.dv.container.querySelector("#"+this.id);return!!t&&(this.dateInputs&&this.dateInputs.renderPlugin(),this.iCal=new E(t,(function(t,i){e.rangeSelect?(e.rangeStartDate=t,e.rangeEndDate=i):e.selectedDate=t}),this.selectedDate,this.startDate,this.endDate,this.allowedWeekends,this.rangeSelect,this.rangeStartDate,this.rangeEndDate),this.iCal.render(),this.main.isReloading||this.iCal.eventHandler(),!0)},x.prototype.clear=function(){this.iCal.clear(),this.iCal.target=null},x.prototype.resetData=function(){this.selectedDate=this.defaultDate,this.rangeStartDate=this.defaultStart,this.rangeEndDate=this.defaultEnd},x.prototype.enable=function(){this.iCal.target.classList.remove("disabled"),this.iCal.eventHandler()},x.prototype.disable=function(){this.iCal.target.classList.add("disabled"),this.iCal.clear()},x.updateInput=function(e,t){var i;e&&(e.value=t.toLocaleDateString(void 0,{year:"numeric",month:"2-digit",day:"2-digit"}),"function"==typeof Event?i=new Event("change"):(i=document.createEvent("Event")).initEvent("change",!0,!0),e.dispatchEvent(i),e.setAttribute("disabled",!0))},E.prototype.render=function(){var e='<div class="cal"><div class="header"><button class="left button prev"><span class="" id="prev"> &lang; </span></button><span class="month-year" id="label"> June 2020 </span><button class="next right button';e+=this.hasEndReached?" disabled":"",e+='"><span class="" id="next"> &rang; </span></button></div>',e+='<table class="days"><td',e+=this.weekend?' class="weekday"':"",e+='>sun</td><td class="weekday">mon</td><td class="weekday">tue</td><td class="weekday">wed</td><td class="weekday">thu</td><td class="weekday">fri</td><td',e+=this.weekend?' class="weekday"':"",e+=">sat</td></table>",e+='<div class="cal-frame"><table class="curr"><tbody id="calendar-body"></tbody></table></div>',e+="</div>",this.target.innerHTML=e,this.updateCalendar(this.currentMonth,this.currentYear)},E.prototype.updateCalendar=function(e,t){var i=new Date(t,e).getDay(),n=this.target.querySelector("#calendar-body");n.innerHTML="",this.target.querySelector("#label").innerHTML=this.months[e]+" "+t;for(var s,a,o,r=1,l=0;l<6;l++){for(var c=document.createElement("tr"),u=0;u<7;u++)if(0===l&&u<i)(s=document.createElement("td")).classList.add("nil"),a=document.createTextNode(""),(o=document.createElement("div")).setAttribute("class","day"),o.appendChild(a),s.appendChild(o),c.appendChild(s);else{if(r>this.daysInMonth(e,t))break;s=document.createElement("td"),a=document.createTextNode(r),(o=document.createElement("div")).setAttribute("class","day");var h=document.createElement("button"),d=this.currentMonth,p=new Date(this.currentYear,d,r);h.setAttribute("data-id",p.toDateString()),h.setAttribute("class","calendarLink"),h.appendChild(a),o.appendChild(h),r===this.today.getDate()&&t===this.today.getFullYear()&&e===this.today.getMonth()&&o.classList.add("today"),this.selectedDate&&r===this.selectedDate.getDate()&&t===this.selectedDate.getFullYear()&&e===this.selectedDate.getMonth()&&h.classList.add("selected-link"),!this.weekend&&this.isWeekend(this.currentYear,this.currentMonth,r)&&h.classList.add("weekend"),(this.hasEndReached&&r>this.endDate.getDate()||this.hasBeginReached&&r<this.startDate.getDate())&&h.classList.add("outofrange"),this.isRangeSelector&&this.setRangeColor(p,h,s),s.appendChild(o),c.appendChild(s),r++}n.appendChild(c)}},E.prototype.setRangeColor=function(e,t){e>this.rangeStartDate&&e<this.rangeEndDate?t.classList.add("selected-range-link"):this.rangeStartDate&&e.getDate()===this.rangeStartDate.getDate()&&e.getMonth()===this.rangeStartDate.getMonth()&&e.getFullYear()===this.rangeStartDate.getFullYear()?(t.classList.add("selected-link"),t.classList.add("rangestart")):this.rangeEndDate&&e.getDate()===this.rangeEndDate.getDate()&&e.getMonth()===this.rangeEndDate.getMonth()&&e.getFullYear()===this.rangeEndDate.getFullYear()&&(t.classList.add("selected-link"),t.classList.add("rangeend"))},E.prototype.next=function(){(!this.endDate||this.currentYear<this.endDate.getFullYear()||this.currentMonth<this.endDate.getMonth())&&(this.hasBeginReached&&this.target.querySelector("button.prev").classList.remove("disabled"),this.hasBeginReached=!1,this.currentYear=11===this.currentMonth?this.currentYear+1:this.currentYear,this.currentMonth=(this.currentMonth+1)%12,this.hasEndReached=!(!this.endDate||this.currentMonth!=this.endDate.getMonth()||this.currentYear!=this.endDate.getFullYear()),this.updateCalendar(this.currentMonth,this.currentYear)),this.hasEndReached&&this.target.querySelector("button.next").classList.add("disabled")},E.prototype.previous=function(){(!this.startDate||this.currentYear>this.startDate.getFullYear()||this.currentMonth>this.startDate.getMonth())&&(this.hasEndReached&&this.target.querySelector("button.next").classList.remove("disabled"),this.hasEndReached=!1,this.currentYear=0===this.currentMonth?this.currentYear-1:this.currentYear,this.currentMonth=0===this.currentMonth?11:this.currentMonth-1,this.hasBeginReached=!(!this.startDate||this.currentMonth!=this.startDate.getMonth()||this.currentYear!=this.startDate.getFullYear()),this.updateCalendar(this.currentMonth,this.currentYear)),this.hasBeginReached&&this.target.querySelector("button.prev").classList.add("disabled")},E.prototype.daysInMonth=function(e,t){return 32-new Date(t,e,32).getDate()},E.prototype.isWeekend=function(e,t,i){var n=new Date(e,t,i);return 6==n.getDay()||0==n.getDay()},E.prototype.prevButton=function(e){e.preventDefault(),this.previous()},E.prototype.nextButton=function(e){e.preventDefault(),this.next()},E.prototype.dateClicked=function(e){var t=e.target.classList;if(t.contains("calendarLink")&&!t.contains("outofrange")&&(!t.contains("weekend")||this.weekend)){var i,n,s=this.target.querySelector("#calendar-body").querySelectorAll(".selected-link"),a=e.target,o=new Date(a.getAttribute("data-id"));if(this.isRangeSelector){if(2==this.ranges.length||1==this.ranges.length&&o<this.ranges[0]){var r=this.target.querySelector("#calendar-body").querySelectorAll(".selected-range-link");this.ranges=[];var l=s.length;for(i=0;i<l;i++)s[i].classList.remove("selected-link");for(l=r.length,i=0;i<l;i++)r[i].classList.remove("selected-range-link");for(n=0;n<this.inputs.length;n++)this.inputs[n].value=""}var c;if(this.ranges.push(o),this.rangeStartDate=this.ranges[0],this.rangeEndDate=this.ranges[1],a.classList.add("selected-link"),this.rangeStartDate&&this.rangeEndDate){var u=this.target.querySelector("#calendar-body").querySelectorAll(".day");for(i=0;i<u.length;i++)(c=u[i].firstChild).hasAttribute&&c.hasAttribute("data-id")&&this.setRangeColor(new Date(c.getAttribute("data-id")),c,u[i].parentElement);for(n=0;n<this.inputs.length;n++)x.updateInput(this.inputs[n],this.ranges[n]);this.cb(this.rangeStartDate.toDateString(),this.rangeEndDate.toDateString())}else this.rangeStartDate&&x.updateInput(this.inputs[0],o)}else{for(n=0;n<s.length;n++)s[n].classList.remove("selected-link");a.classList.add("selected-link"),this.selectedDate=o,x.updateInput(this.inputs[0],o),this.cb(o.toDateString())}e.preventDefault()}},E.prototype.eventHandler=function(){this.prevh=s(this,this.prevButton),this.nexth=s(this,this.nextButton),this.target.querySelector(".prev").addEventListener("click",this.prevh),this.target.querySelector(".next").addEventListener("click",this.nexth),this.datec=s(this,this.dateClicked),this.target.addEventListener("click",this.datec)},E.prototype.clear=function(){this.target.querySelector(".prev").removeEventListener("click",this.prevh),this.target.querySelector(".next").removeEventListener("click",this.nexth),this.target.removeEventListener("click",this.datec)},u.extend(I,d),I.prototype.onClickEvent=function(e){if(e.target&&"li"===e.target.tagName.toLowerCase()&&!this.isReload&&this.selectable){this.selectedIndex=parseInt(e.target.id.match(/\d+$/)[0],10),this.selectedText=this.values.length>this.selectedIndex?this.values[this.selectedIndex]:this.items[this.selectedIndex];var t=e.target.parentNode.querySelector(".active");t&&(t.classList.remove("active"),t.setAttribute("aria-selected","false")),e.target.classList.toggle("active"),e.target.setAttribute("aria-selected","true"),this.event?I.superProto.invokeHandlers.call(this):this.resultCallback&&this.resultCallback()}},I.prototype.getOutputText=function(){return this.selectedText},I.prototype.registerHandlers=function(){w.prototype.registerHandlers.call(this)},I.prototype.getAnswerID=function(){return this.items[this.selectedIndex]||""},I.prototype.getHTML=function(){this.main.isReloading&&(this.isReload=!0);var e="<div class='list-group'>";return this.closeList&&(e+="<button class='close' aria-label='close'></button>"),e+="<ul role='listbox' style='padding:0px;margin:0px;' class='",e+=this.isReload?"disabled'":"'",e+=this.ariaLabel?" aria-label='"+this.ariaLabel+"'":"",e+=this.setAriaHiddenText(this.ariaHidden),e+=" id=",e+=this.id,e+=">",e+=this.getContent(),e+="</div>"},I.prototype.enable=function(){this.isReload=!1,this.main.dv.container.querySelector("#"+this.id).classList.remove("disabled")},I.prototype.disable=function(){this.isReload=!0,this.main.dv.container.querySelector("#"+this.id).classList.add("disabled")},I.prototype.getCardHTML=function(){this.main.isReloading&&(this.isReload=!0);var e=["<ul role='listbox' tabindex='0'  class='list-group list-group-flush",this.isReload?"disabled'":"'",this.ariaLabel?" aria-label='"+this.ariaLabel+"'":"","id=",this.id,">"];return e.push(this.getContent()),e.join("")},I.prototype.getContent=function(){var e,t="",i=this.items||this.getFromConstant(this.items)||[],n=this.values=this.values||[],s=this.selectedIndex=this.selectedIndex>i.length-1?i.length-1:this.selectedIndex;return this.selectedText=n.length>s?n[s]:i[s],this.header?(t+="<li class='nuan-list-group-item list-header disabled'>",t+=this.header,t+="</li>",this.encodeLabel(this.header)):this.label?(t+="<label class='nuan-label' ",t+=this.getStyle(),t+=">",t+=this.label,t+="</label>",this.encodeLabel(this.label)):this.hiddenLabel&&this.encodeLabel(this.hiddenLabel),-1!=s&&(this.selectedText=n.length>s?n[s]:i[s]),i.forEach((function(i,n){t+="<li class='nuan-list-group-item",(e=n===s)&&(t+=" active"),this.selectable&&(t+=" cursor-poiner"),t+="' id=",t+=this.id,t+="-",t+=n,t+=e?" aria-selected='true'":" aria-selected='false'",this.selectable&&(t+=" role='option' tabindex='0'"),t+=">",t+=i,t+="</li>"}),this),t+="</ul>",this.registerHandlers(),t},u.extend(j,I),j.prototype.resetData=function(){this.selectedIndex=this.defaultSelected,this.selectedIndex>=0&&(this.selectedText=this.values[this.selectedIndex]||this.items[this.selectedIndex])},j.prototype.isPlugin=function(){return!(!this.setFocus&&!this.closeList)},j.prototype.renderPlugin=function(){if(this.el=this.main.dv.container.querySelector("#"+this.id),!this.el)return!1;var e=this.el.children,t=this.header?1:0;return this.closeList&&(this.closeHandler=s(this,this.onClose),this.closeEl=this.el.previousSibling,this.closeEl.addEventListener("click",this.closeHandler)),e[t].focus(),!0},j.prototype.clear=function(){this.closeEl&&this.closeEl.removeEventListener("click",this.closeHandler)},j.prototype.onClose=function(){this.resultCallback&&this.resultCallback()},I.prototype.getFromConstant=function(e){var t=u.parseValueFromConstant(e,this.main);return t?Array.isArray(t)?t:[t]:null},u.extend(A,d),A.prototype.onClickEvent=function(e){e.target&&this.isEnabled&&this.event&&(this.deck.toggleSelection(this),A.superProto.invokeHandlers.call(this))},A.prototype.registerHandlers=function(){},A.prototype.getHTML=function(e){this.registerHandlers();var t=this;t.id=t.id||e,t.size&&(this.width=t.size),t.context&&(this.background=t.context.color,this.border=t.context.cardBorder,this.borderRadius=t.context.cardBorderRadius,this.boxShadow=t.context.cardShadow);var i="<div class='card nuan-card mt-2 nuan-card-width' id='";i+=t.id,i+="'",i+=this.setAriaHiddenText(this.ariaHidden),i+=this.getStyle(),this.event&&(i+=" role='button'"),i+=">",this.background=void 0,this.border=void 0,this.width=void 0;var n="";if((t.cardTitle||t.cardSubTitle||t.cardText)&&(n+="<div class='card-body",n+="'>",t.cardTitle&&(n+="<h5 class='card-title' ",t.context&&(n+=this.getTextStyle(t.context.title,t.context.titleSize,t.context.titleStyle)),n+=">",n+=t.cardTitle,n+="</h5>"),t.cardSubTitle&&(n+="<h6 class='card-subtitle mb-2 text-muted' ",t.context&&(n+=this.getTextStyle(t.context.subTitle,t.context.subTitleSize,t.context.subTitleStyle)),n+=">",n+=t.cardSubTitle,n+="</h6>"),t.cardText&&(n+="<p class='card-text' ",t.context&&(n+=this.getTextStyle(t.context.text,t.context.textSize,t.context.textStyle)),n+=">",n+=t.cardText,n+="</p>"),n+="</div>"),this.textColor=void 0,t.listGroup&&(t.list_group=new I(t.listGroup),t.list_group.main=t.main,n+=t.list_group.getCardHTML()),t.columnSet){var s=new D(t.columnSet);s.parentWidget="card",s.main=t.main,n+=s.getHTML(),t.columnSet=s}return t.context&&t.context.bottomSeparator&&(t.cardBottom=t.context.bottomSeparator,n+="<hr class='body-separator'",n+=this.getStyle(),n+="/>"),t.cardButtons&&(n+="<div class='card-bottom' ",n+=">",t.cardButtons.forEach((function(e,i){(e=new p(e)).main=t.main,n+=e.getHTML(),t.cardButtons[i]=e})),n+="</div>",t.cardBottom=void 0),t.cardBottom=void 0,t.header?(i+="<h5 class='card-header' ",t.context&&(t.headerBackground=t.context.headerBackground,t.textColor=t.context.header),i+=this.getStyle(),i+=">",i+=t.header,i+="</h5>",i+=n,t.headerBackground=void 0,t.textColor=void 0):t.cardImage?(t.cardImage.borderRadius=this.borderRadius,"top"===t.cardImage.position?(t.cardImage.width||t.cardImage.height?(t.cardImage.spaceAround&&(i+="<div class='card-custom-img-top'>"),i+="<div class='card-img-top' ",i+=this.getImageStyle.call(t.cardImage),i+="></div>",t.cardImage.spaceAround&&(i+="</div>")):(i+="<img src='",i+=t.cardImage.src,i+="' class='card-img-top'",t.size&&(i+="style='height:",i+=t.size/1.33,i+=";'"),i+=" ></img>"),i+=n):"left"==t.cardImage.position?(i+="<div class='nuan-row-card no-gutters'><div class='card-left-section ",t.cardImage.width&&t.cardImage.height?(t.cardImage.spaceAround&&(i+="card-custom-img-left"),i+="'><div class='card-img-left card-custom-left-img' ",i+=this.getImageStyle.call(t.cardImage),i+="></div>"):i+="'>",i+="</div>",i+="<div class='col-fx-10 card-section' style='position:relative;",i+="'> ",i+=n,i+="</div></div>"):(i+="<img src='",i+=t.cardImage.src,i+="' class='card-img'",this.cardImage.width&&(i+=" width=",i+=this.cardImage.width),this.cardImage.height&&(i+=" height=",i+=this.cardImage.height),i+=" ></img>",i+="<div class='card-img-overlay'>",i+=n,i+="</div>")):i+=n,i+="</div>",this.hiddenLabel&&this.id&&this.encodeLabel(this.hiddenLabel),i},A.prototype.enable=function(){this.cardButtons.forEach((function(e){e.enable()})),this.columnSet&&this.columnSet.enable(),this.isEnabled=!0},A.prototype.getTextStyle=function(e,t,i){return e||t||i?(this.textColor=e,this.textSize=t,this.textStyle=i,this.getStyle()):null},A.prototype.disable=function(){this.cardButtons&&this.cardButtons.forEach((function(e){e.disable()})),this.columnSet&&this.columnSet.disable(),this.isEnabled=!1},A.prototype.executeValidation=function(){return!this.columnSet||this.columnSet.executeValidation()},A.prototype.getImageStyle=function(){var e="style='";return this.src&&(e+="background-image:",e+=d.setStyleVal("url("+d.getImageUrl(this.src)+")"),e+="background-size:",this.width&&this.height?e+=d.setStyleVal(this.width+"px "+this.height+"px"):e+="contain;",e+="background-repeat:",e+=d.setStyleVal("no-repeat"),e+="background-position:",this.align?e+=d.setStyleVal(this.align):e+=d.setStyleVal("center"),"top"==this.position&&this.setImageBorder&&(e+="border-top-right-radius:",e+=d.setStyleVal(this.borderRadius+"px"),e+="border-top-left-radius:",e+=d.setStyleVal(this.borderRadius+"px")),"left"==this.position&&this.setImageBorder&&(e+="border-bottom-left-radius:",e+=d.setStyleVal(this.borderRadius+"px"),e+="border-top-left-radius:",e+=d.setStyleVal(this.borderRadius+"px")),this.height&&(e+="height:",e+=d.setStyleVal(this.height+"px"))),e+="'"},A.prototype.isPlugin=function(e){return this.event&&this.id?(this.deck=e,!0):!(!this.columnSet&&!this.cardButtons)},A.prototype.renderPlugin=function(){return this.columnSet&&this.columnSet.renderPlugin(),this.cardButtons&&this.cardButtons.forEach((function(e){e.renderPlugin()})),!(this.id&&!this.main.isReloading)||(this.el=this.main.dv.container.querySelector("#"+this.id),!!this.el&&(this.deck&&(this.cardclick=s(this,this.onClickEvent),this.el.addEventListener("click",this.cardclick),this.offLeft=this.el.offsetLeft,this.width=this.el.offsetWidth),!0))},A.prototype.clear=function(){this.el&&this.el.removeEventListener("click",this.cardclick)},A.prototype.getCard=function(){return this.el=this.el||this.main.dv.container.querySelector("#"+this.id),this.el},A.prototype.getOffsetLeft=function(){return this.offLeft=this.offLeft||this.getCard().offsetLeft,this.offLeft},A.prototype.getWidth=function(){return this.width=this.width||this.getCard().offsetWidth,this.width},A.prototype.toggleSelection=function(e){var t=this.context.cardSelectedBorder;t&&(this.el.style.borderColor=e?t:this.context.cardBorder)},A.prototype.getAriaOutput=function(){var e=null;return this.columnSet&&(e=this.columnSet.getAriaOutput()),e},u.extend(M,d),M.prototype.getHTML=function(){var e="<div class='nuan-row-card nuan-card-deck mt-2 flex-nowrap' id=";return e+=this.id,e+=this.setAriaHiddenText(this.ariaHidden),e+=">",this.context&&(this.background=this.context.color,this.border=this.context.cardBorder),this.hiddenLabel&&this.id&&this.encodeLabel(this.hiddenLabel),this.cards.forEach((function(t,i){(t=new A(t)).main=this.main,e+="<div class='deck-size' >",e+=t.getHTML(this.id+i),e+="</div>",this.cards[i]=t}),this),"dot"==this.navigationStyle?(e+="</div>",e+="<nav class='carousel-nav fixed-nav'",e+=this.setAriaHiddenText(this.ariaHidden),e+="><button class='disabled prev' id='prev' role='button'><i class='arrow-left icon'></i><span class='sr-only'>Previous</span></button><ul class='nav-dot-cont'>",e+="</ul><button class='next' id='next' role='button'><i class='arrow-right icon'></i><span class='sr-only'>Next</span></button></nav>"):e+="</div><nav class='carousel-nav'><button class='disabled prev' id='prev' role='button'><i class='arrow-left icon'></i><span class='sr-only'>Previous</span></button><button class='next' id='next' role='button'><i class='arrow-right icon'></i><span class='sr-only'>Next</span></button></nav>",e},M.prototype.isPlugin=function(){return!0},M.prototype.getOutputText=function(){if(this.selectedCardID)return this.selectedCardID;for(var e=0;e<this.cards.length;e++)if(this.cards[e].cardButtons)for(var t=0;t<this.cards[e].cardButtons.length;t++)if(this.cards[e].cardButtons[t].clicked)return this.cards[e].id;return""},M.prototype.renderPlugin=function(){if(this.id){if(this.el=this.main.dv.container.querySelector("#"+this.id),!this.el)return!1;o(this.el,this),this.main.isReloading||this.cards.forEach(function(e){e.isPlugin(this)&&e.renderPlugin()}.bind(this));var e=this.el.offsetWidth;if(this.cardsPerPage=Math.floor((e+30)/(this.cards[0].getWidth()+30)),"dot"==this.navigationStyle){this.navDots=[];for(var t=this.el.parentElement.querySelector(".nav-dot-cont"),i=0;i<this.cards.length/this.cardsPerPage;i++){var n=document.createElement("li");n.classList.add("nav-dots"),0==i&&n.classList.add("highlight"),this.navDots.push(n),t.appendChild(n)}}this.useSwipe&&(this.el.style.overflow="hidden")}return!0},M.prototype.enable=function(){this.cards.forEach((function(e){e.enable()})),o(this.el,this)},M.prototype.disable=function(){this.cards.forEach((function(e){e.disable()}))},M.prototype.getScrollRightSize=function(){for(var e=this.el.scrollLeft,t=this.el.offsetWidth,i=this.cards.length-1;i>=0;i--){if(this.cards[i].getOffsetLeft()-16-e+this.cards[i].getWidth()<=t){if(i<this.cards.length-1){for(var n=i+1,s=n;s<n+this.cardsPerPage&&s<this.cards.length;s++)this.cardScrolledIntoView(this.cards[s]);if(this.navDots){var a=(i+1)/this.cardsPerPage;this.navDots[a-1].classList.remove("highlight"),this.navDots[a].classList.add("highlight")}return this.cards[i+1].getOffsetLeft()-15}break}}return e},M.prototype.getScrollLeftSize=function(){for(var e=this.el.scrollLeft,t=this.el.offsetWidth,i=0;i<this.cards.length;i++){if(this.cards[i].getOffsetLeft()>=e&&i>0){var n=i-this.cardsPerPage;n<0&&(n=0);for(var s=n;s<n+this.cardsPerPage&&s<this.cards.length;s++)this.cardScrolledIntoView(this.cards[s]);if(this.navDots){var a=Math.ceil(i/this.cardsPerPage);this.navDots[a].classList.remove("highlight"),this.navDots[a-1].classList.add("highlight")}return e-(t-(this.cards[i-1].getWidth()-(e-this.cards[i-1].getOffsetLeft())))+1}}return e},M.prototype.cardScrolledIntoView=function(e){if(e&&e.main&&e.main.viewRenderedCb){var t=e.getAriaOutput();t&&e.main.viewRenderedCb([t])}},M.prototype.toggleSelection=function(e){this.selectedCardID=e.id,this.cards.forEach((function(t){e.id==t.id?t.toggleSelection(!0):t.toggleSelection(!1)}))},M.prototype.clear=function(){this.prev&&(this.prev.removeEventListener("mousedown",this.mouseDownHandler),this.prev.removeEventListener("mouseup",this.mouseUpPrevHandler)),this.next&&(this.next.removeEventListener("mousedown",this.mouseDownHandler),this.next.removeEventListener("mouseup",this.mouseUpNextHandler)),this.swipe&&this.swipe.destroy(),this.next=null,this.prev=null,this.mouseDownHandler=null,this.mouseUpPrevHandler=null,this.mouseUpNextHandler=null,this.nextDisabled=this.prevDisabled=!1,this.cards.forEach((function(e){e.isPlugin()&&e.clear()}))},M.prototype.getAriaOutput=function(){var e=this.cards[0].getAriaOutput();return{text:e?e.text:"",length:this.cards.length,type:this.type}},u.extend(L,v),L.prototype.getHTML=function(){this.registerHandlers();var e="<fieldset class='nuan-fieldset w-100' style='padding-left:2px;padding-right:2px;padding-top:";return e+=this.material?".4em":"2px",e+=";padding-bottom:2px;'",(this.ariaLabel||this.helpText)&&(e+=" aria-label='"+(this.ariaLabel||this.helpText)+"'"),e+=this.setAriaHiddenText(this.ariaHidden),e+=">",this.label&&!this.material?(e+="<label class='nuan-label' ",e+=this.getStyle(),e+=">",e+=this.label,e+="</label>",this.encodeLabel(this.label)):this.hiddenLabel&&this.encodeLabel(this.hiddenLabel),e+="<div style='position:relative;"+this.addPadding.call(this.controlContext)+"'><textarea class='nuan-textarea nuan-form-control",e+=this.material?" nuan-form-control-material":"",e+="'",e+=" id=",e+=this.id,this.placeholder&&!this.material&&(e+=" placeholder='",e+=this.placeholder,e+="'"),this.isEnabled&&!this.main.isReloading||(e+=" disabled"),this.material&&(e+=" required"),this.rows&&(e+=" rows=",e+=this.rows),this.controlContext&&(e+=" "+this.getStyle.call(this.controlContext)),e+=">",this.text&&(e+=this.text),e+="</textarea><span class='validation-error-icon'></span>",this.material&&(e+="<label class='nuan-label-material' ",e+=this.getStyle(),e+=">",e+=this.label,e+="</label>"),e+="</div>",e+=this.addValidationTags(),this.helpText&&(e+="<small class='form-text text-muted'>",e+=this.helpText,e+="</small>"),e+="</fieldset>"},u.extend(P,d),P.prototype.getOutputText=function(){return this.ratingText},P.prototype.getHTML=function(){this.selectedRating=this.defaultSelected=parseInt(u.parseValueFromConstant(this.selectedRating,this.main));var e="<div class='nuan-rating' id='";e+=this.id+"'",e+=this.ariaHidden?" aria-hidden='"+this.ariaHidden+"'>":">",e+="<fieldset role='group' ",this.ariaLabel&&(inp+=" aria-label='"+this.ariaLabel+"'"),e+=">",this.label?(e+="<label class='nuan-label' ",e+=this.getStyle(),e+=">",e+=this.label,e+="</label>",this.encodeLabel(this.label)):this.hiddenLabel&&this.encodeLabel(this.hiddenLabel),e+="<div class='nuan-text-center'>";for(var t=0;t<this.ratingScale.length;t+=1)e+="<button class='",e+=this.ratingScale[t],e+=t<this.selectedRating+1?" selected":"",e+="' data-indicator='",e+=t+1,e+="'",e+=this.ratingScale[t],e+=t==this.selectedRating?" aria-pressed=true":"",this.ariaValues&&(e+=" aria-label='",e+=this.ariaValues[t]||"",e+="'"),e+=this.main.isReloading?" disabled":"",e+="></button>";return e+="</div>",e+=this.addValidationTags(),e+="</fieldset></div>"},P.prototype.isPlugin=function(){return!0},P.prototype.renderPlugin=function(){var e=this.main.dv.container.querySelector("#"+this.id);return!!e&&(this.el=e,this.registerEvents(),this.values&&(this.ratingText=this.selectedRating<this.values.length?this.values[this.selectedRating]:""),this.text&&(this.selectedText=this.selectedRating<this.text.length?this.text[this.selectedRating]:""),!0)},P.prototype.registerEvents=function(){this.hl=this.highlight.bind(this),this.rs=this.resetSelected.bind(this),this.ra=this.ratingAction.bind(this),this.el.addEventListener("mouseover",this.hl,!1),this.el.addEventListener("focus",this.hl,!0),this.el.addEventListener("mouseleave",this.rs,!0),this.el.addEventListener("blur",this.rs,!0),this.el.addEventListener("click",this.ra,!1)},P.prototype.disable=function(){this.clear(),this.el.querySelectorAll("button").forEach((function(e){e.setAttribute("disabled",!0)}))},P.prototype.enable=function(){this.registerEvents(),this.el.querySelectorAll("button").forEach((function(e){e.removeAttribute("disabled")}))},P.prototype.validate=function(e){return"required"!=e||-1!=this.selectedRating},P.prototype.addInvalid=function(e){e.classList.add("invalid")},P.prototype.forceFocus=function(){var e=this.actualEl.firstElementChild;e.focus(),e.scrollIntoView({block:"nearest"})},P.prototype.removeInvalid=function(e){e.classList.remove("invalid")},P.prototype.ratingAction=function(e){e.preventDefault();var t=e.target;if(t){var i=parseInt(t.getAttribute("data-indicator")||0,10);Array.from(this.el.querySelectorAll("button")).forEach((function(e,t){t<i?e.classList.add("selected"):e.classList.remove("selected")}));var n=this.el.querySelector('button[aria-pressed="true"]');n&&n.removeAttribute("aria-pressed"),t.setAttribute("aria-pressed",!0),this.selectedRating=i-1,this.values&&(this.ratingText=this.selectedRating<this.values.length?this.values[this.selectedRating]:""),this.text&&(this.selectedText=this.selectedRating<this.text.length?this.text[this.selectedRating]:""),this.resetErrors(),this.event&&(P.superProto.invokeHandlers.call(this),this.setDataFocus(e.target))}},P.prototype.highlight=function(e){var t=e.target.closest(".nuan-rating");if(e.target.closest("button")&&t){var i=parseInt(e.target.getAttribute("data-indicator"),10);Array.from(t.querySelectorAll("button")).forEach((function(e,t){t<i?e.classList.add("selected"):e.classList.remove("selected")}))}},P.prototype.resetSelected=function(e){if(e.target.closest){var t=e.target.closest(".nuan-rating");if(t){var i=Array.from(t.querySelectorAll("button")),n=t.querySelector('button[aria-pressed="true"]'),s=n?parseInt(n.getAttribute("data-indicator"),10):0;i.forEach((function(e,t){t<s?e.classList.add("selected"):e.classList.remove("selected")}))}}},P.prototype.clear=function(){this.el&&(this.el.removeEventListener("mouseover",this.hl,!1),this.el.removeEventListener("focus",this.hl,!0),this.el.removeEventListener("mouseleave",this.rs,!0),this.el.removeEventListener("blur",this.rs,!0),this.el.removeEventListener("click",this.ra,!1))},P.prototype.resetData=function(){this.selectedRating=this.defaultSelected},u.extend(_,v),_.prototype.getHTML=function(){this.registerHandlers();var e="<fieldset class='nuan-fieldset ";return e+="ShortInput"==this.type?"col-md-6":"w-100",e+="' style='padding-left:2px;padding-right:2px;padding-top:2px;padding-bottom:2px;'",this.ariaLabel&&(e+=" aria-label='"+this.ariaLabel+"'"),e+=this.setAriaHiddenText(this.ariaHidden),e+=">",this.label?(e+="<label class='nuan-label' ",e+=this.getStyle(),e+=">",e+=this.label,e+="</label>",this.encodeLabel(this.label)):this.hiddenLabel&&this.encodeLabel(this.hiddenLabel),e+="<div class='nuan-input-group'>",this.inputGroupText&&(e+="<div class='nuan-input-group-prepend'><span class='nuan-input-group-text'>",e+=this.inputGroupText,e+="</span></div>"),e+="<input type='text' class='nuan-input nuan-form-control'",e+=" id=",e+=this.id,this.placeholder&&(e+=" placeholder='",e+=this.placeholder,e+="'"),this.isEnabled&&!this.main.isReloading||(e+=" disabled"),this.text&&(e+=" value=",e+=this.text),e+="></input>",e+="<span class='validation-error-icon'></span></div>",e+=this.addValidationTags(),this.helpText&&(e+="<small class='form-text text-muted'>",e+=this.helpText,e+="</small>"),e+="</fieldset>"},u.extend(D,d),D.prototype.registerHandlers=function(){D.superProto.registerHandlers.call(this)},D.prototype.getHTML=function(){var e="<div ";return e+=this.id?"id="+this.id:"",e+=" class='nuan-row flex-container w-100",Array.isArray(this.spaceAround)&&(e+="' style='padding:",e+=this.getSpaceAroundVals(this.spaceAround),e+=";'"),e+="'>",this.columns&&this.columns.forEach((function(t){"Column"==t.type&&(e+=this.getColumn(t))}),this),e+="</div>",this.registerHandlers(),e},D.prototype.executeValidation=function(){for(var e=[],t=0;t<this.columns.length;t++)if(this.columns[t].items)for(var i=0;i<this.columns[t].items.length;i++)this.columns[t].items[i].executeValidation()||e.push(this.columns[t].items[i]);return!(e.length>0)||(e[0].forceFocus(),!1)},D.prototype.enable=function(){for(var e=0;e<this.columns.length;e++)if(this.columns[e].items)for(var t=0;t<this.columns[e].items.length;t++)this.columns[e].items[t].enable()},D.prototype.disable=function(){for(var e=0;e<this.columns.length;e++)if(this.columns[e].items)for(var t=0;t<this.columns[e].items.length;t++)this.columns[e].items[t].disable()},D.prototype.getColumn=function(e){var t="<div class='";if(t+=e.width?"col-md-"+e.width:"col-md-12",Array.isArray(e.spaceAround)&&(t+="' style='padding:",t+=this.getSpaceAroundVals(e.spaceAround),t+=";'"),t+="'>",e.items){var i=0;e.items.forEach((function(n){t+="<div class='nuan-row flex-container nuan-column-item","middle"==e.align?t+=" align-middle":"bottom"==e.align&&(t+=" align-bottom");var s=d.createControlInstance(n,this.main);s.spaceAround&&(t+=" mt-0"),e.items[i]=s,t+="'",t+=d.getContStyleProps(s),t+=">",s.main=this.main,t+=s.getHTML(),t+="</div>",i+=1}),this)}return t+="</div>"},D.prototype.isPlugin=function(){return!0},D.prototype.renderPlugin=function(){for(var e=0;e<this.columns.length;e++)if(this.columns[e].items)for(var t=0;t<this.columns[e].items.length;t++)this.columns[e].items[t].isPlugin()&&this.columns[e].items[t].renderPlugin();return!0},D.prototype.getSpaceAroundVals=function(e){var t=[];return e.forEach((function(e){t.push(e+"px")})),t.join(" ")},D.prototype.getColumnForMapper=function(e){for(var t=0;t<this.columns.length;t++)if(e==this.columns[t].id)return this.columns[t];return null},D.prototype.resetData=function(){for(var e=0;e<this.columns.length;e++)if(this.columns[e].items)for(var t=0;t<this.columns[e].items.length;t++)this.columns[e].items[t].resetData()},D.prototype.resetRendering=function(){for(var e=0;e<this.columns.length;e++)if(this.columns[e].items)for(var t=0;t<this.columns[e].items.length;t++)this.columns[e].items[t].resetRendering()},D.prototype.clear=function(){for(var e=0;e<this.columns.length;e++)if(this.columns[e].items)for(var t=0;t<this.columns[e].items.length;t++)this.columns[e].items[t].isPlugin()&&this.columns[e].items[t].clear()},D.prototype.getAriaOutput=function(){for(var e,t="",i=0;i<this.columns.length;i++)if(this.columns[i].items)for(var n=0;n<this.columns[i].items.length;n++)(e=this.columns[i].items[n].getAriaOutput())&&(t&&(t+=" "),t+=e.text);return{text:t}},u.extend(O,d),O.prototype.getHTML=function(){var e=["<div class='nuan-row w-100"];return Array.isArray(this.spaceAround)&&(e.push("' style='padding:"),e.push(this.getSpaceAroundVals(this.spaceAround)),e.push(";'")),e.push("'>"),this.rows&&this.rows.forEach((function(t){"Row"==t.type&&e.push(this.getRow(t))}),this),e.push("</div>"),e.join("")},O.prototype.executeValidation=function(){return this.rows.every((function(e){return e.items.every((function(e){return e.executeValidation()}))}))},O.prototype.enable=function(){return this.rows.every((function(e){return e.items.every((function(e){return e.enable(),!0}))}))},O.prototype.disable=function(){return this.rows.every((function(e){return e.items.every((function(e){return e.disable(),!0}))}))},O.prototype.getRow=function(e){var t=["<div class='w-100'"];if(Array.isArray(e.spaceAround)&&(t.push(" style='padding:"),t.push(this.getSpaceAroundVals(e.spaceAround)),t.push(";'")),t.push(">"),e.items){var i=0;e.items.forEach((function(n){t.push("<div class='nuan-row nuan-row-item");var s=d.createControlInstance(n,this.main);e.items[i]=s,e.spaceAround&&0==i&&t.push(" mt-0"),t.push("'"),t.push(d.getContStyleProps(s)),t.push(">"),s.main=this.main,t.push(s.getHTML()),t.push("</div>"),i+=1}),this)}return t.push("</div>"),t.join("")},O.prototype.getSpaceAroundVals=function(e){var t=[];return e.forEach((function(e){t.push(e+"px")})),t.join(" ")},O.prototype.getRowForMapper=function(e){for(var t=0;t<this.rows.length;t+=1)if(e==this.rows[t].id)return this.rows[t];return null},O.prototype.resetData=function(){return this.rows.every((function(e){return e.items.every((function(e){return e.resetData(),!0}))}))},u.extend(R,d),R.prototype.onClickEvent=function(e){e.target&&(this.state=e.target.checked?"on":"off",this.event&&R.superProto.invokeHandlers.call(this))},R.prototype.getOutputText=function(){return this.state},R.prototype.registerHandlers=function(){R.superProto.registerHandlers.call(this),this.main.ev.registerEventHandler(this,"onClick")},R.prototype.getHTML=function(){var e=["<div"];return this.ariaHidden&&e.push(this.setAriaHiddenText(this.ariaHidden)),e.push(">"),e.push("<label><input type='checkbox' class='nuan-switch'"),this.active?(e.push(" checked"),this.state="on"):this.state="off",e.push(" id="),e.push(this.id),this.main.isReloading&&e.push(" disabled"),e.push(" ></><div><div></div></div></label>"),e.push("</div>"),this.hiddenLabel&&this.encodeLabel(this.hiddenLabel),this.registerHandlers(),e.join("")},R.prototype.resetData=function(){this.active=this.defaultStatus},u.extend(B,d),B.prototype.onClickEvent=function(){this.event&&B.superProto.invokeHandlers.call(this)},B.prototype.registerHandlers=function(){this.event&&(B.superProto.registerHandlers.call(this),this.main.ev.registerEventHandler(this,"onClick"))},B.prototype.getHTML=function(){this.registerHandlers();var e="<div class='w-100 nuan-flex nuan-box-container' style='justify-content:";if(e+="left"==this.boxAlign?"flex-start":"right"==this.boxAlign?"flex-end":"center",e+=";'><div",e+=this.id?" id="+this.id:"",this.width&&this.height){if("fill"==this.width?e+=" class='w-100' style='":(e+=" style='position:relative;width:",e+=this.width,e+="px;"),e+="height:",e+=this.height,e+="px;",this.context){var t=this.getStyle.call(this.context);e+=t.substring(7,t.length-1)}if(e+="'",e+=this.setAriaHiddenText(this.ariaHidden)+">",this.item){e+="<div class='box-item",e+="middle"==this.itemAlign?" middle":"end"==this.itemAlign?" end":"",e+="' style='padding:",e+=this.context&&this.context.boxPadding?this.context.boxPadding:"5",e+="px;'>";var i=d.createControlInstance(this.item,this.main);i.main=this.main,e+=i.getHTML(),e+="</div>",this.item=i}return e+="</div></div>"}},B.prototype.executeValidation=function(){return!this.item||this.item.executeValidation()},B.prototype.enable=function(){this.item&&this.item.enable()},B.prototype.disable=function(){this.item&&this.item.disable()},B.prototype.resetData=function(){this.item&&this.item.resetData()},u.extend(V,f),V.prototype.getHTML=function(){var e="<div class='timepicker-container'";if(e+=this.ariaHidden?" aria-hidden='"+this.ariaHidden+"'>":">",this.times)this.text=this.times;else{this.text=[];for(var t=new Date,i=this.getTime(t,this.startHour,this.startMinute),n=this.getTime(t,this.endHour,this.endMinute),s=i;s<n;s+=6e4*this.step){var a=new Date(s),o=a.getHours(),r=a.getMinutes();this.text.push(("12"==this.format&&o>=12?o-12==0?"00":o-12:o)+":"+(r<10?"0":"")+r+("12"==this.format?o>=12?"PM":"AM":""))}}return e+=V.superProto.getHTML.call(this),e+="</div>"},V.prototype.getTime=function(e,t,i){return new Date(e.getTime()+6e4*i+36e5*t).getTime()},u.extend(N,d),N.prototype.onClickEvent=function(e){if(this.event&&N.superProto.invokeHandlers.call(this),this.launchMode&&this.metaUrl)switch(this.launchMode){case"parent":window.open(this.metaUrl,"_parent");break;case"tab":window.open(this.metaUrl,"_blank")}e.preventDefault()},N.prototype.registerHandlers=function(){N.superProto.registerHandlers.call(this),this.main.ev.registerEventHandler(this,"onClick")},N.prototype.getHTML=function(){this.registerHandlers();var e="<div class='w-100 nuan-link-preview nuan-row flex-container ";return e+="small"==this.size?"small_prev":"",e+="' data-id=",e+=this.id,e+=">",e+="<div class='col-md-4'>",e+="<div class='meta_img_cont'",e+=this.getImageStyle(),e+=">",e+="</div>",e+="</div>",e+="<div class='col-md-8'>",this.metaTitle&&(this.textColor=this.context?this.context.titleColor:this.textColor,e+="<a href='",e+=this.metaUrl,e+="' id=",e+=this.id,this.textColor&&(e+=" style='color:",e+=this.textColor,e+=";'"),e+=">",e+=this.metaTitle,e+="</a>"),this.metaDescription&&(this.textColor=this.context?this.context.descriptionColor:this.textColor,this.text=this.metaDescription,this.textAlign="left",e+=new C(this).getHTML()),e+="</div>",e+="</div>",this.hiddenLabel&&this.id&&this.encodeLabel(this.hiddenLabel),e},N.prototype.getImageStyle=function(){var e=["style='"];return this.metaImgSrc&&(e.push("background-image:"),e.push(d.setStyleVal("url("+this.metaImgSrc+")")),e.push("background-size:"),this.width&&this.height?e.push(d.setStyleVal(this.width+"px "+this.height+"px")):e.push("contain;"),e.push("background-repeat:"),e.push(d.setStyleVal("no-repeat")),e.push("background-position:"),e.push(d.setStyleVal("center"))),e.push("'"),e.join("")},N.prototype.isPlugin=function(){return!0},N.prototype.renderPlugin=function(){if(!this.id)return!0;var e=this.main.dv.container.querySelector("#"+this.id);return!!e&&(this.linkClick=s(this,this.onClickEvent),e.addEventListener("click",this.linkClick),!0)},N.prototype.clear=function(){var e=this.main.dv.container.querySelector("#"+this.id);e&&e.removeEventListener("click",this.linkClick)},u.extend(H,d),H.prototype.getHTML=function(){var e=["<div class='nuan-file-upload mt-0'",1==this.limit?"style=' justify-content:center;'":""," id=",this.id];return this.ariaHidden&&e.push(this.setAriaHiddenText(this.ariaHidden)),e.push(">"),e.push("<div class='nuan-upload-cont upload-button'"),this.context&&this.context.fileBackground&&e.push(" style='background-color:",this.context.fileBackground,";'"),e.push("><i class='nuan-upload-plus nuan-fi-center'></i><input type='file' accept='.jpg,.jpeg,.gif,.png,.doc,.xls,.docx,.xlsx,.pdf,.txt'>"),e.push("</div>"),e.push("</div>"),this.limit>2&&(e.push("<nav class='carousel-nav'"),this.ariaHidden&&e.push(this.setAriaHiddenText(this.ariaHidden)),e.push("><button class='disabled prev' id='prev'><i class='arrow-left icon'></i></button><button class='next' id='next'><i class='arrow-right icon'></i></button></nav>")),e.join("")},H.prototype.getFileContent=function(e,t){var i=["<div class='nuan-upload-cont'"];return this.context&&this.context.fileBackground&&i.push(" style='background-color:",this.context.fileBackground,";'"),i.push("><i class='nuan-fi-close'"," data-id=",this.files.length-1,"></i>"),"png"!=e&&"jpeg"!=e&&"jpg"!=e||!this.imagePreview?(this.imagePreview=!1,i.push(this.getTypePreview(t,e))):i.push("<div class='image_preview'"," data-id=",this.files.length-1,"></div>"),i.push("</div>"),i.join("")},H.prototype.getTypePreview=function(e,t){var i="<div class='nuan-fi nuan-fi-center nuan-fi-";return i+=t,i+="' title='",i+=t,i+="'><div class='fi-content'>",i+=t,i+="</div></div><div class='nuan-fi-name' title='",i+=e,i+="'>",i+=e,i+="</div>"},H.prototype.isPlugin=function(){return!0},H.prototype.renderPlugin=function(){return!this.id||(this.cont=this.main.dv.container.querySelector("#"+this.id),!!this.cont&&(this.fileInput=this.main.dv.container.querySelector(".nuan-file-upload input[type=file]"),this.uploadButtonCont=this.main.dv.container.querySelector(".upload-button"),this.uploadFIle=s(this,this.onChange),this.fileInput.addEventListener("change",this.uploadFIle),this.fileInput.focus(),this.containerClick=s(this,this.onContClick),this.cont.addEventListener("click",this.containerClick),this.limit>2&&o(this.cont,this),!0))},H.prototype.onChange=function(e){var t=e.target.files[0];if(t){this.files.push(t);var i=t.type.split("/").pop();this.uploadButtonCont.insertAdjacentHTML("beforebegin",this.getFileContent(i,t.name)),this.setUploadButtonVisibility(),this.event&&H.superProto.invokeHandlers.call(this),"png"!=i&&"jpeg"!=i&&"jpg"!=i||!this.imagePreview||this.readUrl()}},H.prototype.readUrl=function(){var e=this;setTimeout((function(){if(e.files.length>0){var t=e.files[e.files.length-1],i=new FileReader,n=e.main.dv.container.querySelectorAll(".image_preview");i.onload=function(t){n&&n.length>0?n[n.length-1].style.backgroundImage="url('"+t.target.result+"')":e.readUrl()},i.onerror=function(){if(n&&n.length>0){var e=n[n.length-1],i=e.parentElement;i.removeChild(e),i.insertAdjacentHTML("afterend",this.getTypePreview(t.type.split("/").pop(),t.name))}},i.readAsDataURL(t)}}),1e3)},H.prototype.onContClick=function(e){var t=e.target.getAttribute("data-id");t&&e.target.classList.contains("nuan-fi-close")&&(e.target.parentElement.parentNode.removeChild(e.target.parentElement),t=parseInt(t,10),this.files.splice(t,1),this.setUploadButtonVisibility(),this.fileInput.value="")},H.prototype.setUploadButtonVisibility=function(){this.files.length==this.limit?this.uploadButtonCont.style.display="none":this.uploadButtonCont.style.display="block",this.uploadButtonCont.parentElement.scrollLeft=this.uploadButtonCont.parentElement.scrollWidth},H.prototype.getScrollRightSize=function(){return l(this.cont,this.cont.querySelectorAll(".nuan-upload-cont"))},H.prototype.getScrollLeftSize=function(){return c(this.cont,this.cont.querySelectorAll(".nuan-upload-cont"))},H.prototype.clear=function(){this.fileInput&&(this.fileInput.removeEventListener("click",this.uploadFIle),this.cont.removeEventListener("click",this.containerClick)),this.uploadButtonCont=null,this.cont=null,this.fileInput=null,this.prev&&(this.prev.removeEventListener("mousedown",this.mouseDownHandler),this.prev.removeEventListener("mouseup",this.mouseUpPrevHandler)),this.next&&(this.next.removeEventListener("mousedown",this.mouseDownHandler),this.next.removeEventListener("mouseup",this.mouseUpNextHandler)),this.next=null,this.prev=null,this.mouseDownHandler=null,this.mouseUpPrevHandler=null,this.mouseUpNextHandler=null,this.nextDisabled=this.prevDisabled=!1},u.extend(F,d),F.prototype.getHTML=function(){var e=["<div class='nuan-img-cont-wrap nuan-cover-image mr-0 mt-0' id=",this.id];if(this.ariaHidden&&e.push(this.setAriaHiddenText(this.ariaHidden)),e.push(" style='"),this.context){if(this.context.align)switch(this.context.align){case"left":e.push("margin-right:auto !important;");break;case"right":e.push("margin-left:auto;")}this.context.imageBorderRadius&&(e.push("border-radius:"),e.push(this.context.imageBorderRadius),e.push("px;")),this.context.imageBorderColor&&(e.push("border-color:"),e.push(this.context.imageBorderColor),e.push(";")),this.context.imageBorderWidth&&(e.push("border-width:"),e.push(this.context.imageBorderWidth),e.push("px;"))}if(this.width&&e.push("width:",this.width,"px;"),this.height&&e.push("height:",this.height,"px;"),this.url){var t=u.parseValueFromConstant(this.url,this.main)||this.url;e.push("background-image:URL(",t,");")}return this.hiddenLabel&&this.id&&this.encodeLabel(this.hiddenLabel),e.push("'>"),e.push("<div class='nuan-modal'> <span class='nuan-close nuan-cursor'>&times;</span><div class='nuan-modal-content'><img src='",this.url,"' style='width:100%'></div></div>"),e.push("</div>"),e.join("")},F.prototype.isPlugin=function(){return!0},F.prototype.onImageClick=function(){var e=this.img.querySelector("#"+this.id+" .nuan-modal");e&&(e.style.display="block")},F.prototype.onCloseClick=function(e){var t=this.img.querySelector("#"+this.id+" .nuan-modal");t&&(t.style.display="none"),e.stopPropagation()},F.prototype.renderPlugin=function(){return!this.id||(this.img=this.main.dv.container.querySelector("#"+this.id),!!this.img&&(this.imageClick=s(this,this.onImageClick),this.img.addEventListener("click",this.imageClick),this.closeClick=s(this,this.onCloseClick),this.img.querySelector(".nuan-close").addEventListener("click",this.closeClick),!0))},F.prototype.clear=function(){this.img.removeEventListener("click",this.imageClick),this.img.querySelector(".nuan-close").removeEventListener("click",this.closeClick)},u.extend($,d),$.prototype.getHTML=function(){var e=["<div class='nuan-button-group",this.topSeparator?" top-seperator top-separator":"","vertical"==this.layout?" vertical-group":"","'"],t=this;return this.ariaHidden&&e.push(this.setAriaHiddenText(this.ariaHidden)),e.push(">"),this.items.forEach((function(i){var n=["<div class='nuan-tab-button",t.horizontalSeparator?" hor-seperator hor-separator":t.verticalSeparator?" ver-seperator ver-separator":"","'>"],s=new p(i);s.main=t.main,n.push(s.getHTML()),n.push("</div>"),e.push(n.join(""))})),e.push("</div>"),e.join("")},$.prototype.disable=function(){this.items.forEach((function(e){e.disable()}))},$.prototype.enable=function(){this.items.forEach((function(e){e.enable()}))},u.extend(q,d),q.prototype.getHTML=function(){var e=["<video id=",this.id," class='nuan-video-viewer'"];return this.posterImageUrl&&e.push(" poster=",this.posterImageUrl),this.ariaHidden&&e.push(this.setAriaHiddenText(this.ariaHidden)),e.push(" style='width:",this.width?this.width:"100%",";'"),e.push(" controls",this.autoPlay?" autoplay":"",">"),e.push("<source src=",this.sourceUrl," type=",this.sourceContentType,"> </source>"),e.push("</video>"),e.join("")},u.extend(U,d),U.prototype.getOutputText=function(){return this.selectedTickValue},U.prototype.getHTML=function(){var e=this.step=this.step||10,t=this.minValue=this.minValue||0,i=this.maxValue=this.maxValue||100;this.selectedTick=this.selectedTick||t,this.setTickValue();var n=[];if(this.label?(n.push("<label class='nuan-label' "),n.push(this.getStyle()),this.ariaHidden&&n.push(this.setAriaHiddenText(this.ariaHidden)),n.push(">"),n.push(this.label),n.push("</label>"),this.encodeLabel(this.label)):this.hiddenLabel&&this.encodeLabel(this.hiddenLabel),n.push("<div class='nuan-tick-slider'",this.id?"id="+this.id:""),this.ariaHidden&&n.push(this.setAriaHiddenText(this.ariaHidden)),n.push(">"),n.push("<div class='nuan-tick-slider-background'"),this.context){var s=this.context;n.push(" style='"),s.backgroundColor&&(n.push("background-color:"),n.push(d.setStyleVal(s.backgroundColor))),s.backgroundColorFrom&&s.backgroundColorTo&&(n.push("background-image:"),n.push("linear-gradient(to right,",s.backgroundColorFrom,",",s.backgroundColorTo,");")),n.push("'")}n.push("></div>"),n.push("<div class='nuan-tick-slider-progress' style='"),n.push("width:"),n.push(d.setStyleVal(100*this.getSliderPercent()+"%")),this.context.progressColor&&(n.push("background-color:"),n.push(d.setStyleVal(this.context.progressColor))),n.push("'></div>"),n.push("<div class='nuan-tick-slider-tick-container'>");for(var a=(i-t)/e+1,o=0;o<a;o+=1)n.push("<span class='nuan-tick-slider-tick'>"),n.push("</span>");return n.push("</div>"),n.push("<input class='tick-slider-input' type='range'"),n.push(" min=",t),n.push(" max=",i),n.push(" step=",e),n.push(" value=",this.selectedTick),n.push(" data-tick-step=",e),n.push(" >"),n.push("</input>"),n.push("</div>"),n.push("<div class='nuan-tick-slider-value-container'"),this.ariaHidden&&n.push(this.setAriaHiddenText(this.ariaHidden)),n.push(">"),this.tickValues&&!this.showSliderValue&&this.tickValues.forEach((function(e){n.push("<div class='tick-slider-label'>"),n.push(e),n.push("</div>")})),this.showSliderValue&&(n.push("<div class='nuan-tick-slider-label'>"),n.push(t),n.push("</div>"),n.push("<div class='nuan-tick-slider-label'>"),n.push(i),n.push("</div>"),n.push("<div class='nuan-tick-slider-value'></div>")),n.push("</div>"),n.join("")},U.prototype.isPlugin=function(){return!0},U.prototype.setTickValue=function(){this.tickValues&&(this.selectedTick==this.minValue?this.selectedTickValue=this.tickValues[0]:this.selectedTickValue=this.tickValues[this.selectedTick/this.step])},U.prototype.renderPlugin=function(){if(!this.id||this.main.isReloading)return!0;var e=this.main.dv.container.querySelector("#"+this.id);return this.slider=e.querySelector('input[type="range"]'),this.sliderProgress=e.querySelector(".nuan-tick-slider-progress"),this.sliderVal=e.parentElement.querySelector(".nuan-tick-slider-value"),this.slider?(this.sliderInput=s(this,this.onSliderInput),this.slider.addEventListener("input",this.sliderInput),!0):(this.updateValue(this.slider),this.updateValuePosition(this.slider),!1)},U.prototype.onSliderInput=function(e){var t=this;this.selectedTick=e.target.value,this.setTickValue(),this.updateProgress(e.target),this.updateValue(this.slider),this.updateValuePosition(this.slider),-1!=this.timerId&&clearTimeout(this.timerId),this.timerId=setTimeout((function(){t.event&&U.superProto.invokeHandlers.call(this)}),2e3)},U.prototype.getSliderPercent=function(){var e=this.maxValue-this.minValue;return(this.selectedTick-this.minValue)/e},U.prototype.updateProgress=function(e){var t=this.getSliderPercent(e);this.sliderProgress.style.width=100*t+"%"},U.prototype.updateValue=function(e){this.sliderVal&&(this.sliderVal.innerHTML="<div>"+e.value+"</div>")},U.prototype.updateValuePosition=function(e){if(this.sliderVal){var t=this.getSliderPercent(),i=e.getBoundingClientRect().width,n=this.sliderVal.getBoundingClientRect().width,s=t*(i-18)+9-n/2;s=Math.min(s,i-n),s=e.value===e.min?0:s,this.sliderVal.style.left=s+2+"px"}},U.prototype.enable=function(){this.isEnabled=!0,this.renderPlugin()},U.prototype.disable=function(){this.isEnabled=!1,this.clear()},U.prototype.clear=function(){this.slider&&this.slider.removeEventListener("input",this.sliderInput),this.sliderProgress=null},U.prototype.resetData=function(){this.selectedTick=this.defaultTick},u.extend(W,d),W.prototype.getHTML=function(){var e=["<div class='nuan-map-widget mr-0 mt-0' id=",this.id];if(e.push(" style='"),this.context){if(this.context.align)switch(this.context.align){case"left":e.push("margin-right:auto !important;");break;case"right":e.push("margin-left:auto;")}this.context.mapBorderRadius&&(e.push("border-radius:"),e.push(this.context.mapBorderRadius),e.push("px;")),this.context.mapBorderColor&&(e.push("border-color:"),e.push(this.context.mapBorderColor),e.push(";"))}return e.push("width:",this.width||"240","px;"),e.push("height:",this.height||"240","px;"),e.push("'"),this.ariaHidden&&e.push(this.setAriaHiddenText(this.ariaHidden)),e.push(">"),e.push("</div>"),e.join("")},W.prototype.isPlugin=function(){return!0},W.prototype.renderPlugin=function(){if(!this.id)return!0;if(this.mapCanvas=this.main.dv.container.querySelector("#"+this.id),this.mapCanvas){if("undefined"!=typeof google&&google.maps||window.initMapWidget){if("undefined"==typeof google)return!1;this.initMap()}else window.initMapWidget=this.initMap.bind(this),this.addMapScript(this.key||"AIzaSyDmODzVAnfVQJAQz8BG9Low_F_8mFTHWNw");return!0}return!1},W.prototype.initMap=function(){var e=this;this.map=new google.maps.Map(this.mapCanvas,{});var t=new google.maps.LatLngBounds;function i(){if(e.locations&&e.locations.length>0)if(e.locations.forEach((function(i){var n=new google.maps.LatLng(i.lat,i.lng);t.extend(n),e.displayMap(n,i.address,i.name)})),e.locations.length>1)e.map.fitBounds(t);else{var i=new google.maps.LatLng(e.locations[0].lat,e.locations[0].lng);e.map.setCenter(i),e.map.setZoom(17)}}if(this.addresses){var n=new google.maps.Geocoder;this.locations=[],this.addresses.forEach((function(t,s){n.geocode({address:t},(function(n,a){"OK"==a&&(e.displayMap(n[0].geometry.location.lat(),n[0].geometry.location.lng()),e.locations.push({lat:n[0].geometry.location.lat(),lng:n[0].geometry.location.lng(),address:t})),s==e.addresses.length-1&&i()}))}))}else i()},W.prototype.displayMap=function(e,t){var i=new google.maps.Marker({position:e,map:this.map,title:t});i.setMap(this.map);var n,s,a=new google.maps.InfoWindow({content:t});google.maps.event.addListener(i,"click",(n=i,s=this.map,function(){a.open(s,n)}))},W.prototype.addMapScript=function(e){var t=document.createElement("script");t.setAttribute("src","https://maps.googleapis.com/maps/api/js?key="+e+"&callback=initMapWidget"),document.body.appendChild(t)},u.extend(G,C),G.prototype.getHTML=function(){var e="<p";return e+=" class='nuan-para nuan-link' ",e+=this.getStyle(),e+=this.setAriaHiddenText(this.ariaHidden),e+=">",e+=this.text.replace(/{link:(.*?),(.*?),(.*?)}/g,this.replacer.bind(this)),e+="</p>",this.hiddenLabel&&this.encodeLabel(this.hiddenLabel),e},G.prototype.onClickEvent=function(e){for(var t=0;t<e.target.attributes.length;t++){var i=e.target.attributes[t];i.specified&&i.name.startsWith("vtz-")&&(this[i.name.split("-")[1]]=i.value)}this.event&&G.superProto.invokeHandlers.call(this),this.selectedLinkText=e.target.text,e.preventDefault()},G.prototype.getOutputText=function(){return this.selectedLinkText},G.prototype.replacer=function(e,t,i,n){var s="<a class='formatted-link' href='";return s+=t,s+="'",this.context&&(this.context.linkColor&&(this.textColor=this.context.linkColor),this.context.linkStyle&&(this.textStyle=this.context.linkStyle),this.context.linkSize&&(this.textSize=this.context.linkSize)),s+=this.getStyle(),n&&(n=n.split(",")).forEach((function(e){s+=" ",s+=e})),s+=">",s+=i,this.linkText=i,s+="</a>"},G.prototype.isPlugin=function(){return!0},G.prototype.renderPlugin=function(){var e=this;if(!this.id||this.main.isReloading)return!0;var t=this.main.dv.container.querySelectorAll("a.formatted-link");return!!(t&&t.length>0)&&(this.linkClick=s(this,this.onClickEvent),Array.prototype.forEach.call(t,(function(t){t.addEventListener("click",e.linkClick)})),!0)},G.prototype.resetData=function(){this.selectedLinkText="",Object.keys(this).forEach((function(e){e.startsWith("vtz")&&(this[e]="")}))},G.prototype.clear=function(){var e=this.main.dv.container.querySelectorAll("a");e&&e.length>0&&e.forEach((function(e){e.removeEventListener("click",this.linkClick)}))},z.getFromStore=function(e){return"NS"===e?this.nodeStore:"TS"===e?this.transitionStore:"CS"===e?this.constantStore:null},z.setupFactory=function(e,t,i){var n=e.nodes,s=t||e.initialState;n&&n.forEach((function(e){var t=new Y(e,i);this.nodeStore.push(t),e.id===s&&(this.initialNode=t)}),this),e.transitions&&e.transitions.forEach((function(e){this.transitionStore.push(new ne(e))}),this),e.constants&&(this.constantStore=new ie(e.constants))},z.getInitialNode=function(){return this.initialNode?this.initialNode:this.nodeStore[0]},z.getNodefromStore=function(e){var t;return this.nodeStore?(this.nodeStore.forEach((function(i){i.id==e&&(t=i)})),t):null},z.getNodeIndex=function(e){var t=1;return this.nodeStore&&this.nodeStore.some((function(i){return i.id==e||(t+=1,!1)})),t},z.getTransitionFromStore=function(e,t){var i;if(this.transitionStore)for(var n=0;n<this.transitionStore.length;n++)if(i=this.transitionStore[n].getFromStoreByEvent(e,t))return i;return i},z.getNodeSize=function(){return this.nodeStore.length},z.setupFactory.clear=function(){this.nodeStore=[]},Y.prototype.getControls=function(){return this.controls},X.prototype.addToHandler=function(e){var t=this.controls[e.visible.trigger];t?t.push(e):this.controls[e.visible.trigger]=[e]},X.prototype.invokeVisibilityEvent=function(e){var t=this.controls[e];t&&t.forEach((function(e){e.onVisibilityChange()}))},X.prototype.clear=function(){this.controls={}},K.prototype.addToHandler=function(e){var t=this.controls[e.enabled.trigger];t?t.push(e):this.controls[e.enabled.trigger]=[e]},K.prototype.invokeEvent=function(e){var t=this.controls[e];t&&t.forEach((function(e){e.onEnableDisableChange()}))},K.prototype.clear=function(){this.controls={}};var J="STARTING",Q="STARTED",Z="PRESENTED";function ee(e){this.questions=[],this.richInstance=e,this.ariaOutput=[]}function te(e){this.main=e,this.answers=[],this.anserCache={}}function ie(e){Array.isArray(e)&&e.forEach((function(e){this[e.name]=e.value}),this)}function ne(e){u.isObject(e)&&u.copy(e,this)}function se(e,t){e.dv.clear(t),e.vh.clear(),e.edh.clear(),e.ev.clearListeners()}function ae(){this.sf=new z,this.dv=new ee(this),this.ev=new h,this.vh=new X,this.edh=new K,this.th=new te(this)}return ee.prototype.createPaginationContainer=function(e){var t=document.createElement("div");return t.classList.add("nuan-node-bar-container"),e.appendChild(t),t},ee.prototype.displayPagination=function(e,t,i){this.isPaginationDisplayed=!0;var n=document.createDocumentFragment(),s=document.createElement("div");n.appendChild(s);var a=e.clientWidth,o=getComputedStyle(e);a=a-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight);var r=["<div class='nuan-node-bar'  style='"];this.pageHW=parseInt(a/z.getNodeSize.call(i),10),t.background&&r.push("background-color:",t.background,";"),r.push("width:",this.pageHW,"px;'"),r.push("></div>"),n.firstChild.innerHTML=r.join(""),e.appendChild(n),this.sf=i,this.pContainer=e,this.pageSpec=t},ee.prototype.updatePagination=function(e){var t=this.pContainer.querySelector(".nuan-node-bar");t&&(this.pageSpec.style&&"step"!=this.pageSpec.style?t.style.width=this.pageHW*e+"px":t.style.left=t.clientWidth*(e-1)+"px")},ee.prototype.initRendering=function(e,t,i,n,s){this.currentVisibleNode=e,this.container=this.container||t,this.state=J,this.continerHTML=[],this.type=this.type||i,this.shouldLock=void 0===s||s,this.isBuilder=this.isBuilder||n,this.continerHTML.push("<div tabindex='-1' class='nuan-widget-container nuan-mlr-1 nuan-p-1 "),this.continerHTML.push(this.type?this.type:"form"),this.isBuilder&&this.continerHTML.push(" builder"),this.continerHTML.push("'"),this.continerHTML.push(this.widgetContainerStyle(e.context),">"),this.questions=[],this.ariaOutput=[],this.renderVisibleNode(),this.isPaginationDisplayed&&this.updatePagination(z.getNodeIndex.call(this.sf,e.id)),this.richInstance.viewRenderedCb&&this.richInstance.viewRenderedCb(this.ariaOutput)},ee.prototype.initRenderingPartial=function(e,t,i,n){this.container=e,this.continerHTML=[],this.continerHTML.push("<div class='nuan-widget-container nuan-mlr-1 nuan-p-1"),this.isBuilder=n,this.isBuilder&&this.continerHTML.push(" builder"),this.continerHTML.push("'>");var s=this;if(this.isBuilder=n,t.items)t.items.forEach((function(e){var t=d.createControlInstance(e,i);t.main=i,s.renderControl(t)}));else if(t.type){var a=d.createControlInstance(t,i);a.main=i,s.renderControl(a)}this.continerHTML.push("</div>"),this.insertFragment()},ee.prototype.widgetContainerStyle=function(e){if(!e)return"";var t=[" style='"];return e.widgetContainerBorderRadius&&t.push("border-radius:",e.widgetContainerBorderRadius,"px;"),e.widgetContainerBorderColor&&(t.push("border-color:",e.widgetContainerBorderColor,";"),t.push("border-width:1px;"),t.push("border-style:solid;")),e.widgetContainerBackgroundColor&&t.push("background-color:",e.widgetContainerBackgroundColor,";"),void 0!==e.widgetContainerPadding&&t.push("padding:",e.widgetContainerPadding,"px!important;"),e.widgetContainerShadow&&(e.boxShadow=e.widgetContainerShadow,d.getBoxShadow(e,t)),e.widgetMarginLeft>=0&&t.push("margin-left:",e.widgetMarginLeft,"px;"),e.widgetMarginRight>=0&&t.push("margin-right:",e.widgetMarginRight,"px;"),t.push("'"),t.join("")},ee.prototype.renderVisibleNode=function(){var e,t=this;this.state=Q,this.plugins=[],this.carousels=[],this.currentVisibleNode.getControls().forEach((function(i){t.renderControl(i),(e=i.getAriaOutput())&&t.ariaOutput.push(e)})),this.continerHTML.push("</div>"),this.isBuilder&&this.continerHTML.push(this.getToolTipForBuilder()),this.state=Z,this.insertFragment()},ee.prototype.insertFragment=function(){var e=document.createDocumentFragment(),t=document.createElement("div");if(t.style.height="100%",this.isBuilder&&t.classList.add("builder"),t.classList.add("nuan-widget-outer-cont"),e.appendChild(t),e.firstChild.innerHTML=this.continerHTML.join(""),this.container.appendChild(e),this.richInstance.isReloading){if(this.carousels.length>0){var i=this.plugins;this.plugin=this.carousels,this.renderPlugins(0),this.plugins=i}}else this.renderPlugins(0)},ee.prototype.renderControl=function(e){this.continerHTML.push('<div class="nuan-row'),e.checkVisibleCondition()||this.continerHTML.push(" displayoff"),e.type&&this.continerHTML.push(" "+e.type.toLowerCase()),this.continerHTML.push(this.getContainerAlignment(e)),this.continerHTML.push(this.showSeparator(e)),this.continerHTML.push('" '),this.continerHTML.push(d.getContStyleProps(e)),e.isPlugin()&&(this.plugins.push(e),"CardDeck"==e.type&&this.carousels.push(e)),this.continerHTML.push(">"),this.continerHTML.push(e.getHTML()),this.isBuilder&&this.continerHTML.push(this.getToolTipForBuilder()),this.continerHTML.push("</div>")},ee.prototype.addDropZone=function(){this.continerHTML.push('<div class="nuan-row dropzone'),this.continerHTML.push('">'),this.continerHTML.push("<p> Drop zone </p>"),this.continerHTML.push("</div>")},ee.prototype.getToolTipForBuilder=function(){return"<div class='richio-tooltip'><div class='btn-group mr-2' role='group'><i class='far fa-edit'></i><i class='far fa-trash-alt ml-1'></i></div></div>"},ee.prototype.getContainerAlignment=function(e){switch(e.containerAlign){case"alignParentBottom":return" container-positioning-bottom";case"alignParentLeft":break;case"alignParentRight":return" container-positioning-right";case"alignParentCenter":return" container-positioning-center"}return""},ee.prototype.showSeparator=function(e){return e.containerSeperator||e.containerSeparator?" container-seperator container-separator":""},ee.prototype.renderPlugins=function(e){var t=this,i=e;t.plugins&&setTimeout((function(){for(;i<t.plugins.length;i++)t.plugins[i].renderPlugin()||setTimeout(t.renderPlugins.bind(t,i),100)}),200)},ee.prototype.clear=function(e){if(this.currentVisibleNode=null,this.state=J,this.plugins){for(var t=0;t<this.plugins.length;t++)this.plugins[t].clear();this.plugins=[]}if(this.carousels&&(this.carousels=[]),this.container&&e)this.container.innerHTML="";else if(this.container){var i=this.container.querySelector(".nuan-widget-outer-cont");i.parentElement.removeChild(i)}},ee.prototype.getPresentedQuestion=function(){return this.questions},ee.prototype.setNodesValues=function(e,t){if(t)z.getNodefromStore.call(main.sf,t.name.slice(1)).getControls()},ee.prototype.getNodeID=function(){return this.currentVisibleNode&&this.currentVisibleNode.id},ee.prototype.getNodeName=function(){return this.currentVisibleNode&&this.currentVisibleNode.name},te.prototype.handleTransition=function(e,t){var i=this.main,n=i.dv.currentVisibleNode,s=z.getTransitionFromStore.call(i.sf,e,n.id);if(null!=s){if(t&&!this.validate(n))return void(this.answers=[]);if("string"==typeof s.to)this.transitionView(s.to);else{var a=s.to.guard;if(a)if(u.isObject(a))this.checkGuardCondition(a.condition)?"string"==typeof a.onTrue?this.transitionView(a.onTrue):this.sendCustomAction(a.onTrue):a.onFalse?this.transitionView(a.onFalse):this.answers=[];else{var o,r;for(r=0;r<a.length;r++)if(o=a[r],this.checkGuardCondition(o.condition)){"string"==typeof o.onTrue?this.transitionView(o.onTrue):this.sendCustomAction(a.onTrue);break}r===a.length&&(a.onFalse?this.transitionView(a.onFalse):this.answers=[])}else this.sendCustomAction(s.to)}}},te.prototype.transitionView=function(e){if(e){var t=this.main.dv;t.isBuilder&&this.main.builderViewChangeStartCb&&this.main.builderViewChangeStartCb();var i=t.getPresentedQuestion(),n=this.answers,s=t.getNodeID(),a=t.getNodeName();this.answers=[],se(this.main),t.initRendering(z.getNodefromStore.call(this.main.sf,e)),t.isBuilder?setTimeout(function(){this.main.builderViewChangeCb&&this.main.builderViewChangeCb()}.bind(this),1e3):this.main.viewChangeCb&&this.main.viewChangeCb(s,a,i,n,t.getNodeID(),t.getNodeName(),t.getPresentedQuestion())}},te.prototype.resetCurrrentNode=function(){for(var e=this.main.dv.currentVisibleNode,t=e.getControls(),i=0;i<t.length;i++)t[i].resetData();this.main.dv.isBuilder&&this.main.builderViewChangeStartCb&&this.main.builderViewChangeStartCb(),se(this.main),this.answers=[],this.main.dv.initRendering(e),this.main.dv.isBuilder&&setTimeout(function(){this.main.builderViewChangeCb&&this.main.builderViewChangeCb()}.bind(this),1e3)},te.prototype.validate=function(e){for(var t=e.getControls(),i=[],n=0;n<t.length;n++)t[n].executeValidation()||i.push(t[n]);return!(i.length>0)||(i[0].forceFocus(),!1)},te.prototype.checkGuardCondition=function(e){return u.executeParser(i(e),this.main)},te.prototype.sendCustomAction=function(e){if(e.engage){var t="Customer navigated to chat window";if(e.engage.checkAgent&&e.engage.data&&this.main.CIAPIinst){var i=e.engage.data,n=e.engage.checkAgent,s=this;i.businessUnitID&&this.main.CIAPIinst.checkAgentAvailability(i.businessUnitID,i.agentGroupId,i.agentAttrs,i.queueThreshold,(function(i){var a;Object(i)==i&&(i.inHOP?"offline"==i.status?(a=n.offline,t="Agents are offline"):"buzy"==i.status?(a=n.buzy,t="Agents are buzy"):"online"==i.status&&s.sendEngageAction(e.engage):(a=n.isNotHop,t="Not in hours of operation"),s.fireAutomatonEndEvent(t),a&&s.transitionView(a))}))}else this.sendEngageAction(e.engage),this.fireAutomatonEndEvent(t)}else if(e.survey){this.parseResult(e);this.main.cb&&this.main.cb(e),this.main.disable(),this.fireAutomatonEndEvent("Customer completed post chat survey.")}else if(Array.isArray(e))for(var a=0;a<e.length;a++)"string"==typeof e[a]?this.transitionView(e[a]):this.sendCustomAction(e[a]);else if(e){var o=JSON.parse(JSON.stringify(e));this.parseResult(o),this.main.dv.shouldLock?this.main.disable():this.anserCache={},this.main.cb&&this.main.cb(o),this.fireAutomatonEndEvent("Customer selection made")}},te.prototype.sendEngageAction=function(e){e.datapass&&this.parseResult(e),this.main.disable(),this.main.cb&&this.main.cb(e)},te.prototype.fireAutomatonEndEvent=function(e){if(this.main.viewEndedCb){var t=this.main.dv;this.main.viewEndedCb(t.getNodeID(),t.getNodeName(),!0,e,t.getPresentedQuestion(),this.answers),this.main.viewChangeCb=null,this.main.viewEndedCb=null}},te.prototype.parseResult=function(e){for(var t in e){var i=e[t];i instanceof Object&&this.parseValues(i)}},te.prototype.parseValues=function(e){for(var t,n,s=Object.keys(e),a=0;a<s.length;a++)t=e[s[a]],"object"===bi()(t)?s[a].startsWith("constants")?t.forEach(function(e){this.parseValues(e)}.bind(this)):u.isObject(t)&&this.parseValues(t):"string"!=typeof t||t.startsWith("#EmptyAnswer")||(0==t.indexOf("#")&&"#"!=t.charAt(1)?(this.anserCache[t]?n=this.anserCache[t]:(n=u.valueMapper(i(t),this.main),this.anserCache[t]=n),e[s[a]]=n):-1!=t.indexOf("{#")&&(e[s[a]]=u.parseValueMapperTemplate(t,this.main)))},te.prototype.addToAnswers=function(e){this.answers.push(e)},ie.prototype.getConstant=function(e){return this[e=e.slice(1)]?this[e]:e},ne.prototype.getFromStoreByEvent=function(e,t){return this.trigger===e&&this.from===t?this:null},ae.prototype.renderRichContentinCI=function(e){this.viewStartedCb=e.viewStartedCb,this.viewChangeCb=e.viewChangeCb,this.viewEndedCb=e.viewEndedCb,this.renderRichContent(e.spec,e.container,e.initalView,e.isReload,!1,e.viewRenderedCb)},ae.prototype.renderRichContent=function(e,i,s,a,o,r){var l;return u.isObject(e)||t("spec param should be a json object"),i||t("Container must be provided to render rich html"),e.pagination&&(l=this.dv.createPaginationContainer(i)),this.isReloading=a||!1,r&&(this.viewRenderedCb=r),z.setupFactory.call(this.sf,e,s,this),a||this.ev.addDispatcherToContainer(i),this.dv.initRendering(z.getInitialNode.call(this.sf),i,e.widgetType,o,e.lockView),this.viewStartedCb&&this.viewStartedCb(this.dv.getNodeID(),this.dv.getNodeName(),this.dv.getPresentedQuestion()),e.pagination&&this.dv.displayPagination(l,e.pagination,this.sf,i),n()&&i.classList.add("can-touch"),this},ae.prototype.renderRichContentWithPagination=function(e,t,i,n,s){var a,o=e.pagination;return e.pagination=null,a=this.renderRichContent(e,t,n,s),o&&this.dv.displayPagination(i,o,this.sf),a},ae.prototype.renderRichContentForBuilder=function(e,t,i,n,s,a){return this.builderViewChangeCb=a,this.builderViewChangeStartCb=s,this.renderRichContent(e,t,i,n,!0)},ae.prototype.renderSurveyContent=function(e){this.viewStartedCb=e.viewStartedCb,this.viewChangeCb=e.viewChangeCb,this.viewEndedCb=e.viewEndedCb,this.viewRenderedCb=e.viewRenderedCb;var t,i=e.spec.pagination;return e.paginationContainer&&(e.spec.pagination=null),t=this.renderRichContent(e.spec,e.container,e.initalView||"",e.isReload||!1,!1),i&&e.paginationContainer&&this.dv.displayPagination(e.paginationContainer,i,this.sf),this.CIAPIinst=e.CIAPI,t},ae.prototype.fireCloseSurveyEvent=function(){this.viewEndedCb&&this.viewEndedCb(this.dv.getNodeID(),this.dv.getNodeName(),!1,"Customer closed chat window",this.dv.getPresentedQuestion(),this.th.answers,z.getNodeIndex.call(this.sf,this.dv.getNodeID())>1)},ae.prototype.renderPartialContent=function(e,t,i){this.dv.initRenderingPartial(t,e,this,i)},ae.prototype.disable=function(){this.dv.currentVisibleNode.getControls().forEach((function(e){e.disable()}))},ae.prototype.enable=function(){this.dv.currentVisibleNode.getControls().forEach((function(e){e.enable()}))},ae.prototype.registerCBListener=function(e){this.cb=e},ae.prototype.setControlValues=function(){},ae.prototype.clearAll=function(){se(this,!0)},{setup:function(i){u.isObject(i)||t("allowed type for config param is object"),e={skinPath:i.skinPath?i.skinPath:""},i.isDivChat&&window.parent.document},get instance(){return new ae}}}();function Mc(e){var t=e.getChatParams();return{chatID:t.getChatID(),siteID:t.siteID,businessUnitID:t.businessUnitID,agentGroupID:t.agId,customerID:t.getCustomerID(),pageID:t.getLaunchPageId(),businessRuleID:t.brID,agentID:t.agentID,incAssignmentID:t.incAssignmentID,availableAgentAttributes:t.agentAttributes,sessionID:t.sessionID,visitorAttributes:t.getVisitorAttributes(),brAttributes:t.ruleAttributes,deviceType:t.getDeviceType(),operatingSystemType:t.getOperatingSystemType(),browserType:t.getBrowserType(),browserVersion:t.getBrowserVersion(),countryCode:t.countryCode,regionCode:t.regionCode,preAssigned:!e.isConnected()&&!t.agentID}}function Lc(e,t,i,n,s,a,o){var r={_domain:"automaton",evt:"contentSentToCustomer",unique_node_id:t,"custom.decisiontree.nodeID":encodeURIComponent(t||""),"custom.decisiontree.questions":encodeURIComponent(Pc(n)),"custom.decisiontree.questionIDs":encodeURIComponent(s.join(",")),clientTimestamp:Date.now(),automatonType:o||"guide"};return Object.assign(r,a),e.widgetID&&(r.automatonID=e.widgetID),e.widgetName&&(r.automatonName=e.widgetName),r.automatonOrigin=j,r}function Pc(e){var t=e.join(",");return encodeURIComponent(t)}function _c(e,t,i,n,s,a,o){var r=[],l=[],c=[],u=[],h=[];s.forEach((function(e){var t=e.id,i=e.val,n=e.lbl,s=e.type,a=e.ansID;h.push(t),l.push(a),r.push(n),c.push(i||null),u.push(s)}));var d={_domain:"automaton",evt:"customerResponded",unique_node_id:t,"custom.decisiontree.nodeID":encodeURIComponent(t||""),"custom.decisiontree.questionIDs":encodeURIComponent(h.join(",")),"custom.decisiontree.questions":Pc(r),"custom.decisiontree.answers":encodeURIComponent(c.join(",")),"custom.decisiontree.answerIDs":encodeURIComponent(l.join(",")),"custom.decisiontree.answerTypes":encodeURIComponent(u.join(",")),clientTimestamp:Date.now(),automatonType:o||"guide"};return e.widgetID&&(d.automatonID=e.widgetID),e.widgetName&&(d.automatonName=e.widgetName),d.automatonOrigin=j,Object.assign(d,a),d}function Dc(e,t,i,n,s){var a={_domain:"automaton",evt:"started",automatonType:s,automatonStartedBy:t,startedIn:i,type:s,clientTimestamp:Date.now()};return Object.assign(a,n),e.widgetID&&(a.automatonID=e.widgetID),e.widgetName&&(a.automatonName=e.widgetName),a.automatonOrigin=j,a}function Oc(e,t,i,n,s,a){var o={_domain:"automaton",evt:"ended",automatonType:a||"guide","automaton.outcomeType":t?"Completed":n?"Abandoned":"Refused",clientTimestamp:Date.now()};return i&&(o["automaton.outcome"]=i),e.widgetID&&(o.automatonID=e.widgetID),e.widgetName&&(o.automatonName=e.widgetName),o.automatonOrigin=j,Object.assign(o,s),o}window.RichMain=Ac;var Rc={tagName:"survey-view",template:jc.a,created:function(){this.quesCache={},this.ciapi=this.$app.getCIAPIInstance(),this.surveyJson={},this.ariaUtil=new zn(this.$app)},removed:function(){this.richInstance&&(this.richInstance.clearAll(),this.richInstance=null),this.setSurveyStates(!1)},render:function(){var e=this,t=this.$app.getUIConfig();return new Promise((function(i,n){t.pcsID?(e.chatEventObject=e.getEventDefaultParams(),jn(window.messagingApp.loadConfig,t.skinPath,"".concat(t.pcsID,".json")).then((function(t){e.surveyJson=t,e.invokeRichEngine(t,!1,(function(t){t.closeChat?e.$app.closeChat():i(t)}))})).catch((function(){i()}))):i(),e.testClick=function(){i()}}))},setSurveyStates:function(e,t){this.$app.getStateMgr().setStateItem("survey.visible",e),t&&this.$app.getStateMgr().setStateItem("survey.evt",t)},renderPostChatSurvey:function(e,t,i){var n=this,s=this.$app.getUIConfig();this.chatEventObject=t||this.getEventDefaultParams(),i&&(this.chatEventObject.siteID=i.siteID,this.chatEventObject.businessUnitID=i.businessUnitID,this.chatEventObject.agentGroupID=i.agentGroupID,this.chatEventObject.agentID=i.agentID,this.chatEventObject.availableAgentAttributes="",this.chatEventObject.customerID=i.customerID,this.chatEventObject.conversationID=i.conversationID,this.chatEventObject.initialCustomerID=i.customerID,this.chatEventObject.chatID=i.engagementID),jn(window.messagingApp.loadConfig,s.skinPath,"".concat(e,".json")).then((function(e){n.surveyJson=e,n.surveyJson.widgetType="satisfactionSurvey",n.invokeRichEngine(e,!0,(function(e){var t=e.closeChat;e.survey&&n.submitPostChatSurveyData(e),t&&(n.richInstance.clearAll(),n.richInstance=null,n.$app.closeChat(),n.ciapi.isPersistentWindow()&&bn((function(){window.parent.close()}),200))}))})).catch((function(){}))},invokeRichEngine:function(e,t,i){window.RichMain&&(this.richInstance=window.RichMain.instance,this.richInstance.renderSurveyContent({spec:e,viewStartedCb:t?this.firePostChatStartedEvent.bind(this):this.firePreChatStartedEvent.bind(this),viewChangeCb:this.fireCustomerRespondedEvent.bind(this),viewEndedCb:this.fireAutomationEndedEvent.bind(this),container:this.el.firstElementChild,CIAPI:this.ciapi,viewRenderedCb:this.announceRichAriaOutputs.bind(this)}),this.richInstance.registerCBListener((function(e){i(e)})))},announceRichAriaOutputs:function(e){var t=e.filter((function(e){return e.accessibilityReader}));this.ariaUtil.announceRichDataMessage(t)},firePreChatStartedEvent:function(e,t,i){var n={_domain:"engagement",evt:"requested",automatonType:"rich-engine",clientTimestamp:Date.now()};Object.assign(n,this.chatEventObject);var s=Dc(this.surveyJson,"br,".concat(this.chatEventObject.businessRuleID),"chat",this.chatEventObject,this.surveyJson.widgetType||"guide"),a=this.contentSendToCustomer(this.surveyJson,e,t,i);this.surveyJson.widgetID&&(n["automaton.automatonID"]=this.surveyJson.widgetID),this.surveyJson.widgetName&&(n.automatonName=this.surveyJson.widgetName),this.ciapi.logEventToDW({eventList:[n,s,a]}),this.setSurveyStates(!0,s.evt)},firePostChatStartedEvent:function(e,t,i){var n=Dc(this.surveyJson,"survey,survey","chat",this.chatEventObject,this.surveyJson.widgetType||"satisfactionSurvey"),s=this.contentSendToCustomer(this.surveyJson,e,t,i);this.ciapi.logEventToDW({eventList:[n,s]}),this.setSurveyStates(!0,n.evt)},fireCustomerRespondedEvent:function(e,t,i,n,s,a,o){var r=this.getCustomerResponded(this.surveyJson,e,t,i,n),l=this.contentSendToCustomer(this.surveyJson,s,a,o);this.ciapi.logEventToDW({eventList:[r,l]})},fireAutomationEndedEvent:function(e,t,i,n,s,a,o){var r=this.getCustomerResponded(this.surveyJson,e,t,s,a),l=Oc(this.surveyJson,i,n,o,this.chatEventObject,this.surveyJson.widgetType);this.ciapi.logEventToDW({eventList:[r,l]}),this.surveyJson={},this.setSurveyStates(!1,l.evt)},getEventDefaultParams:function(){return Mc(this.ciapi)},submitPostChatSurveyData:function(e){var t,i=this,n={engagementId:this.chatEventObject.chatID,siteId:this.chatEventObject.siteID};n.surveyQuestions=[],Object.keys(e.survey).forEach((function(s){t={id:s},i.quesCache[s]&&e.survey[s]&&(t.question=i.quesCache[s],t.answer=String(e.survey[s]),n.surveyQuestions.push(t))})),delete e.survey,delete e.closeChat,Object.keys(e).forEach((function(t){n[t]=e[t]})),this.ciapi.submitNativePostChatSurvey(n)},contentSendToCustomer:function(e,t,i,n){var s=this,a=[],o=[];return n.forEach((function(e){var t=e.id,i=e.lbl;o.push(t),a.push(i),s.quesCache[t]=i})),Lc(e,t,0,a,o,this.chatEventObject,e.widgetType)},getCustomerResponded:function(e,t,i,n,s){return _c(e,t,0,0,s,this.chatEventObject,e.widgetType)},closeChat:function(){this.richInstance&&this.richInstance.fireCloseSurveyEvent()}},Bc=function(e){var t=e.getUIConfig();return Rc.$app=e,Rc.constants={},t.surveyContainerStyles&&(Rc.constants.style=t.surveyContainerStyles),Rc.constants.extendedSurveyTopBarVisible=e.extendedSurveyTopBarVisible,Rc.constants.extendedSurveyFooterVisible=e.extendedSurveyFooterVisible,Rc},Vc=i(38),Nc={tagName:"rich-view",template:i.n(Vc).a,created:function(){this.ariaUtil=new zn(this.$app),this.msgInfo=this.el.querySelector(".msg-info")},render:function(e){var t=e.getRichData(),i=this.getContainer();if(this.setSpeechImage(e,t),e.getMessageText()&&t.showMessageText&&!e.isEmptyResponse()){var n=document.createElement("agent-simple-view");i.appendChild(n),n.render(e)}else this.msgInfo&&!t.customerAction&&(this.msgInfo.classList.remove("hide"),this.agentAliasEl=this.msgInfo.querySelector(".msg-info-name span"),this.timeEl=this.msgInfo.querySelector(".msg-info-time span"),this.agentAliasEl&&(this.agentAliasEl.innerText=e.getName()),this.timeEl&&(this.timeEl.innerText=Ji(parseInt(e.getTimeStamp(),10),this.format)));this.richContainer=document.createElement("div"),this.updateStyleProps(this.richContainer,e),i.appendChild(this.richContainer),this.richContainer.classList.add("rich-container"),this.renderRichView(t,e),e.setRichInstance(this.richInstance)},reload:function(e){this.richInstance&&this.richInstance.clearAll(),this.richContainer.classList.remove("enter");var t=e.getRichData();this.renderRichView(t,e),e.setRichInstance(this.richInstance)},renderRichView:function(e,t){var i=this;if(window.RichMain){this.richInstance=window.RichMain.instance;var n=!1,s=this.richmediaReporting;t.getIsRestore()&&!t.isLast()?(n=void 0===e.lockView||e.lockView,s=!1):this.speechCon&&this.speechCon.classList.remove("enter"),xl(this.richInstance,this.$app,e.customerAction?e.receipt:e,this.richContainer,e.customerAction||n,s,(function(n){i.setAccessibilityFocus(n,e,t)})),Il(this.$app,this.richInstance,this.logLinks),t.getIsRestore()?this.richContainer.classList.add("enter"):(bn.exists("richTimer")&&!bn.executed("richTimer")&&bn.clear("richTimer")(),bn.set("richTimer",(function(){i.speechCon&&i.speechCon.classList.add("enter"),i.richContainer.classList.add("enter"),e.customerAction&&(delete e.customerAction,i.sendData(t,e))}),e.customerAction?this.richWidgetReceiptTimer:25)),e.customerAction||this.richContainer.addEventListener("click",(function(e){"a"===e.target.tagName.toLowerCase()&&(i.logLinks&&El(i.$app,i.logLinks,e.target.href),i.$app.bridge.pushToFrameSet(e.target.href,e.target.target),e.preventDefault())}))}},updateStyleProps:function(e,t){var i=this.richStyleProps.other,n=this.otherstyle;switch(t.getMessageBubble()){case Mi.RICH_MESSAGE_CARD:i=this.richStyleProps.card,n=this.cstyle;break;case Mi.RICH_MESSAGE_QR:i=this.richStyleProps.qr,n=this.qrstyle;break;case Mi.RICH_MESSAGE_FORM:i=this.richStyleProps.form,n=this.formstyle;break;case Mi.RICH_MESSAGE_RECEIPT:i=this.richStyleProps.receipt,n=this.receiptstyle}Fi(i,e),Fi(n,e)},sendData:function(e,t){var i=this;bn.set("richRTimer",(function(){i.$app.CIAPIInstance.sendRichContentMessage(e.getMessageText(),t,i.$app.onEngageResponse.bind(i.$app))}),this.richWidgetReceiptTimer)},setSpeechImage:function(e,t){this.showAvatar&&!t.showMessageText&&Tl.bind(this)(e)},getContainer:function(){return this.el.querySelector(".richBubbleContainer")},setAccessibilityFocus:function(e,t,i){var n=!1;if(!i.getIsRestore())if(t.showMessageText){n=!0;var s=this.el.querySelector(".agent-bubble");this.$app.focusMgr.handleFocusSetting(s,t.focusSettingMode||this.focusSettingMode),this.ariaUtil.announceBubbleText(i.getMessageText(),i.getName())}else t.customerAction||(n=this.$app.focusMgr.handleFocusSetting(this.el.querySelector(".nuan-widget-container"),t.focusSettingMode));var a=i.isLast();(n||a)&&this.ariaUtil.announceRichDataMessage(e),a&&this.$app.focusMgr.setFocusIfFocusNotInTranscript()}},Hc=function(e){Nc.$app=e;var t,i={},n={},s=e.getUIConfig();if(s.transcriptConfig){var a=s.transcriptConfig;i.cstyle=a.richCardViewStyles,i.qrstyle=a.richQRViewStyles,i.formstyle=a.richFormViewStyles,i.receiptstyle=a.richReceiptViewStyles,i.otherstyle=a.richOtherViewStyles,i.agentSpeechConfig=a.agentSpeechAvatarConfig,i.vaSpeechConfig=a.vaSpeechAvatarConfig,i.openerSpeechConfig=a.openerSpeechAvatarConfig,i.nameStyle=a.agentAliasStyles,i.timeStyle=a.dateTimeStyles,i.avatarStyle=a.speechAvatarStyles,i.focusSettingMode=e.focusOnAgentMessage,t=s.transcriptConfig.richStyleProperties||{}}else t={};var o=s.appConfigProps;return o&&(i.richWidgetReceiptTimer=o.richWidgetReceiptTimer||50,i.showName=o.displayAgentAliasInRichWidget,i.showTime=o.displayDateAndTimeInRichWidget,i.showRichInfo=i.showName||i.showTime,i.format=o.timeStampFormat||"HH:mm",i.showAvatar=o.setAgentSpeechView&&o.showRichAvatar,i.speechPos=o.speechImgPosition,i.richmediaReporting=o.enableRichMediaReporting,i.logLinks=o.logSelectedLinks),n.card={},n.card.marginLeft="".concat(t.cardViewLeftMargin||0,"px"),n.card.marginBottom="".concat(t.cardViewBottomMargin||15,"px"),n.card.marginRight="".concat(t.cardViewRightMargin||0,"px"),n.card.marginTop="".concat(t.cardViewTopMargin||-10,"px"),n.form={},n.form.marginLeft="".concat(t.formViewLeftMargin||0,"px"),n.form.marginBottom="".concat(t.formViewBottomMargin||15,"px"),n.form.marginRight="".concat(t.formViewRightMargin||0,"px"),n.form.marginTop="".concat(t.formViewTopMargin||-10,"px"),n.qr={},n.qr.marginLeft="".concat(t.qrViewLeftMargin||0,"px"),n.qr.marginBottom="".concat(t.qrViewBottomMargin||15,"px"),n.qr.marginRight="".concat(t.qrViewRightMargin||0,"px"),n.qr.marginTop="".concat(t.qrViewTopMargin||-10,"px"),n.receipt={},n.receipt.marginLeft="".concat(t.receiptViewLeftMargin||0,"px"),n.receipt.marginBottom="".concat(t.receiptViewBottomMargin||15,"px"),n.receipt.marginRight="".concat(t.receiptViewRightMargin||0,"px"),n.receipt.marginTop="".concat(t.receiptViewTopMargin||-10,"px"),n.other={},n.other.marginLeft="".concat(t.otherViewLeftMargin||0,"px"),n.other.marginBottom="".concat(t.otherViewBottomMargin||15,"px"),n.other.marginRight="".concat(t.otherViewRightMargin||0,"px"),n.other.marginTop="".concat(t.otherViewTopMargin||-10,"px"),i.richStyleProps=n,Nc.constants=i,Nc},Fc=i(39),$c={tagName:"disclaimer-footer-view",template:i.n(Fc).a,created:function(){this.ariaUtil=new zn(this.$app),this.cont=this.el.firstChild,this.disclaimer=this.cont.querySelector(".disclaimer"),Fi(this.disclaimerStyleProps,this.cont),this.disText=this.disclaimer.lastElementChild,this.icon=this.disclaimer.firstElementChild,this.updateBackground()},updateBackground:function(){if(this.disclaimerText&&(this.disclaimerText=this.ariaUtil.injectAttributes(this.disclaimerText),this.disText.innerHTML=Gi(this.disclaimerText),this.$app.getRestoring()||this.ariaUtil.announceBubbleText(this.disclaimerText)),this.disImgConfig){var e=qi(this.disImgConfig,this.$app);e&&(this.icon.style.backgroundImage=e),this.disImgConfig.text&&this.icon.setAttribute("aria-label",this.disImgConfig.text),e&&this.disImgConfig.text&&this.icon.setAttribute("role","img")}},onItemClick:function(e){"a"===e.target.tagName.toLowerCase()&&(this.$app.bridge.pushToFrameSet(e.target.href,e.target.target),e.preventDefault())}},qc=function(e){$c.$app=e;var t,i={},n={},s=e.getUIConfig();if(s.transcriptConfig){var a=s.transcriptConfig;i.style=a.disclaimerFooterViewStyles,i.imgstyle=a.disclaimerFooterImageStyles,t=a.disclaimerFooterStyleProperties||{},i.disImgConfig=a.disclaimerFooterImageConfig}else t={};return n.marginLeft="".concat(t.disclaimerLeftMargin||40,"px"),n.marginBottom="".concat(t.disclaimerBottomMargin||3,"px"),n.marginRight="".concat(t.disclaimerRightMargin||40,"px"),n.marginTop="".concat(t.disclaimerTopMargin||10,"px"),i.disclaimerStyleProps=n,i.disclaimerText=s.appStringProps.disclaimerFooterText,$c.constants=i,$c},Uc=i(40),Wc={tagName:"input-item",template:i.n(Uc).a,created:function(){this.input=this.el.firstElementChild,this.isTyping=!1,this.ciapi=this.$app.getCIAPIInstance(),this.footerArea=document.querySelector("footer-area"),this.cont=this.footerArea.firstElementChild,this.extendedFooter=this.cont.querySelector(".messaging-footer-extended"),Ri()&&this.input.classList.add("ios"),!this.config.autoGrow&&this.config.multiline||this.input.setAttribute("rows","1")},sendCustomerMessage:function(e){var t=this.input.value.trim();if(""!==t)if("/chatinfo"==t.toLowerCase()){this.resetTyping();var i=this.$app.CIAPIInstance.getChatParams(),n={EngagementID:i.chatID,BusinessUnit:i.businessUnitID,"Agent ID":i.agentID,"Business Rule":i.chatTitle,"Agent Group ID":i.agId,"Agent Group":i.agentGroupName,"Page Marker":i.launchPageMarker},s="<b>Chat Info</b> <br>";for(var a in n)s+="".concat(a,": ").concat(n[a]," <br>");var o=new Li({bubbleType:Mi.SYSTEM_MESSAGE,messageText:s,isAuto:!1,timestamp:Date.now()});this.$app.addToUI(o)}else this.resetTyping(),this.$app.onNewCustomerBubble(t);if(this.saveHeight){this.cont.style.height="".concat(this.saveHeight,"px"),this.footerMain.style.height="".concat(this.saveHeight-this.fHeightOffset,"px"),this.$app.shoutui.adjustTranscriptBottom(this.saveHeight),this.saveHeight=void 0,this.input.style.height="5px";var r=this.input.scrollHeight;this.input.style.height="".concat(r,"px")}this.hasFocus()||this.input.focus(),e&&e.preventDefault()},onInputFocus:function(e){document.querySelector("messaging-top-bar").hideMaterial(),document.querySelector("transcript-area").expandArea(),Ri()&&this.$app.getBridge().onVirtualKeyboardOpen(),e.target.value===e.target.getAttribute("placeholder")&&(e.target.value="")},onInputBlurred:function(){Ri()&&this.$app.getBridge().onVirtualKeyboardHidden()},onInput:function(e){return this.config.multiline&&this.config.autoGrow&&this.addDynamic(e),this.watchCustomerTyping(e)},onKeyPress:function(e){return this.watchCustomerTyping(e)},onKeyUp:function(e){return this.watchCustomerTyping(e)},onPaste:function(e){return this.watchCustomerTyping(e)},watchCustomerTyping:function(e){var t=this;return(e.charCode?e.charCode:e.keyCode)!==g||e.altKey||e.ctrlKey||e.shiftKey?(this.isTyping||(this.isTyping=!0,this.ciapi.sendActivityMessage(this.ciapi.ACTIVITY_STATE.START_TYPING),this.footerArea.toggleSendButtonState(!0)),""===this.input.value&&(this.isTyping=!1,this.footerArea.toggleSendButtonState(!1)),!this.typingTimeout||this.typingTimeout.executed()?this.typingTimeout=bn.instantiate((function(){t.ciapi.sendActivityMessage(t.ciapi.ACTIVITY_STATE.STOP_TYPING),t.isTyping=!1}),this.config.typingTimeout||4e3):this.typingTimeout.restart(),!0):(e.preventDefault(),this.sendCustomerMessage(),!1)},resetTyping:function(){this.typingTimeout&&this.typingTimeout.clear(!1),this.isTyping=!1,this.input.value="",this.footerArea.toggleSendButtonState(!1)},disable:function(){this.input.setAttribute("disabled",!0),this.resetTyping()},enable:function(){this.input.removeAttribute("disabled")},focus:function(){this.input.focus()},hasFocus:function(){return this.input===document.activeElement},removed:function(){this.typingTimeout&&this.typingTimeout.clear(!0)},clear:function(){this.input.oninput=null,this.input.onkeypress=null,this.input.onkeyup=null,this.input.onpaste=null},addDynamic:function(e){this.saveHeight||(this.saveHeight=this.cont.offsetHeight,this.footerMain=this.cont.firstElementChild,this.fHeightOffset=this.saveHeight-this.footerMain.offsetHeight,this.pHeight=parseInt(window.getComputedStyle(this.footerMain).paddingTop||0,10)+parseInt(window.getComputedStyle(this.footerMain).paddingBottom||0,10)+parseInt(window.getComputedStyle(this.footerMain).borderTopWidth||0,10)+parseInt(window.getComputedStyle(this.footerMain).borderBottomWidth||0,10),this.pHeight+=parseInt(window.getComputedStyle(e.target).marginTop||0,10)+parseInt(window.getComputedStyle(e.target).marginBottom||0,10)),e.target.style.height="5px";var t=e.target.scrollHeight;e.target.style.height="".concat(t,"px"),e.target.offsetHeight+this.pHeight>=this.saveHeight-this.fHeightOffset?(this.cont.style.height="".concat(e.target.offsetHeight+this.pHeight+this.fHeightOffset,"px"),this.footerMain.style.height=this.cont.offsetHeight-this.fHeightOffset,this.$app.shoutui.adjustTranscriptBottom(this.cont.offsetHeight)):(this.cont.style.height="".concat(this.saveHeight,"px"),this.footerMain.style.height="".concat(this.cont.offsetHeight-this.fHeightOffset,"px"),this.$app.shoutui.adjustTranscriptBottom(this.saveHeight))},insertEmoji:function(e){if(e=e||"",document.selection)document.selection.createRange().text=e;else if(this.input.selectionStart||0===this.input.selectionStart){var t=this.input.selectionStart,i=this.input.selectionEnd;this.input.value=this.input.value.substring(0,t)+e+this.input.value.substring(i,this.input.value.length),this.input.selectionStart=t+e.length,this.input.selectionEnd=t+e.length}else this.input.value+=e;var n=document.createEvent("HTMLEvents");n.initEvent("keypress",!1,!0),this.input.dispatchEvent(n),this.input.focus()}},Gc=function(e){Wc.$app=e;var t=e.getUIConfig().footerConfig||{};return t&&(Wc.constants={config:t.footerSettings||{},inputStyles:t.inputStyles}),Wc},zc=i(41),Yc={tagName:"footer-button",template:i.n(zc).a,created:function(){this.button=this.el.querySelector("input[type='submit']"),this.toggleSendButtonState(!1),this.footerArea=document.querySelector("footer-area"),this.udpateBackground(this.prop),"Emoji"==this.prop.type&&(this.eInsta=null)},disableButton:function(){this.prop.state&&-1!=this.prop.state.indexOf(Mt)&&this.toggleEnabledState(!1)},enableButton:function(){this.prop.state&&-1!=this.prop.state.indexOf(Mt)&&this.toggleEnabledState(!0)},onButtonClick:function(e){"Send"===this.prop.type&&this.footerArea.sendCustomerMessage(),"Emoji"===this.prop.type&&(this.eInsta||(this.eInsta=document.createElement("emoji-picker"),this.$app.shoutui.getLayoutEl().appendChild(this.eInsta),this.eInsta.setInputElement(this.footerArea.getInputElement())),this.eInsta.setVisible()),e&&e.preventDefault()},udpateBackground:function(e){this.defaultImgUrl=qi(e,this.$app),this.defaultImgUrl&&(this.button.style.backgroundImage=this.defaultImgUrl,this.disableImgUrl=qi({imgSrc:this.prop.dImgSrc,imgName:this.prop.dImgName},this.$app))},toggleSendButtonState:function(e){("undefined"==this.prop.state&&"Send"==this.prop.type||this.prop.state&&-1!=this.prop.state.indexOf(At))&&this.toggleEnabledState(e)},toggleEnabledState:function(e){var t=this;window.raf((function(){e&&t.defaultImgUrl&&t.disableImgUrl?(t.button.style.backgroundImage=t.defaultImgUrl,t.button.removeAttribute("disabled")):!e&&t.disableImgUrl?(t.button.style.backgroundImage=t.disableImgUrl,t.button.setAttribute("disabled",!0)):!e&&t.config.disableStateStyle?(Fi(t.config.disableStateStyle,t.button),t.button.setAttribute("disabled",!0)):t.config.enableStateStyle&&(Fi(t.config.enableStateStyle,t.button),t.button.removeAttribute("disabled"))}))}},Xc=function(e){Yc.$app=e;var t=e.getCIAPIInstance().getDeviceType(),i=e.getUIConfig().footerConfig||{};return i&&(Yc.constants={sendButtonStyles:i.sendButtonStyles,footerButtonStyles:i.sendButtonStyles,config:i.footerSettings||{},isMobile:"Phone"==t||"Tablet"==t},Yc.data={text:function(e){return"undefined"!==e.prop.text?e.prop.text:""}},Yc.constants.config.disableStateStyle=i.disableStateStyle,Yc.constants.config.enableStateStyle=i.enableStateStyle),Yc},Kc=i(42),Jc={tagName:"emoji-picker",template:i.n(Kc).a,created:function(){this.emoji=this.el.firstElementChild},setVisible:function(e){this.emoji.classList.toggle("active")},search:function(e){var t=e.target.value;""!=t?document.querySelectorAll(".emoji-picker-emoji:not([title*='".concat(t,"'])")).forEach((function(e){e.style.display="none"})):document.querySelectorAll(".emoji-picker-emoji").forEach((function(e){e.style.display=""}))},onSelected:function(e){e.target.classList.contains("emoji-picker-emoji")&&(this.inputEl.insertEmoji(e.target.innerHTML),this.setVisible(!1))},setInputElement:function(e){this.inputEl=e}},Qc=function(e){Jc.$app=e;var t=e.getUIConfig().footerConfig||{};return t&&(Jc.constants={popoverStyles:t.emojiPickerPopoverStyles,pickerStyles:t.emojiPickerContainerStyles,caretStyles:t.emojiPickerCaretStyles}),Jc},Zc=i(43),eu=i.n(Zc),tu=function(){function e(){a()(this,e)}return r()(e,[{key:"removeGivenTag",value:function(e,t,i){var n=new RegExp("</".concat(t,">"),"g");n.test(e)&&(e=s(e,n,i?" ".concat(i):""),e=s(e,new RegExp("<".concat(t,"[^>]*>"),"g"),""));return e;function s(e,t,i){return e.split(t).join(i)}}},{key:"removeIdAttributes",value:function(e){return e.replace(/id=("|').+?("|')/gi,"")}},{key:"removeHTMLMarkup",value:function(e){return e.replace(/(?: )?<.*?>(?: )?/gi," ").trim()}},{key:"isEmptyString",value:function(e){return"string"!=typeof e||0===e.trim().length}},{key:"generateRandomString",value:function(e,t){t=t||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var i="",n=0;n<e;n++){var s=Math.floor(Math.random()*t.length);i+=t.substring(s,s+1)}return i}}]),e}(),iu={tagName:"aria-reader-view",template:eu.a,created:function(){this.htmlString=new tu,this.isPaused=!1,this.readerEl=this.el.querySelector(".aria-reader"),this.messageQueue=[],this.messageQueueTimer=void 0,this.stateSubscribeIds=[],this.subscribeToStateChanges(),this.lastMsgAppended=""},removed:function(){this.stopReading(),this.unsubscribeFromStateChanges()},addMessage:function(e){if("string"==typeof e){if(this.messageQueue.push(e),this.isPaused)return;1===this.messageQueue.length&&(this.startReading(this.firstInitMsgDelay),this.firstInitMsgDelay=0)}else log("Invalid aria reader text and its type is ".concat(bi()(e)))},appendAriaMsgToReader:function(e){this.lastMsgAppended=e;var t=document.createElement("div");t.setAttribute("aria-live","polite"),this.readerEl.appendChild(t),this.readerEl.childElementCount>this.maxQueueMsgsOnScreen&&this.readerEl.removeChild(this.readerEl.firstChild),setTimeout((function(){var i=document.createElement("span");i.innerHTML=e,t.appendChild(i),setTimeout((function(){t.style.display="none"}),1e3)}),250)},formatMsg:function(e){if(this.htmlString.isEmptyString(e))return e;var t=this.htmlString.removeGivenTag(Gi(e),"a","link");return t=this.htmlString.removeHTMLMarkup(t),t=this.htmlString.removeIdAttributes(t)},addAriaMsgFromQueue:function(){if(this.messageQueue.length>0){var e=this.formatMsg(this.messageQueue.shift());this.appendAriaMsgToReader(e),this.startReading(this.getWordsPerMinuteDelay(e,this.wordsPerMinute))}else this.stopReading()},startReading:function(e){var t=this;this.messageQueueTimer||(this.messageQueueTimer=setTimeout((function(){t.stopReading(),t.addAriaMsgFromQueue()}),e>0?e+250:e))},stopReading:function(){this.messageQueueTimer&&(clearTimeout(this.messageQueueTimer),this.messageQueueTimer=void 0)},pauseReader:function(e){this.isPaused=e,this.isPaused?this.stopReading():this.startReading(this.firstInitMsgDelay)},getWordsPerMinuteDelay:function(e,t){var i=e.split(/\s/g).length,n=e.split(/\.(?!\s)/g);return n.length>1&&(i+=n.length-1),Math.ceil(i/t*60*1e3)},subscribeToStateChanges:function(){var e=this;this.stateSubscribeIds.push(this.$app.getStateMgr().subscribe((function(t){t?e.pauseReader(!0):e.pauseReader(!1)}),"isMinimized")),this.stateSubscribeIds.push(this.$app.getStateMgr().subscribe((function(t){e.addMessage(t)}),"ariaReaderSay"))},unsubscribeFromStateChanges:function(){var e=this;this.stateSubscribeIds.forEach((function(t){e.$app.getStateMgr().unsubscribe(t)})),this.stateSubscribeIds.length=0}},nu=function(e){iu.$app=e,iu.constants={firstInitMsgDelay:3e3,maxQueueMsgsOnScreen:30,wordsPerMinute:120};var t=e.getUIConfig().appConfigProps||{};return t.ariaReader&&Object.keys(iu.constants).forEach((function(e){t.ariaReader[e]&&(iu.constants[e]=t.ariaReader[e])})),iu},su=i(44),au={tagName:"file-upload-modal-view",template:i.n(su).a,initialize:function(e){var t=e.$app,i=e.constants,n=t.getUIConfig().appStringProps;i.uploadBtnText=n.uploadModalOkButtonText||M,i.cancelBtnText=n.uploadModalCancelButtonText||L,i.disclaimerText=n.uploadModalDisclaimerText||""},created:function(){this.mouseTrap=new xn.a(this.el),this.ciapi=this.$app.getCIAPIInstance(),this.displayRichFileUpload(),this.bindKeyboardShortcuts()},bindKeyboardShortcuts:function(){var e=this;this.mouseTrap.bind("escape",(function(){return e.onCancelClick()})),this.mouseTrap.bind("enter",(function(){return e.onSendClick()}))},displayRichFileUpload:function(){var e=this.getFileUploadJSON();if(e){this.richInstance=window.RichMain.instance,e.lockView=!1;var t=this.el.querySelector("#file-upload-container");xl(this.richInstance,this.$app,e,t),this.richInstance.registerCBListener(this.onFileUpload.bind(this))}else this.onCancelClick()},onFileUpload:function(e){this.resetError(),e.upload&&(this.files=e.upload.files)},getFileUploadJSON:function(){return this.$app.getUIConfig().fileUploadJSON},onCancelClick:function(){this.el.parentElement.removeChild(this.el),En.removeNegativeTabIndexOnClosingModal()},onOkClick:function(){var e=this.$app.getUIConfig().appStringProps;if(this.files&&this.files.length>0)this.ciapi.uploadFile(this.files[0],this.uploadHandlerCallback.bind(this));else{var t=e.emptyFileError||"Please select a file";this.setError(t)}},uploadHandlerCallback:function(e){var t=e.status,i=e.type,n=this.$app.getUIConfig().appStringProps,s=n[i]||"File Upload Failed";"error"===t?(this.setError(s),this.ciapi.sendSystemMessage(s)):"success"===t&&(kn(this.$app,n.uploadSuccessText,rt),this.onCancelClick())},removed:function(){this.unBindKeyboardShortcuts(),this.$app.getStateMgr().setState({isModalVisible:!1}),this.richInstance&&this.richInstance.clearAll()},resetError:function(){var e=this.el.querySelector(".error-msg");e&&(e.innerHTML="")},setError:function(e){var t=this.el.querySelector(".error-msg");t&&(t.innerHTML=e,this.$app.getStateMgr().setState({ariaReaderSay:e}))},unBindKeyboardShortcuts:function(){this.mouseTrap.unbind("escape"),this.mouseTrap.unbind("enter")}},ou=function(e){au.$app=e;var t={},i=e.getUIConfig();return t.btnStyles=i.modalButtonStyles,au.constants=t,au},ru=i(45),lu={tagName:"video-container-view",template:i.n(ru).a,created:function(){this.container=this.el.firstElementChild},isCustomerCameraEnabled:function(){return"true"===this.prop[Kn.ENABLED_CUSTOMER_CAMERA.toLowerCase()]},isVideoEnabled:function(){return"true"===this.prop.videoenabled},isVoiceOnlyCall:function(){return"true"===this.prop[Kn.ENABLED_VOICE_ONLY_CALL.toLowerCase()]},isReconnecting:function(){return"true"===this.prop.reconnect},showPreCallView:function(){var e=document.createElement("pre-call-instructions-view");e.setAttribute(Kn.ENABLED_CUSTOMER_CAMERA,this.isCustomerCameraEnabled()),e.setAttribute(Kn.ENABLED_VOICE_ONLY_CALL,this.isVoiceOnlyCall()),this.container.appendChild(e)},showVideoCallView:function(e,t,i,n){for(;this.container.firstChild;)this.container.removeChild(this.container.firstChild);this.videoCallView=document.createElement("video-stream-view"),this.videoCallView.setAttribute("videoenabled",this.isVideoEnabled()),this.videoCallView.setAttribute(Kn.ENABLED_CUSTOMER_CAMERA,this.isCustomerCameraEnabled()),this.videoCallView.setAttribute(Kn.ENABLED_VOICE_ONLY_CALL,this.isVoiceOnlyCall()),this.videoCallView.setAttribute("reconnect",this.isReconnecting()),e&&this.videoCallView.setAttribute("volLevel",e),t&&this.videoCallView.setAttribute("sinkId",t),i&&"default"!==i&&this.videoCallView.setAttribute("audioSrc",i),n&&"default"!==n&&this.videoCallView.setAttribute("videoSrc",n),this.container.appendChild(this.videoCallView)},endCall:function(){this.videoCallView.endCall()},getVideoCallView:function(){return this.videoCallView}},cu=function(e){lu.$app=e;return lu.constants={},lu},uu=i(12),hu=i.n(uu),du=i(14),pu=i.n(du),mu=function(){function e(t){a()(this,e),this.callMgr=t,this.feeds=[],this.myid=null}return r()(e,[{key:"handleServerMessage",value:function(e,t,i){e&&(e===R?this.whenRoomJoined(t,e,i):"destroyed"===e||"event"===e&&(t.publishers?this.whenPublisherJoined(t,i):t.leaving?this.whenPublisherLeaving(t,i):t.unpublished?this.whenSomeOneUnpublished(t,i):t[B]&&i(B)))}},{key:"whenRoomJoined",value:function(e,t,i){this.myid=e.id,this.callMgr.mypvtid=e.private_id,this.callMgr.publishOwnFeed(!0,i),e.publishers&&this.whenPublisherJoined(e,i),i(t)}},{key:"whenPublisherJoined",value:function(e,t){var i=e.publishers;for(var n in Janus.debug("Got a list of available publishers/feeds:",i),i){var s=i[n].id,a=i[n].display,o=i[n].audio_codec,r=i[n].video_codec;Janus.debug("  >> [".concat(s,"] ").concat(a," (audio: ").concat(o,", video: ").concat(r,")")),this.callMgr.newRemoteFeed(s,a,o,r,t)}}},{key:"whenPublisherLeaving",value:function(e,t){var i=e.leaving;Janus.log("Publisher left: ".concat(i));for(var n=null,s=0;s<this.feeds.length;s++)if(this.feeds[s]&&this.feeds[s].rfid===i){n=this.feeds[s];break}null!==n&&(Janus.debug("Feed ".concat(n.rfid," \n            (").concat(n.rfdisplay,") has left the room, detaching")),ai("Feed leaving: ".concat(n.rfid)),this.feeds[n.rfindex-1]=null,n.detach(),this.isAllAgentsLeft()&&t(B))}},{key:"whenSomeOneUnpublished",value:function(e,t){var i=e.unpublished;if(Janus.log("Publisher left: ".concat(i)),"ok"!==i){for(var n=null,s=0;s<this.feeds.length;s++)if(this.feeds[s]&&this.feeds[s].rfid==i){n=this.feeds[s];break}null!=n&&(Janus.debug("Feed ".concat(n.rfid," \n            (").concat(n.rfdisplay,") has left the room, detaching")),ai("Feed leaving: ".concat(n.rfid)),this.feeds[n.rfindex-1]=null,n.detach(),this.isAllAgentsLeft()&&t(V))}else this.callMgr.sfutest.hangup()}},{key:"handleServerMessageForRemoteFeed",value:function(e,t,i){e[B]?statusCb(B):t&&"attached"===t&&(this.feeds.push(i),i.rfindex=this.feeds.length,i.rfid=e.id,i.rfdisplay=e.display,Janus.log("Successfully attached to feed ".concat(i.rfid," \n                        (").concat(i.rfdisplay,") in room ").concat(e.room)))}},{key:"isAllAgentsLeft",value:function(){var e=0;if(this.feeds.forEach((function(t){t&&t.rfindex&&(e+=1)})),0===e)return!0}}]),e}();function fu(){return(fu=pu()(hu.a.mark((function e(){var t;return hu.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.e(0).then(i.bind(null,63)),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gu(){return(gu=pu()(hu.a.mark((function e(){var t;return hu.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.e(1).then(i.bind(null,64)),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var vu=function(){function e(t,i,n,s,o){a()(this,e),this.$app=t,this.doSimulcast=i,this.doSimulcast2=n,this.devices=s,this.showCustomerCamera=o}return r()(e,[{key:"closeAllMediaDevices",value:function(e){this.sfutest&&(this.sfutest.send({message:{request:"leave"}}),this.sfutest.hangup(!0),this.sfutest.detach());e&&(e?e.getTracks():[]).forEach((function(e){return e.stop()}))}},{key:"startVideoCallEngagement",value:function(e,t){var i=this;try{this.mystream=null,this.mypvtid=null,this.server=e.endpointUrl,this.roomName=e.roomName,this.customerName=e.customerName;var n=this.$app.getCIAPIInstance().getChatParams();this.opaqueId=JSON.stringify({roomName:e.roomName,agentID:n.agentID,chatID:n.chatID,customerID:n.getCustomerID(),siteID:n.siteID}),this.token=e.customerToken,this.pin=e.roomPin,this.janusMsgHandler=new mu(this),function(){return fu.apply(this,arguments)}().then((function(e){return window.Janus=e.default,function(){return gu.apply(this,arguments)}()})).then((function(e){window.adapter=e.default,i.joinCall(t)}))}catch(e){ai("Error: ".concat(e))}}},{key:"joinCall",value:function(e){var t=this;Janus.init({debug:"all",dependencies:Janus.useDefaultDependencies({adapter:adapter}),callback:function(){Janus.isWebrtcSupported()?t.janus=new Janus({server:t.server,token:t.token,success:function(){t.attachToRoom(e)},error:function(t){Janus.error(t),e(B)},destroyed:function(){}}):e("noSupport")}})}},{key:"attachToRoom",value:function(e){var t=this;this.janus.attach({plugin:"janus.plugin.videoroom",opaqueId:this.opaqueId,success:function(e){t.sfutest=e,Janus.log("Plugin attached! (".concat(t.sfutest.getPlugin(),",\n                                     id=").concat(t.sfutest.getId(),")")),Janus.log("  -- This is a publisher/manager");var i={request:"join",room:t.roomName,ptype:"publisher",display:t.customerName,pin:t.pin||"",id:t.customerName};t.sfutest.send({message:i})},error:function(t){Janus.error("  -- Error attaching plugin...",t),e(B)},iceState:function(e){Janus.log("ICE state changed to ".concat(e))},mediaState:function(e,t){Janus.log("Janus ".concat(t?"started":"stopped"," \n                                receiving our ").concat(e))},webrtcState:function(e){Janus.log("Janus says our WebRTC PeerConnection \n                                is ".concat(e?"up":"down"," now"))},onlocalstream:function(t){Janus.debug(" ::: Got a local stream :::",t),e($,t)},onmessage:function(i,n){Janus.debug(" ::: Got a message (publisher) :::",i);var s=i.videoroom;if(Janus.debug("Event: ".concat(s)),t.janusMsgHandler.handleServerMessage(s,i,e),n){Janus.debug("Handling SDP as well...",n),t.sfutest.handleRemoteJsep({jsep:n});var a=i.audio_codec;t.mystream&&t.mystream.getAudioTracks()&&mystream.getAudioTracks().length>0&&!a&&(Janus.log("Our audio stream has been rejected, viewers won't hear us"),e(H));var o=i.video_codec;t.mystream&&t.mystream.getVideoTracks()&&mystream.getVideoTracks().length>0&&!o&&e(F)}},onremotestream:function(e){ai("stream : ".concat(e))},oncleanup:function(){Janus.log(" ::: Got a cleanup notification: \n                            we are unpublished now :::"),t.mystream=null}})}},{key:"publishOwnFeed",value:function(e,t){this.createLocalOffer(this.getMedia(e,this.devices,this.showCustomerCamera),t)}},{key:"replaceOwnFeed",value:function(e,t,i){var n=this.getMedia(t,e,this.showCustomerCamera);e.audio&&(n.replaceAudio=!0),e.video&&(n.replaceVideo=!0),this.createLocalOffer(n,t,i)}},{key:"getMedia",value:function(e,t,i){var n={audioRecv:!1,videoRecv:!1,audioSend:e,videoSend:!0};return t.audio&&(n.audio=t.audio),t.video&&(n.video=t.video),i||(n.videoSend=!1),n}},{key:"createLocalOffer",value:function(e,t,i){var n=this;this.sfutest.createOffer({media:e,simulcast:this.doSimulcast,simulcast2:this.doSimulcast2,success:function(i){Janus.debug("Got publisher SDP!",i);var s={request:"configure",audio:t,video:e.videoSend};n.sfutest.send({message:s,jsep:i})},error:function(e){Janus.error("WebRTC error:",e),i(H)}})}},{key:"newRemoteFeed",value:function(e,t,i,n,s){var a=this;ai("Someone has joined! Now its time to change styles");var o=null;this.janus.attach({plugin:"janus.plugin.videoroom",opaqueId:this.opaqueId,success:function(t){(o=t).simulcastStarted=!1,Janus.log("Plugin attached! (".concat(o.getPlugin(),", id=").concat(o.getId(),")")),Janus.log("  -- This is a subscriber");var i={request:"join",room:a.roomName,ptype:"subscriber",feed:e,pin:a.pin||"",private_id:a.mypvtid};o.videoCodec=n,o.send({message:i})},error:function(e){Janus.error("  -- Error attaching plugin...",e),s(B)},onmessage:function(e,t){Janus.debug(" ::: Got a message (subscriber) :::",e);var i=e.videoroom;Janus.debug("Event: ".concat(i)),a.janusMsgHandler.handleServerMessageForRemoteFeed(e,i,o),t&&(Janus.debug("Handling SDP as well...",t),o.createAnswer({jsep:t,media:{audioSend:!1,videoSend:!1},success:function(e){Janus.debug("Got SDP!",e);var t={request:"start",room:a.roomName};o.send({message:t,jsep:e})},error:function(e){Janus.error("WebRTC error:",e),s(B)}}))},iceState:function(e){Janus.log("ICE state of this WebRTC PeerConnection (feed #".concat(o.rfindex,")\n                 changed to ").concat(e))},webrtcState:function(e){Janus.log("Janus says this WebRTC PeerConnection (feed #".concat(o.rfindex,")\n                 is ").concat(e?"up":"down"," now"))},onlocalstream:function(e){},onremotestream:function(e){Janus.debug("Remote feed #".concat(o.rfindex,", stream:"),e),s(N,e)},oncleanup:function(){Janus.log(" ::: Got a cleanup notification (remote feed ".concat(e,") :::"))}})}},{key:"attachStream",value:function(e,t){Janus.attachMediaStream(e,t)}}]),e}(),yu=i(46),bu=i.n(yu),Su=function(){function e(t){a()(this,e),this.settingsView=t,this.videoElement=null,this.audioInputSelect=null,this.audioOutputSelect=null,this.videoSelect=null,this.selectors=[]}return r()(e,[{key:"showMediaDeviceSettings",value:function(e,t,i,n,s){this.videoElement=e,this.audioInputSelect=t,this.audioOutputSelect=i,this.videoSelect=n,this.volumeContainer=s,this.selectors=[this.audioInputSelect,this.audioOutputSelect],"sinkId"in HTMLMediaElement.prototype||(this.audioOutputSelect.style.display="none",this.audioOutputSelect.parentElement.firstElementChild.style.display="none"),this.audioInputSelect.onchange=this.start.bind(this),this.audioOutputSelect.onchange=this.changeAudioDestination.bind(this),this.videoSelect?(this.selectors.push(this.videoSelect),this.videoSelect.onchange=this.start.bind(this),this.useVideo=!0):this.useVideo=!1,this.start()}},{key:"start",value:function(){var e=this.audioInputSelect.value,t=this.useVideo?this.videoSelect.value:"",i={audio:!e||{deviceId:{exact:e}},video:t?{deviceId:{exact:t}}:this.useVideo};null!=this.volumeContainer?navigator.mediaDevices.getUserMedia(i).then(this.gotStream.bind(this)).then(this.gotDevices.bind(this)).catch(this.handleError.bind(this)):navigator.mediaDevices.enumerateDevices().then(this.gotDevices.bind(this)).catch(this.handleError.bind(this))}},{key:"gotDevices",value:function(e){var t=this.selectors.map((function(e){return e.value}));this.removeMediaSelectorOldOptions(),this.displayingAvailableMediaDevicesOptions(e),this.updateMediaSelectorWithAvailableOptions(t),this.settingsView.setAudioVideoSource(this.audioInputSelect.value,this.useVideo?this.videoSelect.value:null)}},{key:"removeMediaSelectorOldOptions",value:function(){this.selectors.forEach((function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}))}},{key:"updateMediaSelectorWithAvailableOptions",value:function(e){this.selectors.forEach((function(t,i){Array.prototype.slice.call(t.childNodes).some((function(t){return t.value===e[i]}))&&(t.value=e[i])}))}},{key:"displayingAvailableMediaDevicesOptions",value:function(e){for(var t=0;t<e.length;++t){var i=e[t],n=document.createElement("option");n.value=i.deviceId,"default"==i.deviceId&&(n.selected=!0),"audioinput"===i.kind?(n.text=i.label||"microphone ".concat(this.audioInputSelect.length+1),this.audioInputSelect.appendChild(n)):"audiooutput"===i.kind?(n.text=i.label||"speaker ".concat(this.audioOutputSelect.length+1),this.audioOutputSelect.appendChild(n)):"videoinput"===i.kind&&this.videoSelect?(n.text=i.label||"camera ".concat(this.videoSelect.length+1),this.videoSelect.appendChild(n)):ai("Some other kind of source/device: ".concat(i))}}},{key:"attachSinkId",value:function(e,t){var i=this;void 0!==e.sinkId?e.setSinkId(t).then((function(){ai("Success, audio output device attached: ".concat(t))})).catch((function(e){var t=e;"SecurityError"===e.name&&(t="You need to use HTTPS for selecting \n                        audio output device: ".concat(e)),console.error(t),i.audioOutputSelect.selectedIndex=0})):console.warn("Browser does not support output device selection.")}},{key:"changeAudioDestination",value:function(){var e=this.audioOutputSelect.value;this.settingsView.setSinkID(e)}},{key:"gotStream",value:function(e){return this.videoElement&&(this.videoElement.srcObject=e),this.createAudioAnalyserForAvailableStream(e),navigator.mediaDevices.enumerateDevices()}},{key:"createAudioAnalyserForAvailableStream",value:function(e){if(this.volumeContainer)if("undefined"!=typeof AudioContext){var t=new AudioContext,i=t.createAnalyser(),n=t.createMediaStreamSource(e),s=t.createScriptProcessor(2048,1,1);i.smoothingTimeConstant=.8,i.fftSize=1024,n.connect(i),i.connect(s),s.connect(t.destination),s.onaudioprocess=function(){var e=new Uint8Array(i.frequencyBinCount);i.getByteFrequencyData(e);for(var t=0,n=e.length,s=0;s<n;s++)t+=e[s];var a=t/n;this.displayInputDeviceVolumeLevel(a)}.bind(this)}else this.volumeContainer.style.display="none"}},{key:"displayInputDeviceVolumeLevel",value:function(e){var t=this.volumeContainer.getElementsByClassName("microphone-volume-level");if(t){for(var i=Math.round(e/10),n=0;n<t.length;n++)t[n].style.backgroundColor="#007bff3b";for(var s=0;s<i;s++)t[s]&&(t[s].style.backgroundColor="#007bff")}}},{key:"handleError",value:function(e){ai("navigator.MediaDevices.getUserMedia error: ".concat(e.message,", ").concat(e.name))}},{key:"removeStream",value:function(){this.videoElement&&this.videoElement.srcObject&&(this.videoElement.srcObject.getTracks().forEach((function(e){e.stop()})),this.videoElement.srcObject=null)}},{key:"clear",value:function(){this.audioInputSelect&&(this.audioInputSelect.onchange=null,this.audioOutputSelect.onchange=null,this.videoSelect&&(this.videoSelect.onchange=null)),this.removeStream()}}]),e}(),wu={tagName:"video-stream-view",template:bu.a,created:function(){this.videoContainer=document.querySelector(".video-container"),this.settingsEl=this.el.querySelector(".media-settings-container"),this.mediaDeviceManager=new Su(this),this.callState=$t,this.agentMsg=this.$app.getPersistedValue(Kn.UNREAD_COUNT,0),this.muteVideo=!1,this.muteAudio=!1,this.videoOnBtn=this.el.querySelector(".video-on-icon"),this.expandVideoBtn=this.el.querySelector(".video-expand-icon"),this.videoOffBtn=this.el.querySelector(".video-off-icon"),this.micOnBtn=this.el.querySelector(".mic-on-icon"),this.micOffBtn=this.el.querySelector(".mic-off-icon"),this.counterEl=this.el.querySelector(".chat-notification-count"),this.videoCallView=this.el.querySelector(".video-call"),this.errorView=this.el.querySelector(".call-error"),this.unsupportedDeviceErrorView=this.el.querySelector(".unsupported-device-error"),this.connectingView=this.el.querySelector(".call-connecting"),this.chatNotificationContainer=this.el.querySelector(".chat-notification-block"),this.videoChatControls=this.el.querySelector(".video-chat-controls"),this.videoExpandContainer=this.el.querySelector(".video-expand-icon-block"),this.agentAliasOuterDiv=this.el.querySelector(".agent-alias-outer-div"),this.agentAliasTextEl=this.el.querySelector(".agent-alias-text"),this.callTransferTextEl=this.el.querySelector(".call-transfer-text"),this.noCustomerVideoEl=this.el.querySelector(".video-no-customer-video");var e=document.querySelector(".agent_Agent span");this.data.agentAliasText=e&&e.innerText?e.innerText:Kn.AGENT_ALIAS_TEXT,this.showVideoConnectingView()},toggleMicrophoneOnOff:function(){this.localStream.getAudioTracks()[0].enabled=this.muteAudio,this.muteAudio=!this.muteAudio,this.micOnBtn.classList.toggle("hide"),this.micOffBtn.classList.toggle("hide")},toggleVideoOnOff:function(){this.localStream.getVideoTracks()[0].enabled=this.muteVideo,this.muteVideo=!this.muteVideo,this.localVideoEl.classList.toggle("hide"),this.videoOnBtn.classList.toggle("hide"),this.videoOffBtn.classList.toggle("hide")},endCall:function(){this.clear(),this.$app.shoutui.getLayoutEl().removeVideoCallContainer(),this.$app.sendWebRTCInvitationState(Bt),this.setCallState(Ht),this.$app.removePersistedValueByKey(Kn.UNREAD_COUNT),this.$app.removePersistedValueByKey(Kn.CALL_STATE)},switchToCallView:function(){this.videoCallView.classList.add("show"),this.connectingView.classList.add("hide"),this.unsupportedDeviceErrorView.classList.remove("show"),this.chatNotificationContainer.classList.remove("hide")},startCall:function(e){var t=this;this.devices={},this.prop.audiosrc&&(this.devices.audio={deviceId:{exact:this.prop.audiosrc}}),this.prop.videosrc&&(this.devices.video={deviceId:{exact:this.prop.videosrc}}),this.callMgr=new vu(this.$app,this.simulcast,this.simulcast2,this.devices,this.data.showCustomerCamera),this.callMgr.startVideoCallEngagement(e,(function(e,i){t.handleRoomStatus(e,i)})),this.onNewAgentMsgSubscriptionId=Ti.subscribe((function(){t.agentMsg=parseInt(t.agentMsg,10)+1,t.updateCounter(),t.$app.persistValue(Kn.UNREAD_COUNT,t.agentMsg)}),"new.agentMsg")},setCallState:function(e){this.callState=e,this.$app.persistValue(Kn.CALL_STATE,e)},showVideoConnectingView:function(){if(this.data.showCustomerCamera){var e=hc("connecting-video-screen",!0);this.connectingView.appendChild(e);var t={audio:!1,video:!this.prop.videosrc||{deviceId:{exact:this.prop.videosrc}}};navigator.mediaDevices.getUserMedia(t).then((function(t){e&&(e.srcObject=t)})).catch((function(e){console.log("Error in video connection screen",e)}))}},removeLocalMediaStram:function(e){var t=document.querySelector(e);t&&(t.srcObject.getTracks().forEach((function(e){e.stop()})),t.srcObject=null,t.remove())},handleRoomStatus:function(e,t){var i=Jn;switch(this.data.showCustomerCamera?i=Qn:this.data.voiceOnlyCall&&(i=Zn),e){case Kn.ROOM_JOINED:this.setCallState(qt);break;case Kn.RTC_ERROR:this.callState=Gt,this.videoCallView.classList.remove("show"),this.chatNotificationContainer.classList.add("hide"),this.errorView.classList.add("show"),this.connectingView.classList.add("hide"),this.$app.logWebRTCEvents(is,i);break;case Kn.LOCAL_AUDIO_ERROR:this.callState=Gt,this.videoCallView.classList.remove("show"),this.chatNotificationContainer.classList.add("hide"),this.unsupportedDeviceErrorView.classList.add("show"),this.connectingView.classList.add("hide");break;case Kn.AGENT_VIDEO_ERROR:this.noRemoteVideoEl.classList.remove("hide"),this.remoteVideoEl.classList.add("hide");break;case Kn.AGENT_VIDEO_PUBISHED:this.callState=Wt,this.injectRemoteVideoElement(t),this.updateCounter(),this.videoCallView.classList.add("show"),this.connectingView.classList.add("hide"),this.chatNotificationContainer.classList.remove("hide"),this.data.voiceOnlyCall||this.noRemoteVideoEl.classList.add("hide"),this.setSinkID(this.prop.sinkid),this.data.showCustomerCamera&&this.removeLocalMediaStram(".connecting-video-screen");break;case Kn.LOCAL_VIDEO_ERROR:this.noLocalVideoEl.classList.remove("hide"),this.localVideoEl.classList.add("hide");break;case Kn.CUSTOMER_VIDEO_PUBISHED:this.callState=Ut,this.injectCustomerVideoElement(t)}},showCallTransferState:function(){this.data.voiceOnlyCall?(this.noRemoteVideoEl&&this.noRemoteVideoEl.classList.add("hide"),this.noCustomerVideoEl&&this.noCustomerVideoEl.classList.add("call-transfer-no-customer-video")):(this.remoteVideoEl&&this.remoteVideoEl.classList.add("hide"),this.localVideoEl&&(this.localVideoEl.classList.add("remote-video-preview"),this.localVideoEl.classList.remove("local-video-preview"))),this.callTransferTextEl&&(this.callTransferTextEl.classList.remove("hide"),this.callTransferTextEl.classList.add("show"))},hideCallTransferState:function(){this.data.voiceOnlyCall?(this.noRemoteVideoEl&&this.noRemoteVideoEl.classList.remove("hide"),this.noCustomerVideoEl&&this.noCustomerVideoEl.classList.remove("call-transfer-no-customer-video")):(this.remoteVideoEl&&this.remoteVideoEl.classList.remove("hide"),this.localVideoEl&&(this.localVideoEl.classList.remove("remote-video-preview"),this.localVideoEl.classList.add("local-video-preview"))),this.callTransferTextEl&&(this.callTransferTextEl.classList.add("hide"),this.callTransferTextEl.classList.remove("show"))},showDeviceSettings:function(){if(this.settingsEl.style.display="block",this.audioInputSelect=this.el.querySelector("#inputDevices"),this.audioOutputSelect=this.el.querySelector("#outputDevices"),this.videoSelect=this.el.querySelector("#videoDevices"),this.volControl=this.el.querySelector("#vol-control"),this.setVolumeHandler(),0==this.audioInputSelect.childNodes.length&&this.devices.audio){var e=this.devices.audio.deviceId.exact;this.audioInputSelect.add(uc(e,e))}if(this.videoSelect&&0==this.videoSelect.childNodes.length&&this.devices.video){var t=this.devices.video.deviceId.exact;this.videoSelect.add(uc(t,t))}0==this.audioOutputSelect.childNodes.length&&this.prop.sinkid&&this.audioOutputSelect.add(uc(this.prop.sinkid,this.prop.sinkid)),this.volControl.value=100*parseFloat(this.prop.vollevel),this.mediaDeviceManager.showMediaDeviceSettings(null,this.audioInputSelect,this.audioOutputSelect,this.videoSelect)},unmuteVolume:function(){this.volControl.value=100,this.remoteVideoEl.volume=1},muteVolume:function(){this.volControl.value=0,this.remoteVideoEl.volume=0},setVolumeHandler:function(){var e=this;this.debouncedVolHandler=zi((function(t){if(e.remoteVideoEl){var i=parseFloat(t.target.value);e.remoteVideoEl.volume=i/100}}),100)},hideDeviceSettings:function(){this.settingsEl.style.display="none",this.mediaDeviceManager&&this.mediaDeviceManager.clear()},setSinkID:function(e){e&&this.mediaDeviceManager.attachSinkId(this.remoteVideoEl,e)},setAudioVideoSource:function(e,t){var i=this,n=!1;!e||"default"===e&&!this.devices.audio||this.devices.audio&&e===this.devices.audio.deviceId.exact||(this.devices.audio={deviceId:{exact:e}},n=!0),!t||"default"===t&&!this.devices.video||this.devices.video&&t===this.devices.video.deviceId.exact||(this.devices.video={deviceId:{exact:t}},n=!0),n&&this.callMgr.replaceOwnFeed(this.devices,!0,(function(e){i.handleRoomStatus(e)}))},setVolume:function(e){this.debouncedVolHandler(e)},clear:function(){this.callMgr&&(this.callMgr.closeAllMediaDevices(this.localStream),this.localStream=null),this.mediaDeviceManager&&this.mediaDeviceManager.clear(),this.data.showCustomerCamera&&this.removeLocalMediaStram(".connecting-video-screen"),Ti.unsubscribe(this.onNewAgentMsgSubscriptionId)},removed:function(){this.clear()},injectRemoteVideoElement:function(e){var t=this.el.querySelector(".remote-video-container");this.remoteVideoEl||(this.remoteVideoEl=hc("remote-video-preview",!1),t.appendChild(this.remoteVideoEl),this.setDefaultVolume(),this.noRemoteVideoEl=t.firstElementChild),this.remoteVideoEl.classList.remove("hide"),this.callMgr.attachStream(this.remoteVideoEl,e)},setDefaultVolume:function(){this.prop.vollevel&&(this.remoteVideoEl.volume=parseFloat(this.prop.vollevel))},injectCustomerVideoElement:function(e){if(this.data.showCustomerCamera){var t=this.el.querySelector(".local-video-container");this.localVideoEl||(this.localVideoEl=hc("local-video-preview",!0),t.appendChild(this.localVideoEl),this.noLocalVideoEl=t.firstElementChild),this.noLocalVideoEl.classList.add("hide"),this.localVideoEl.classList.remove("hide"),this.callMgr.attachStream(this.localVideoEl,e),this.muteVideo=!1,this.videoOnBtn.classList.remove("hide"),this.videoOffBtn.classList.add("hide")}this.localStream=e,this.localStream.getAudioTracks()[0].enabled=!this.muteAudio},updateCounter:function(){void 0===this.agentMsg&&(this.agentMsg=0),this.counterEl.innerText=this.agentMsg},showChatView:function(){this.chatNotificationContainer.classList.add("hide"),this.videoChatControls.classList.add("hide"),this.videoContainer.classList.add("shrink-video-container"),this.videoExpandContainer.classList.remove("hide"),this.agentMsg=0,this.updateCounter(),this.data.voiceOnlyCall&&(this.agentAliasOuterDiv.classList.add("agent-alias-outer-div-collapse"),this.agentAliasTextEl.classList.add("font-size-large"))},expandVideoContainer:function(){this.agentMsg=0,this.updateCounter(),this.chatNotificationContainer.classList.remove("hide"),this.videoChatControls.classList.remove("hide"),this.videoContainer.classList.remove("shrink-video-container"),this.videoExpandContainer.classList.add("hide"),this.data.voiceOnlyCall&&(this.agentAliasOuterDiv.classList.remove("agent-alias-outer-div-collapse"),this.agentAliasTextEl.classList.remove("font-size-large"))}},ku=function(e){var t=e.getUIConfig(),i=t.appStringProps,n=t.digitalVoiceAndVideoConfig,s=e.getImagePath();wu.$app=e;var a={};return n&&(n.images&&(a.noAgentVideoImg=s+n.images.noAgentVideo,a.noCustomerVideoImg=s+n.images.noCustomerVideo,a.callErrorImg=s+n.images.callError,a.speakerMuteImg=s+n.images.speakerMuteImg,a.speakerVolumeImg=s+n.images.speakerVolumeImg),a.simulcast=n.enableSimulcast,a.simulcast2=n.enableSimulcast2),a.endCallButtonText=i.endCallButtonText||Kn.END_CALL_BUTTON_TEXT,a.callErrorText=i.callErrorText||Kn.CALL_ERROR_TEXT,a.unsupportedDeviceErrorText=i.unsupportedDeviceErrorText||Kn.UNSUPPORTED_DEVICE_TEXT,wu.constants=a,wu.data={agentAliasText:Kn.AGENT_ALIAS_TEXT,isVoiceCall:function(e){return"true"!==e.prop.videoenabled},connectingText:function(e){return"true"==e.prop.reconnect?i.callReconnectingText:i.callConnectingText},showCustomerCamera:function(e){return"true"===e.prop[Kn.ENABLED_CUSTOMER_CAMERA.toLowerCase()]},voiceOnlyCall:function(e){return"true"===e.prop[Kn.ENABLED_VOICE_ONLY_CALL.toLowerCase()]},callTransferText:Kn.CALL_TRANSFER_TEXT},wu},Cu=i(47),Tu={tagName:"pre-call-instructions-view",template:i.n(Cu).a,created:function(){this.el.querySelector(".pre-call-instructions-footer button").focus()},onClickGetStarted:function(){var e=this.el.parentElement,t=document.createElement("device-settings-view");t.setAttribute(Kn.ENABLED_CUSTOMER_CAMERA,this.prop[Kn.ENABLED_CUSTOMER_CAMERA.toLowerCase()]),t.setAttribute(Kn.ENABLED_VOICE_ONLY_CALL,this.prop[Kn.ENABLED_VOICE_ONLY_CALL.toLowerCase()]),e.append(t),e.removeChild(this.el);var i=Jn;this.data.showCustomerCamera?i=Qn:this.data.voiceOnlyCall&&(i=Zn),this.$app.logWebRTCEvents(es,i)}},xu=function(e){var t=e.getUIConfig(),i=t.webRTCProps&&t.webRTCProps.preCallInstructionsProps,n=i&&i.videoCall,s=i&&i.voiceOnlyCall,a=Kn.ENABLED_CUSTOMER_CAMERA.toLowerCase(),o=Kn.ENABLED_VOICE_ONLY_CALL.toLowerCase();Tu.$app=e;var r={};return i&&(r.disclaimerText=i.disclaimerText||Kn.DISCLAIIMER_TEXT,r.browserSettingPopupText=i&&i.browserSettingPopupText?i.browserSettingPopupText:Kn.BROWSER_SETTINGS_POPUP_TEXT),Tu.data={primaryText:function(e){return"true"===e.prop[a]?n&&n.primaryInstructionText?n.primaryInstructionText:Kn.PRE_VIDEO_CALL_PRIMARY_TEXT:s&&s.primaryInstructionText?s.primaryInstructionText:Kn.PRE_VOICE_CALL_PRIMARY_TEXT},secondaryText:function(e){return"true"===e.prop[a]?n&&n.secondaryInstructionText?n.secondaryInstructionText:Kn.PRE_VIDEO_CALL_SECONDARY_TEXT:s&&s.secondaryInstructionText?s.secondaryInstructionText:Kn.PRE_VOICE_CALL_SECONDARY_TEXT},headingText:function(e){return"true"===e.prop[a]?n&&n.heading?n.heading:Kn.VIDEO_CALL_HEADING:s&&s.heading?s.heading:Kn.VOICE_ONLY_CALL_HEADING},startButtonText:function(e){return"true"===e.prop[a]?n&&n.startButtonText?n.startButtonText:Kn.VIDEO_CALL_CHECK_DEVICES_BUTTON_TEXT:s&&s.startButtonText?s.startButtonText:Kn.VOICE_ONLY_CALL_CHECK_DEVICES_TEXT},showCustomerCamera:function(e){return"true"===e.prop[a]},voiceOnlyCall:function(e){return"true"===e.prop[o]}},Tu.constants=r,Tu},Eu=i(48),Iu={tagName:"device-settings-view",template:i.n(Eu).a,created:function(){this.initializeDeviceSettings()},initializeDeviceSettings:function(){this.initializeMediaSrcElements(),this.mediaDeviceManager=new Su(this),this.showDevices(),this.setVolumeHandler()},initializeMediaSrcElements:function(){this.audioControl=this.el.querySelector("#vol-control"),this.audioInputSelect=this.el.querySelector("select#audioSource"),this.audioOutputSelect=this.el.querySelector("select#audioOutput"),this.videoSelect=this.el.querySelector("select#videoSource"),this.volumeContainer=this.el.querySelector(".microphone-volume-container"),this.deviceMediaContainer=this.el.querySelector(".device-media-container")},showDevices:function(){if(this.data.showCustomerCamera){this.videoElement=hc("device-settings-video",!0);var e=this.el.querySelector(".preview-container");e.insertBefore(this.videoElement,e.children[0])}this.mediaDeviceManager.showMediaDeviceSettings(this.videoElement,this.audioInputSelect,this.audioOutputSelect,this.videoSelect,this.volumeContainer)},setVolume:function(e){this.debouncedVolHandler(e)},unmuteVolume:function(){this.oldVolLevel&&(this.videoElement.volume=this.oldVolLevel/100,this.audioControl.value=this.oldVolLevel)},muteVolume:function(){this.oldVolLevel=this.audioControl.value,this.videoElement.volume=0,this.audioControl.value=0},getStartedAudioVideoCall:function(){this.data.voiceOnlyCall?this.$app.sendWebRTCInvitationState(Ot):this.$app.sendWebRTCInvitationState(Dt),document.querySelector("video-container-view").showVideoCallView(this.volume||.5,this.sinkID,this.audioSrc,this.videoSrc)},setSinkID:function(e){this.sinkID=e},setAudioVideoSource:function(e,t){this.audioSrc=e,this.videoSrc=t},removed:function(){this.mediaDeviceManager.clear()},setVolumeHandler:function(){var e=this;this.debouncedVolHandler=zi((function(t){var i=parseFloat(t.target.value);e.volume=i/100}),100)},onClickSaveAndContinueNext:function(){var e=this;this.data.saveAndContinueNext=!this.data.saveAndContinueNext,this.data.saveAndContinueNext?this.el.querySelector("#getStartedBtn").addEventListener("click",(function(t){e.getStartedAudioVideoCall()})):this.checkDeviceSettings()},checkDeviceSettings:function(){this.initializeMediaSrcElements(),this.devices={},this.audioSrc&&(this.devices.audio={deviceId:{exact:this.audioSrc}});var e=this.devices.audio.deviceId.exact;if(this.audioInputSelect.add(uc(e,e)),this.videoSrc&&this.data.showCustomerCamera){this.devices.video={deviceId:{exact:this.videoSrc}};var t=this.devices.video.deviceId.exact;this.videoSelect.add(uc(t,t))}this.audioOutputSelect.add(uc(this.sinkID,this.sinkID)),this.showDevices()}},ju=function(e){var t=e.getUIConfig(),i=t.webRTCProps&&t.webRTCProps.deviceSettingsProps,n=e.getImagePath();Iu.$app=e;var s=i&&i.videoCall,a=i&&i.voiceOnlyCall,o=Kn.ENABLED_CUSTOMER_CAMERA.toLowerCase(),r=Kn.ENABLED_VOICE_ONLY_CALL.toLowerCase(),l={};return i&&(l.speakerMuteImg=n+i.speakerMuteImg,l.speakerVolumeImg=n+i.speakerVolumeImg,l.microphoneVolumeImg=n+i.microphoneVolumeImg,l.disclaimerText=i.disclaimerText),Iu.data={saveAndContinueNext:!1,finalText:function(e){return"true"===e.prop[o]?s&&s.finalText?s.finalText:Kn.VIDEO_CALL_DEVICE_SETTINGS_FINAL_TEXT:a&&a.finalText?a.finalText:Kn.VOICE_ONLY_CALL_DEVICE_SETTINGS_FINAL_TEXT},headingText:function(e){return"true"===e.prop[o]?s&&s.heading?s.heading:Kn.VIDEO_CALL_HEADING:a&&a.heading?a.heading:Kn.VOICE_ONLY_CALL_HEADING},primaryText:function(e){return"true"===e.prop[o]?s&&s.primaryInstructionText?s.primaryInstructionText:Kn.VIDEO_CALL_DEVICE_SETTINGS_PRIMARY_TEXT:a&&a.primaryInstructionText?a.primaryInstructionText:Kn.VOICE_CALL_DEVICE_SETTINGS_PRIMARY_TEXT},checkDeviceSettingsBtnText:function(e){return"true"===e.prop[o]?s&&s.checkDeviceSettingsText?s.checkDeviceSettingsText:Kn.VIDEO_CALL_CHECK_DEVICES_BUTTON_TEXT:a&&a.checkDeviceSettingsText?a.checkDeviceSettingsText:Kn.VOICE_ONLY_CALL_CHECK_DEVICES_TEXT},secondaryText:function(e){return"true"===e.prop[o]?s&&s.secondaryInstructionText?s.secondaryInstructionText:Kn.VIDEO_CALL_DEVICE_SETTINGS_SECONDARY_TEXT:a&&a.secondaryInstructionText?a.secondaryInstructionText:Kn.VOICE_CALL_DEVICE_SETTINGS_SECONDARY_TEXT},startButtonText:function(e){return"true"===e.prop[o]?s&&s.startButtonText?s.startButtonText:Kn.VIDEO_CALL_START_BUTTON_TEXT:a&&a.startButtonText?a.startButtonText:Kn.VOICE_ONLY_CALL_START_BUTTON_TEXT},showCustomerCamera:function(e){return"true"===e.prop[o]},voiceOnlyCall:function(e){return"true"===e.prop[r]}},Iu.constants=l,Iu},Au=function(){function e(t){a()(this,e),this.app=t}return r()(e,[{key:"initializeComponents",value:function(){var e=this.app;yl([us(e),kl(e),Ll(e),Dl(e),Bl(e),Fl(e),zl(e),Ul(e),Kl(e),Zl(e),ic(e),ac(e),lc(e),mc(e),vc(e),Sc(e),Cc(e),Ec(e),Bc(e),Hc(e),qc(e),Gc(e),Xc(e),Qc(e),nu(e),ou(e),cu(e),ku(e),xu(e),ju(e)])}},{key:"kickInLayout",value:function(){yl(function(e){return ss.$app=e,ss.setModalVisible=function(){e.getStateMgr().setState({isModalVisible:!0})},ss.constants={style:e.getUIConfig().frameStyles||{},extendedSurveyFooterVisible:e.extendedSurveyFooterVisible},ss.data={survey:!1},ss}(this.app))}},{key:"clear",value:function(){this.getFooter(),this.footerEl&&this.footerEl.clear();var e=document.createElement("div");e.setAttribute("id","si-app");var t=this.layoutEl||document.querySelector("[ref-id='messaging-ui']");t.parentElement.replaceChild(e,t),this.transcriptEl=null,this.footerEl=null,this.topBar=null,this.layoutEl=null}},{key:"updateLogo",value:function(e){this.getTopBar().updateLogo(e)}},{key:"getTopBar",value:function(){return this.topBar||(this.topBar=document.querySelector("messaging-top-bar")),this.topBar}},{key:"resetTopBar",value:function(){this.topBar=null}},{key:"updateTitle",value:function(e){this.getTopBar().updateTitle(e)}},{key:"updateStatus",value:function(e,t){this.getTopBar().updateStatus(e,t)}},{key:"disableEmail",value:function(){this.app.getStateMgr().setState({emailState:yt})}},{key:"getLayoutEl",value:function(){return this.layoutEl||(this.layoutEl=document.querySelector("[ref-id='messaging-ui']")),this.layoutEl}},{key:"hideSurveyOverflow",value:function(){var e=document.querySelector("survey-top-bar");e&&e.hideOverflow()}},{key:"adjustTranscriptBottom",value:function(e){this.getTranscriptEl().adjustBottom(e)}},{key:"getTranscriptEl",value:function(){return this.transcriptEl||(this.transcriptEl=document.querySelector("transcript-area")),this.transcriptEl}},{key:"getFooter",value:function(){return this.footerEl||(this.footerEl=document.querySelector("footer-area")),this.footerEl}},{key:"getTopBarHeight",value:function(){return this.getTopBar().firstElementChild.clientHeight}},{key:"updateFullScreen",value:function(e){this.getTopBar().toggleFullScreen(e)}}]),e}(),Mu=function(){function e(t){a()(this,e);var i=t.getUIConfig().appConfigProps;this.audioSrc=i.audioSource,this.deviceType=t.getCIAPIInstance().getDeviceType(),this.setup(t),this.$app=t}return r()(e,[{key:"setup",value:function(e){this.audioSrc&&(this.audioSrc=e.getCIAPIInstance().getImagePath()+this.audioSrc,this.doesDeviceRequireUserPermissions()&&this.initMobileAudio())}},{key:"initHTMLAudio",value:function(){this.audio=new Audio(this.audioSrc),this.audioSupport=!!this.audio.play,this.lazyLoaded=!0}},{key:"initMobileAudio",value:function(){this.audioSupport=document.createElement("audio");var e=new Audio;e.loop=!1;var t=document,i={};i.audio=e,i.audioSource=this.audioSrc,i.startAudio=function(e){var n=!1;e&&"touchstart"==e.type?(n=!0,t.removeEventListener("touchstart",i.startAudio,!1),t.removeEventListener("keydown",i.startAudio,!1)):e&&"keydown"==e.type?(n=!0,t.removeEventListener("keydown",i.startAudio,!1),t.removeEventListener("touchstart",i.startAudio,!1)):e&&"touchend"==e.type&&(n=!0,t.removeEventListener("touchend",i.startAudio,!1),t.removeEventListener("keydown",i.startAudio,!1)),n||(i.audio.src=i.audioSource),i.audio.play()},t.addEventListener("touchend",i.startAudio,!1),t.addEventListener("keydown",i.startAudio,!1),this.audio=i}},{key:"playSound",value:function(){this.$app.isSoundEnabled()&&(this.doesDeviceRequireUserPermissions()&&this.audioSupport?this.audio.startAudio():(!this.lazyLoaded&&this.audioSrc&&this.initHTMLAudio(),this.audioSupport&&this.audio.play()))}},{key:"doesDeviceRequireUserPermissions",value:function(){return"Tablet"==this.deviceType||"Phone"==this.deviceType||(e=window.navigator.userAgent.toLowerCase()).indexOf("safari")>=0&&!(e.indexOf("chrome")>=0||e.indexOf("crios")>=0);var e}}]),e}(),Lu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(a()(this,e),!Zi(t))throw new Error("initial state must be a object");this._internalState=Qi(t),this._pubsub=new Ci}return r()(e,[{key:"state",get:function(){return Qi(this._internalState)},set:function(e){return!1}},{key:"setState",value:function(e,t){if(!Zi(e))throw new Error("value must be a object");var i=Qi(this._internalState),n=Object.assign(Qi(i),Qi(e));this._internalState=n;for(var s=Object.keys(e),a=0;a<s.length;a++){var o=Bi(i,s[a]),r=Bi(n,s[a]);en(o,r)&&!t||this._pubsub.publish(s[a],r)}return n}},{key:"setStateItem",value:function(e,t,i){var n=Bi(Qi(this._internalState),e);if(void 0!==n){var s=Qi(this._internalState);return function(e,t,i){for(var n=e,s=t,a=0,o=(t=t.split(".")).length;a<o;a++)n=e,s=t[a],e=e[t[a]];void 0!==n[s]&&(n[s]=i)}(s,e,t),this._internalState=s,en(n,t)&&!i||this._pubsub.publish(e,t),s}throw new Error("Could not find and set itemPathName: ".concat(e))}},{key:"subscribe",value:function(e,t){return this._pubsub.subscribe(e,t)}},{key:"unsubscribe",value:function(e){return this._pubsub.unsubscribe(e)}},{key:"clear",value:function(){this._pubsub._callbackList={}}}]),e}(),Pu=function(){function e(t){a()(this,e),this.$app=t,this.ciapi=t.getCIAPIInstance(),this.chatEventObject=Mc(this.ciapi)}return r()(e,[{key:"sendStartedEvent",value:function(e,t,i,n){var s=Dc(e,"civ2","chat",this.chatEventObject,j),a=this.constructContentSeenEvent(e,t,i,n);this.ciapi.logEventToDW({eventList:[s,a]})}},{key:"sendRespondedEvent",value:function(e,t,i,n,s,a,o,r){var l=_c(e,t,0,0,s,this.chatEventObject,j),c=this.constructContentSeenEvent(e,a,o,r);this.ciapi.logEventToDW({eventList:[l,c]})}},{key:"sendEndedEvent",value:function(e,t,i,n,s,a,o){var r=_c(e,t,0,0,o,this.chatEventObject,j),l=Oc(e,n,s,!1,this.chatEventObject,j);this.ciapi.logEventToDW({eventList:[r,l]})}},{key:"constructContentSeenEvent",value:function(e,t,i,n){var s=[],a=[];return n.forEach((function(e){var t=e.id,i=e.lbl;a.push(t),s.push(i)})),Lc(e,t,0,s,a,this.chatEventObject,j)}}]),e}(),_u=function(){function e(t){a()(this,e),this.$app=t,this.isPopup="POPUP"===this.$app.getCIAPIInstance().getChatParams().chatType,this.focusTimeout=-1}return r()(e,[{key:"setInputElement",value:function(e){this.inputElement=e}},{key:"shouldExecuteFocusSetting",value:function(){var e,t,i=((t=new RegExp("^(?!.*windows)(?=.*android)","i").test(window.navigator.userAgent))&&null!=e&&(t=-1!=window.navigator.userAgent.indexOf(e)),t||Ri()),n=this.$app.getIsMinimized(),s=this.inputElement.hasFocus(),a=this.$app.getStateMgr().state.isModalVisible,o=document.activeElement.closest(".transcript-area");if(!o&&document.activeElement===document.body){var r=document.querySelector("[data-focus-id='vaLink']");r&&(o=r.closest(".transcript-area"),r.removeAttribute("data-focus-id"))}return i&&!n&&!s&&!a||o}},{key:"handleFocusSetting",value:function(e,t){if(this.shouldExecuteFocusSetting(this.$app))switch(t){case Kt:this.inputElement.focus();break;case Jt:this.focusLinkTag(e);break;case Qt:return e&&e.focus(),!1;default:ai("not a valid focus setting".concat(t))}return!0}},{key:"handleFocusWhenChatLaunched",value:function(e,t){switch(t){case Zt:this.$app.getStateMgr().state.survey.visible||this.$app.getIsMinimized()||this.isPopup||this.inputElement.focus();break;case ei:return this.isPopup||e.focus(),!1;default:ai("focus setting when chat launched: ".concat(t))}return!0}},{key:"focusLinkTag",value:function(e){if(e){var t=e.querySelector("a");t&&t.focus()}}},{key:"forceInputFocus",value:function(){this.inputElement.focus()}},{key:"setFocusIfFocusNotInTranscript",value:function(){this.shouldExecuteFocusSetting(this.$app)||this.inputElement.focus()}},{key:"whenFrameRestored",value:function(){var e=this;this.clearRestoreFocusTimeout(),this.focusTimeout=setTimeout((function(){e.forceInputFocus()}),2e3)}},{key:"clearRestoreFocusTimeout",value:function(){-1!==this.focusTimeout&&(clearTimeout(this.focusTimeout),this.focusTimeout=-1)}}]),e}();function Du(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=vi()(e);if(t){var s=vi()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return fi()(this,i)}}var Ou=function(e){pi()(i,e);var t=Du(i);function i(e){var n,s,o,r,l;return a()(this,i),(l=t.call(this)).bridge=e,l.uiConfig=e.getUIConfig(),l.CIAPIInstance=e.getSDKInstance(),l.shoutui=new Au(Ii()(l)),Ai()((n=Ii()(l),vi()(i.prototype)),"initAppStringProperties",n).call(n,l.uiConfig.appStringProps),Ai()((s=Ii()(l),vi()(i.prototype)),"initConfigProperties",s).call(s,l.uiConfig.appConfigProps),Ai()((o=Ii()(l),vi()(i.prototype)),"filterHiddenMenu",o).call(o,l.uiConfig),Ai()((r=Ii()(l),vi()(i.prototype)),"filterSurveyItem",r).call(r,l.uiConfig.topBarConfig.topBarSettings,l.uiConfig.footerConfig.footerSettings),l.shoutui.initializeComponents(),l.sndMgr=new Mu(Ii()(l)),l.focusMgr=new _u(Ii()(l)),l.recentConversationID=null,l.engagementID=null,l.conversationID=null,l.agentID=null,l}return r()(i,[{key:"onCreateFrame",value:function(){this.asyncPrev=!1,this.isRestoring=!1,this.isLastConvActive=!1,this.isAsyncChat=this.CIAPIInstance.isAsyncChat(),this.isAsyncReconnect=!1,this.asyncMode=this.CIAPIInstance.getAsyncChatMode(),this.showOpenerForEndedConv=this.CIAPIInstance.showOpenerForEndedConv(),this.isRestoring=this.CIAPIInstance.isChatInProgress(),this.stateMgr=new Lu({state:this.isRestoring?pt:ht,emailState:this.isEmailRequested()?yt:vt,survey:{visible:!1,domain:"",evt:"",automatonType:""},isMinimized:!1,FrameBridge:{readyFocus:"",setCount:0},ariaReaderSay:"",isCloseConfirmVisible:!1,isModalVisible:!1}),this.shoutui.kickInLayout(),this.renderEngine=new Xn(this),this.isChatDone=!1,this.setOpenerAndReadyFrame(),this.getMessageApi=new In(this),!0===this.CIAPIInstance.checkIfMinimized().state&&this.getStateMgr().setState({isMinimized:!0}),window.RichMain.setup({skinPath:this.uiConfig.skinPath})}},{key:"onMinimizeFrame",value:function(){this.bridge.minimizeFrame(),this.CIAPIInstance.sendActivityMessage(this.CIAPIInstance.ACTIVITY_STATE.MINIMIZED),this.getStateMgr().setState({isMinimized:!0})}},{key:"onResumeFrame",value:function(){this.CIAPIInstance.sendActivityMessage("restore"),this.getStateMgr().setState({isMinimized:!1}),this.focusMgr.whenFrameRestored()}},{key:"onDestroyFrame",value:function(){this.openerTimers&&this.openerTimers.length>0&&this.openerTimers.forEach((function(e){e.clear()})),this.openerText=null,this.focusMgr.clearRestoreFocusTimeout(),this.shoutui.clear()}},{key:"setOpenerAndReadyFrame",value:function(){var e=this;this.isAsyncChat?this.getPrevConversation(!1):this.shoutui.getLayoutEl().renderSurvey().then((function(t){t?e.setupPreChatParams(t):e.isRestoring&&1===e.getPersistedValue(b,-1)&&(e.clientOutCome=!0),e.continueChatRendering().then((function(){t?bn.instantiate((function(){e.autoEngage(t.agentOutcome,t.data)}),250):e.startAutoEngagement&&!e.isRestoring&&e.autoEngage(e.autoEngageText)}))}))}},{key:"continueChatRendering",value:function(){return this.setDisclaimerText(),this.getOpener(!0)}},{key:"isPreChatSurveyNeed",value:function(){return!(!this.uiConfig.displayPreChatSurvey||this.isRestoring)&&(this.stateMgr.setState({state:dt}),!0)}},{key:"setupPreChatParams",value:function(e){e.datapass&&(e.agentOutcome="",Object.keys(e.datapass).forEach((function(t){e.agentOutcome+=[t,":",e.datapass[t],"\n"].join("")})),e.datapass.customerName&&(this.customerName=e.datapass.customerName)),e.data&&e.data.clientOutcome&&(this.openerText=e.data.clientOutcome,this.clientOutCome=!0,this.persistValue(b,1))}},{key:"setDisclaimerText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.showDisclaimerText&&this.disclaimerText){var t=new Li({bubbleType:Mi.DISCLAIMER_TEXT,messageText:this.disclaimerText});t.setRestore(e),this.addToUI(t)}}},{key:"getOpener",value:function(e){var t,i=this;return jn((function(e){i.getRestoring()&&i.clientOutCome||i.isChatEngaged()?e([]):i.openerText?i.openerText.startsWith(k)?(e([]),i.focusMgr.handleFocusWhenChatLaunched(null,Zt)):e(Array.isArray(i.openerText)||[i.openerText]):i.CIAPIInstance.getOpenerScripts((function(t){e(t)}))})).then((function(n){if(i.isChatEngaged())return null;if(i.getRestoring()){t=parseInt(i.getPersistedValue(u,Date.now()),10);var s=parseInt(i.getPersistedValue(h,0),10);0!=s&&n.length>0&&(n=n.splice(0,s))}else t=Date.now();if(e){if(i.openerTimers=[],i.openerDisplayIndex=0,0==n.length)if(i.uiConfig.appConfigProps.showTypingInOpener)i.showTypingIndicator(i.typingMsg);else if(!i.clientOutCome&&!i.openerText){var a=i.uiConfig.appStringProps.emptyOpener||"Hello";n.push(a)}n.forEach((function(e,n){i.getRestoring()?i.renderOpenerMessage(e,t,!0):i.openerTimers.push(bn.instantiate((function(){i.renderOpenerMessage(e,t+n*i.openerDelay,!1),i.clientOutCome||i.CIAPIInstance.setOpeners([Gi(e)],i.agentAlias),i.openerDisplayIndex+=1}),n*i.openerDelay))}))}else i.getRestoring()||i.clientOutCome||(n=n.map((function(e){return Gi(e)})),i.CIAPIInstance.setOpeners(n,i.agentAlias));return n})).then((function(e){i.isAsyncChat||i.onFrameViewReady(!1)}))}},{key:"renderOpenerMessage",value:function(e,t,i){this.getMessageApi.setAgentIndex(this.agentAlias);var n=!!this.CIAPIInstance.isVirtualAgent();if(!this.getMessageApi.displayOpenerRichMessage(e,i,n,this.agentAlias,t)){var s=new Li({bubbleType:Mi.OPENER_MESSAGE,messageText:e,isAuto:n,name:this.agentAlias,timestamp:t});s.setRestore(i),this.addToUI(s)}}},{key:"setAsyncOpenerStatus",value:function(){return this.isLastConvActive?(!this.isRestoring&&this.isLastConvActive&&this.setDisclaimerText(!1),Promise.resolve()):(this.addHeaderToBottom(),this.setDisclaimerText(!1),this.getOpener(!0))}},{key:"agentResolved",value:function(){this.isLastConvActive=!1,this.getOpener(!1)}},{key:"onFrameViewReady",value:function(e){this.customerName=this.getPersistedValue(S,this.customerName),this.CIAPIInstance.chatDisplayed({customerName:this.customerName,disconnectCb:this.onNetworkDisconnected.bind(this),reConnectCb:this.onNetworkReconnected.bind(this),failedCb:this.onNetworkFailed.bind(this),previousMessagesCb:this.onPreviousMessages.bind(this),defaultAgentAlias:this.agentAlias,skinConfig:this.uiConfig.skinConfig,autoConnectedCb:this.onAutoConnected.bind(this)},e)}},{key:"reInitCIAPI",value:function(){this.reinitAsyncChat=!0}},{key:"onNetworkDisconnected",value:function(){var e=this;bn.exists(W)||bn.set(W,(function(){e.getMessageApi.addSystemMessage(e.networkDisconnected,at,!0)}),this.networkMessageDelay)}},{key:"onNetworkReconnected",value:function(){bn.exists(W)&&bn.executed(W)&&this.getMessageApi.addSystemMessage(this.networkConnected,ot,!0),bn.clear(W)}},{key:"onNetworkFailed",value:function(){this.getMessageApi.addSystemMessage(this.networkFailed,st),this.getMessageApi.updateMessagingTopBarStatus(It),this.disableFooter(!0)}},{key:"onPreviousMessages",value:function(e){var t=this;if(e&&!this.isAsyncReconnect){this.getMessageApi.setWindowId(e.windowId);var i=e.messages.length-1;e.messages.forEach((function(e,n){t.getMessageApi.onNewMessage(e,!0,n==i)}))}this.isRestoring=!1,this.isAsyncReconnect=!1,this.CIAPIInstance.getMessages((function(e){t.getMessageApi.onNewMessage(e)}))}},{key:"getPrevConversation",value:function(e){var t,i=this,n=this.isRestoring;this.lastHasMessages=!1,this.waitForOpener&&this.disableFooter(!1);var s=Date.now(),a=jn(this.CIAPIInstance.getPreviousAsyncTranscript);this.isLastConvActive=this.CIAPIInstance.isLastConversationActive(),jn((function(n){if(i.isPreChatSurveyNeed()&&!e){if(!i.isLastConvActive)return i.shoutui.getLayoutEl().renderSurvey().then((function(e){e&&(i.setupPreChatParams(e),t=e),n()}));i.shoutui.getLayoutEl().setSurveyVisibility(!1)}i.isLastConvActive&&1===i.getPersistedValue(b,-1)&&(i.clientOutCome=!0),n()})).then((function(){return i.setAsyncOpenerStatus()})).then((function(){i.waitForOpener&&i.enableFooter(),i.onFrameViewReady(!1),t?bn.instantiate((function(){i.autoEngage(t.agentOutcome,t.data)}),250):i.startAutoEngagement&&!i.isRestoring&&i.autoEngage(i.autoEngageText);var e=new Li({bubbleType:Mi.SYSTEM_MESSAGE,messageText:i.historyLoadingText});return e.setInternalState(lt),i.getRenderingEngine().toggleLoadingMsg(e,!0),a})).then(this.processAsyncTranscript.bind(this,n,s))}},{key:"processAsyncTranscript",value:function(e,t,i){var n=this,s=Date.now()-t<2e3;bn.set("asyncTimer",(function(){if(i&&i.length>0){n.asyncPrev=!0,n.conversations=i;var t=((s=i[i.length-1].messages).filter((function(e){return"sub_header"!=e.messageType})),s);n.lastHasMessages=t.length>0,n.getMessageApi.lastMsgTS=n.lastHasMessages?parseInt(t[t.length-1].timestamp,10):0,e&&!n.lastHasMessages?(n.conversations[0][Xe]&&(n.recentConversationID=n.conversations[0][Xe]),n.setOpenerToOngoingAsyncConversation()):(n.processAsyncRendering(),n.asyncPrev=!1,n.getRenderingEngine().toggleLoadingMsg(null,!1))}var s}),s?1e3:25)}},{key:"setOpenerToOngoingAsyncConversation",value:function(){var e=this;return this.conIndex=this.conversations.length-1,this.getOpener(!0).then((function(){e.setDisclaimerText(!0),e.addHeaderToBottom(),e.asyncPrev=!1,e.getRenderingEngine().toggleLoadingMsg(null,!1)}))}},{key:"processAsyncRendering",value:function(){if(this.asyncMode.toLowerCase()===d)this.conIndex=0,this.renderAsyncConversation(this.conversations[0]);else{this.conIndex=this.conversations.length-1;var e=this.conversations[this.conIndex];this.renderAsyncConversation(e),this.addHeader(e)}this.recentConversationID=this.conversations[this.conIndex][Xe]}},{key:"addSurveyToTranscript",value:function(e){if(e.surveyMessage){var t=e.surveyAlias,i=new Li({messageText:com.inq.flash.client.chatskins.SkinControl.prepareAsyncSurveyMessage(e.surveyMessage,e.conversationID),name:t,timestamp:this.getMessageApi.lastMsgTS||Date.now()});i.setAgentIndex(this.getMessageApi.setAgentIndex(t)),i.setRestore(!0),this.renderEngine.addNewItemToTop(i)}}},{key:"addHeader",value:function(e){if(this.showConvHeader){var t=new Li({bubbleType:Mi.CONVERSATION_HEADER}),i=Date.now();e.messages.length>0&&(i=e.messages[0][Ie]),t.setMessageText(i),t.setTimeStamp(i),t.setRestore(!0),this.renderEngine.addNewItemToTop(t)}}},{key:"addHeaderToBottom",value:function(){if(this.isHeaderNeeded()){var e=parseInt(this.getPersistedValue(u,Date.now()),10)||Date.now();this.addToUI(new Li({bubbleType:Mi.CONVERSATION_HEADER,messageText:e,timestamp:e}))}}},{key:"isHeaderNeeded",value:function(){return this.isAsyncChat&&this.asyncMode.toLowerCase()!==d}},{key:"lazyloadConversation",value:function(){if(this.conversations&&this.conIndex>0){this.lazyloading=!0,this.conIndex-=1;var e=this.conversations[this.conIndex];this.renderAsyncConversation(e),this.addHeader(e)}}},{key:"hasMoreConversations",value:function(){return this.conIndex>0}},{key:"renderAsyncConversation",value:function(e){if(this.addSurveyToTranscript(e),e.messages&&e.messages.length>0)for(var t=e.messages.length-1;t>=0;t--){var i=e.messages[t],n=void 0,s=i[Ie],a=i[He],o=0==t&&this.conIndex==this.conversations.length-1&&this.isLastConvActive;if(i.messageType===se||i.messageType===Se){var r=i[Fe],l=i[Be];if(null!=r||null!=l){var c=this.getDataMessage(i);c&&this.getMessageApi.displayDataMessage(c,a,!0,!1,l||r,s,o,!1,!0)||(n=new Li({messageText:a,name:l,timestamp:s}),r&&r.startsWith("virtualAssistant")?(n.setVA(),n.setMessageBubble(Mi.VIRTUAL_AGENT_MESSAGE)):r&&r.toLowerCase().startsWith("opener")&&n.setMessageBubble(Mi.OPENER_MESSAGE),n.setAgentIndex(this.getMessageApi.setAgentIndex(l||r)))}else{var u=i[Ne]||this.customerName;if(a.startsWith(k)){var h=this.getDataMessage(i);h&&this.getMessageApi.displayDataMessage(h,a,!0,!1,u,s,!1,!0,!0)}else n=new Li({bubbleType:Mi.CUSTOMER_MESSAGE,messageText:a,name:u,timestamp:s})}}else if(i.messageType===be){var d=i[Be],p=this.getDataMessage(i);p&&this.getMessageApi.displayDataMessage(p,a,!0,!0,d,s,o,!1,!0)||(n=new Li({bubbleType:Mi.VIRTUAL_AGENT_MESSAGE,messageText:a,name:d,isAuto:!0,timestamp:s})).setAgentIndex(this.getMessageApi.setAgentIndex(d))}n&&(n.setRestore(!0),this.renderEngine.addNewItemToTop(n))}}},{key:"getDataMessage",value:function(e){var t=e[$e];if(null!=t){var i=JSON.parse(t);return i.richWidget?i.richWidget:i}return null}},{key:"onEngageStarted",value:function(){var e=this;this.CIAPIInstance.getMessages((function(t){e.getMessageApi.onNewMessage(t)})),this.stateMgr.setState({state:pt})}},{key:"onAutoConnected",value:function(){this.onEngageStarted()}},{key:"onEngageFailed",value:function(){this.getMessageApi.addSystemMessage(this.serviceNotAvailable,Qe),this.disableFooter(!0)}},{key:"onNewCustomerBubble",value:function(e){this.CIAPIInstance.isChatInProgress()?this.CIAPIInstance.sendMessage(e):(this.clearOpenerTimer(),this.reinitAsyncChat&&(this.reinitAsyncChat=!1,this.onFrameViewReady(!0)),jn(this.CIAPIInstance.engageChat,e).then(this.onEngageResponse.bind(this))),this.addCustomerBubble(e)}},{key:"onEngageResponse",value:function(e){var t=e.httpStatus,i=e.statusType,n=e.asyncReconnect,s=e.windowId;200===t&&"complete"===i?(this.isAsyncReconnect=n,this.onEngageStarted(),this.getMessageApi.setWindowId(s)):this.onEngageFailed()}},{key:"clearOpenerTimer",value:function(){this.openerTimers&&this.openerTimers.length>0&&(this.openerTimers.forEach((function(e){e.clear()})),0!=this.openerTimers.length-this.openerDisplayIndex&&this.persistValue(h,this.openerDisplayIndex))}},{key:"sendRichMediaData",value:function(e,t){this.displayRecieptResponse(e,t),e&&!e.startsWith(k)&&(this.addCustomerBubble(e),t.receipt||this.CIAPIInstance.sendRichContentMessage(e,t,this.onEngageResponse.bind(this)))}},{key:"displayRecieptResponse",value:function(e,t){t.receipt&&(t.receipt.constants=t.constants,delete t.constants,this.getMessageApi.displayDataMessage(t,e,!1,!1,this.customerName,Date.now(),!1,!0))}},{key:"sendWebRTCInvitationState",value:function(e){this.CIAPIInstance.sendRichContentMessage(k,{webRTCEvent:{name:e}}),this.persistValue(P,$t)}},{key:"autoEngage",value:function(e,t){this.clearOpenerTimer(),jn(this.CIAPIInstance.autoEngage,e,t).then(this.onEngageResponse.bind(this))}},{key:"addCustomerBubble",value:function(e,t,i){var n=new Li({bubbleType:Mi.CUSTOMER_MESSAGE,messageText:e,isAuto:!1,name:this.customerName,timestamp:i});n.setRestore(t),this.addToUI(n),this.showTypingIndicatorForVA()}},{key:"showTypingIndicator",value:function(e){var t=new Li({bubbleType:Mi.TYPING_MESSAGE,messageText:e});this.addToUI(t)}},{key:"showTypingIndicatorForVA",value:function(){var e=this;0!==this.vaTyping&&this.CIAPIInstance.isVirtualAgent()&&bn.set(C,(function(){e.showTypingIndicator(e.typingMsg)}),this.vaTyping)}},{key:"onVALinkClick",value:function(e){var t=this;this.getCIAPIInstance().sendVALinkMessage(e,(function(i){t.addCustomerBubble(i,!1),Ti.publish("vaDialog.clicked",e)}),(function(e){t.bridge.pushToFrameSet(e.href,e.target)}),this.onEngageResponse.bind(this))}},{key:"getRestoring",value:function(){return this.isRestoring||this.asyncPrev}},{key:"addToUI",value:function(e){e&&(this.asyncPrev?this.renderEngine.addNewItemToTop(e):this.renderEngine.addNewItem(e))}},{key:"updateLastMessage",value:function(e){var t=this.renderEngine.getMessages(),i=t.length-1;t[i].getRichData()&&t[i].getRichData().widgetView==Ct?this.renderEngine.update(i,e):this.addToUI(e)}},{key:"getCIAPIInstance",value:function(){return this.CIAPIInstance}},{key:"getUIConfig",value:function(){return this.uiConfig}},{key:"getImagePath",value:function(){return this.CIAPIInstance.getImagePath()}},{key:"getIsMinimized",value:function(){return this.getStateMgr().state.isMinimized}},{key:"getBridge",value:function(){return this.bridge}},{key:"getRenderingEngine",value:function(){return this.renderEngine}},{key:"closeChat",value:function(){var e=this.shoutui.getLayoutEl();!this.isChatDone&&this.uiConfig.appConfigProps.closeConfirmation&&this.CIAPIInstance.isChatInProgress()?e.showCloseModal():(this.stateMgr.setState({state:mt}),e.invokeSurveyClose(),this.CIAPIInstance.closeChat(),this.reinitAsyncChat=!1)}},{key:"setSoundState",value:function(e){this.persistValue(y,e?1:0)}},{key:"persistValue",value:function(e,t){this.CIAPIInstance.setPersistedData(e,t)}},{key:"removePersistedValueByKey",value:function(e){this.CIAPIInstance.removePersistedDataByKey(e)}},{key:"getPersistedValue",value:function(e,t){return this.CIAPIInstance.getPersistedData(e,t)}},{key:"setFrameBridgeState",value:function(e,t,i){if(this.stateMgr.setStateItem("FrameBridge.".concat(e),t),i){var n=this.stateMgr.state.FrameBridge.setCount+1;this.stateMgr.setStateItem("FrameBridge.setCount",n)}}},{key:"isSoundEnabled",value:function(){var e=this.audioInitialSetting===zt?1:0;return 1==parseInt(this.getPersistedValue(y,e),10)}},{key:"isEmailRequested",value:function(){return 1==parseInt(this.getPersistedValue(v,-1),10)}},{key:"minimize",value:function(){this.onMinimizeFrame()}},{key:"updateLogo",value:function(e){this.shoutui.updateLogo(e)}},{key:"updateTitle",value:function(e){this.shoutui.updateTitle(e)}},{key:"disableFooter",value:function(e){this.isChatDone=e,e&&this.stateMgr.setState({state:mt}),this.shoutui.getFooter().disable()}},{key:"enableFooter",value:function(){this.shoutui.getFooter().enableFooter()}},{key:"disableEmailButtonWhenAsync",value:function(){this.shoutui.disableEmail()}},{key:"scrollTranscriptToBottom",value:function(){this.shoutui.getTranscriptEl().scrollBottom()}},{key:"displayPostChatSurvey",value:function(e,t,i){this.shoutui.resetTopBar(),this.shoutui.getLayoutEl().renderPostChatSurvey(e,t,i)}},{key:"toggleFullScreen",value:function(e){this.shoutui.updateFullScreen(e)}},{key:"getStateMgr",value:function(){return this.stateMgr}},{key:"handleAccessKeyPress",value:function(e){!this.hasCloseConfirmModalVisible()&&["altKey","ctrlKey","shiftKey","metaKey"].includes(this.minimizeAndCloseAccessKeys.mainKey)&&e[this.minimizeAndCloseAccessKeys.mainKey]&&(e.keyCode===this.minimizeAndCloseAccessKeys.closeKey?this.closeChat():e.keyCode===this.minimizeAndCloseAccessKeys.minimizeKey&&this.minimize())}},{key:"hasCloseConfirmModalVisible",value:function(){return this.stateMgr.state.isCloseConfirmVisible}},{key:"getRichMediaReporter",value:function(){return this.richReporter||(this.richReporter=new Pu(this)),this.richReporter}},{key:"isCallInProgress",value:function(){var e=this.stateMgr.state.state;return e===ft||e===gt}},{key:"getLatestConversationID",value:function(){return this.recentConversationID}},{key:"getEngagementID",value:function(){return this.engagementID}},{key:"setEngagementID",value:function(e){this.engagementID=e}},{key:"setAgentID",value:function(e){this.agentID=e}},{key:"setConversationID",value:function(e){this.conversationID=e}},{key:"checkAndMinimizeOnNewPageLoad",value:function(e){var t=this.CIAPIInstance.getDeviceType(),i=!1;if(e&&e.state||!this.CIAPIInstance.isChatInProgress())return i;switch(this.minimizeOnNewPage){case ti:i=!0;break;case ii:"Phone"!==t&&"Tablet"!==t||(i=!0);break;case ni:"Phone"===t&&(i=!0)}return i&&this.persistValue(K,0),i}},{key:"isChatEngaged",value:function(){return this.CIAPIInstance.isContinued()&&(this.getPersistedValue(J,0)>0||this.getPersistedValue(Q,!1))}},{key:"logWebRTCEvents",value:function(e,t){var i=this.getCIAPIInstance().getChatParams();this.getCIAPIInstance().logEventToDW({eventList:[{evt:e,siteID:i.siteID,customerID:i.getCustomerID(),chatID:i.getChatID(),conversationID:this.conversationID,dvvType:t,businessUnitID:i.businessUnitID,businessRuleID:i.brID,agentID:this.agentID}]})}}]),i}(_i);i.p="".concat(Inq.urls.mediaLaunchCiURL,"/");var Ru=function(){function e(){var t=this;a()(this,e),this.chatEl=null,this.SDKinstance=Inq.FlashPeer.getSDKInst(),this.config={chatDivID:"nuanMessagingFrame",frameID:"inqChatStage"},this.createMessagingFrame(),Inq.EVM.addListener({onChatClosed:function(){t.onChatClosed()}})}return r()(e,[{key:"getCIAppInstance",value:function(){return this.ciAppInstance||(this.ciAppInstance=new Ou(v3Lander.isWebSDK?FrameBridge:this)),this.ciAppInstance}},{key:"createMessagingFrame",value:function(){if(e.handleLegacyCallbacks(),!v3Lander.isWebSDK){this.doc=window.parent.document,this.injectStyleSheet(this.SDKinstance.getSkinDynamicAssetsPath(),this.doc,"nuance-chat");var t=this.doc.getElementById("nuanMessagingFrame");t.classList.add("floating-nuan-chat"),t.style.cssText="z-index:9999999;height:1px;width:1px;border-style: none;border-width: 0px;",this.chatEl=t;var i=this.chatEl.querySelector("#".concat("inqChatStage"));i.style.cssText="",ui(!0,i);var n=document.createElement("div");n.setAttribute("id","si-app"),document.body.appendChild(n)}}},{key:"onChatClosed",value:function(){this.messageWindow&&(this.messageWindow.clear(),this.messageWindow=null),this.ciAppInstance}},{key:"injectStyleSheet",value:function(e,t,i){for(var n=t.styleSheets,s=0,a=n.length;s<a;s++)if(n[s].href&&-1!==n[s].href.indexOf(i))return;var o=t.createElement("link");o.setAttribute("rel","stylesheet"),o.type="text/css",o.href="".concat(e+i,".css"),t.head.appendChild(o)}},{key:"loadConfig",value:function(e,t,i){var n=new com.inq.net.URLLoader,s=new com.inq.net.URLRequest(e+t);n.addEventListener(com.inq.events.Event.COMPLETE,(function(){if(!n.data)throw new Error("uiconfig.json is not available for this theme");i(n.data)})),n.load(s)}},{key:"showMessagingFrame",value:function(e){var t=this,i=this.SDKinstance.getThemeInfo(),n=this.SDKinstance.getSkinDynamicAssetsPath();this.injectStyleSheet(n,document,"chatui"),this.loadConfig(i.skinPath,"uiconfig.json",(function(s){var a,o;t.uiConfig=s,t.uiConfig.pcsID=e,t.uiConfig.skinPath=i.skinPath,s.skinConfig&&(t.config.frameW=s.skinConfig.frameWidth,t.config.frameH=s.skinConfig.frameHeight),s.richContentCSSStyle&&t.injectStyleSheet(n,document,s.richContentCSSStyle),t.messageWindow||(t.messageWindow=new xi(t)),t.getCIAppInstance().checkAndMinimizeOnNewPageLoad(i.minimized)&&(i.minimized={state:!0,count:0}),t.messageWindow.render(i),t.getCIAppInstance().onCreateFrame(),t.uiConfig.minimizedStateC2CPlugin&&(a=n+t.uiConfig.minimizedStateC2CPlugin,(o=document.createElement("script")).src=a,o.type="text/javascript",document.body.appendChild(o))}))}},{key:"getUIConfig",value:function(){return this.uiConfig}},{key:"getSDKInstance",value:function(){return this.SDKinstance}},{key:"getStage",value:function(){return this.chatEl}},{key:"onRestoredClicked",value:function(){this.messageWindow&&this.messageWindow.setVisible(!0)}},{key:"minimizeFrame",value:function(){this.messageWindow&&this.messageWindow.minimize(),this.pluginInstance&&this.pluginInstance.setMinimized(this.messageWindow.minimizedCount)}},{key:"messageOnMinimized",value:function(e){this.messageWindow.minimizedCount+=1,this.pluginInstance&&this.pluginInstance.messageOnMinimzed(this.messageWindow.minimizedCount,e)}},{key:"onVirtualKeyboardOpen",value:function(){this.messageWindow.onVirtualKeyboardOpen()}},{key:"onVirtualKeyboardHidden",value:function(){this.messageWindow.onVirtualKeyboardHidden()}},{key:"showPostChatSurvey",value:function(e,t){this.ciAppInstance.displayPostChatSurvey(e,t)}},{key:"pushToFrameSet",value:function(e,t){com.inq.flash.client.control.FlashPeer.PushToFrameset(e,t)}},{key:"setPluginInstance",value:function(e){this.pluginInstance=e,this.messageWindow.minimized?this.SDKinstance.getThemeInfo().embedded?this.onRestoredClicked():e.setMinimized(this.messageWindow.minimizedCount):e.displayChatFab&&!this.SDKinstance.getThemeInfo().embedded&&e.displayChatFab()}},{key:"getPluginInstance",value:function(){return this.pluginInstance}},{key:"addDrag",value:function(e){var t=this.SDKinstance.getThemeInfo();this.messageWindow.addDragElement(t,e)}},{key:"isFullScreen",value:function(){return this.messageWindow.isPhone()}},{key:"isTablet",value:function(){this.messageWindow.isTablet()}},{key:"setAppString",value:function(e,t){this.getUIConfig().appStringProps[e]=t,this.getCIAppInstance().hasOwnProperty(e)&&(this.getCIAppInstance()[e]=t)}}],[{key:"handleLegacyCallbacks",value:function(){com.inq.flash.client.control.MinimizeManager&&(com.inq.flash.client.control.MinimizeManager.actionMinimize=function(){this.ciAppInstance.minimize()},com.inq.flash.client.control.MinimizeManager.actionRestore=function(){this.onRestoredClicked()}),com.inq.flash.client.chatskins.SkinControl&&(com.inq.flash.client.chatskins.SkinControl.actionRestoreAndExitChat=function(){var e=this;this.onRestoredClicked(),bn.set((function(){e.SDKinstance.closeChat()}),1e3)})}}]),e}();window.messagingApp=new Ru}]);